(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,92274,e=>{"use strict";var t=e.i(43476),s=e.i(71645),r=e.i(4792),a=e.i(79788),l=e.i(23750),i=e.i(10708),o=e.i(62870);let n=[{code:"US",name:"United States"},{code:"CA",name:"Canada"},{code:"GB",name:"United Kingdom"},{code:"AU",name:"Australia"}],c=["AL","AK","AZ","AR","CA","CO","CT","DE","FL","GA","HI","ID","IL","IN","IA","KS","KY","LA","ME","MD","MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH","OK","OR","PA","RI","SC","SD","TN","TX","UT","VT","VA","WA","WV","WI","WY"];function d({customerInfo:e,billingInfo:r,onCustomerChange:a,onBillingChange:d}){let[m,u]=(0,s.useState)([]),[x,p]=(0,s.useState)(!1),[g,h]=(0,s.useState)(null);return(0,s.useEffect)(()=>{(async()=>{let e=localStorage.getItem("authToken");if(e)try{p(!0);let t=await fetch("/api/customers/me/addresses",{headers:{Authorization:`Bearer ${e}`}});if(t.ok){let e=await t.json();if(u(e.addresses||[]),e.addresses&&e.addresses.length>0){let t=e.addresses[0];h(t.id),a("firstName",t.first_name),a("lastName",t.last_name),a("street",t.street_1),a("street2",t.street_2||""),a("city",t.city),a("state",t.state_or_province),a("postalCode",t.postal_code);let s=n.some(e=>e.code===t.country_code)?t.country_code:"US";a("country",s)}}}catch(e){console.error("Error loading saved addresses:",e)}finally{p(!1)}})()},[]),(0,t.jsxs)("div",{className:"space-y-6",children:[m.length>0&&(0,t.jsxs)("div",{className:"backdrop-blur-xl bg-white border border-gray-200 rounded-2xl p-6",children:[(0,t.jsx)("h3",{className:"text-xl font-bold mb-6",children:"Saved Addresses"}),(0,t.jsx)("div",{className:"space-y-2 mb-4",children:m.map(e=>(0,t.jsxs)("button",{onClick:()=>{var t;let s;return t=e.id,void(!(s=m.find(e=>e.id===t))||(h(t),a("firstName",s.first_name),a("lastName",s.last_name),a("street",s.street_1),a("street2",s.street_2||""),a("city",s.city),a("state",s.state_or_province),a("postalCode",s.postal_code),a("country",n.some(e=>e.code===s.country_code)?s.country_code:"US")))},className:`w-full text-left p-4 rounded-lg border-2 transition-colors ${g===e.id?"border-blue-600 bg-blue-50":"border-gray-200 hover:border-gray-300 bg-gray-50"}`,children:[(0,t.jsxs)("p",{className:"font-semibold text-gray-900",children:[e.first_name," ",e.last_name]}),(0,t.jsx)("p",{className:"text-gray-700 text-sm",children:e.street_1}),e.street_2&&(0,t.jsx)("p",{className:"text-gray-700 text-sm",children:e.street_2}),(0,t.jsxs)("p",{className:"text-gray-700 text-sm",children:[e.city,", ",e.state_or_province," ",e.postal_code]})]},e.id))}),(0,t.jsx)("p",{className:"text-gray-600 text-sm mb-6",children:"Or enter a different address below:"})]}),(0,t.jsxs)("div",{className:"backdrop-blur-xl bg-white border border-gray-200 rounded-2xl p-4 sm:p-6",children:[(0,t.jsx)("h3",{className:"text-lg sm:text-xl font-bold mb-4 sm:mb-6",children:"Shipping Address"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4 mb-3 sm:mb-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)(i.Label,{htmlFor:"shipping-first-name",className:"text-gray-700",children:["First Name ",(0,t.jsx)("span",{"aria-label":"required",children:"*"})]}),(0,t.jsx)(l.Input,{id:"shipping-first-name",value:e.firstName,onChange:e=>a("firstName",e.target.value),className:"bg-gray-50 border-gray-200 text-gray-900 placeholder-gray-400 mt-2",required:!0,"aria-required":"true"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)(i.Label,{htmlFor:"shipping-last-name",className:"text-gray-700",children:["Last Name ",(0,t.jsx)("span",{"aria-label":"required",children:"*"})]}),(0,t.jsx)(l.Input,{id:"shipping-last-name",value:e.lastName,onChange:e=>a("lastName",e.target.value),className:"bg-gray-50 border-gray-200 text-gray-900 placeholder-gray-400 mt-2",required:!0,"aria-required":"true"})]})]}),(0,t.jsxs)("div",{className:"mb-3 sm:mb-4",children:[(0,t.jsxs)(i.Label,{htmlFor:"shipping-email",className:"text-sm sm:text-gray-700",children:["Email Address ",(0,t.jsx)("span",{"aria-label":"required",children:"*"})]}),(0,t.jsx)(l.Input,{id:"shipping-email",type:"email",value:e.email,onChange:e=>a("email",e.target.value),className:"bg-gray-50 border-gray-200 text-gray-900 placeholder-gray-400 mt-1 sm:mt-2",required:!0,"aria-required":"true"})]}),(0,t.jsxs)("div",{className:"mb-3 sm:mb-4",children:[(0,t.jsxs)(i.Label,{htmlFor:"shipping-phone",className:"text-sm sm:text-gray-700",children:["Phone Number ",(0,t.jsx)("span",{"aria-label":"required",children:"*"})]}),(0,t.jsx)(l.Input,{id:"shipping-phone",type:"tel",value:e.phone,onChange:e=>a("phone",e.target.value),className:"bg-gray-50 border-gray-200 text-gray-900 placeholder-gray-400 mt-1 sm:mt-2",required:!0,"aria-required":"true"})]}),(0,t.jsxs)("div",{className:"mb-3 sm:mb-4",children:[(0,t.jsxs)(i.Label,{htmlFor:"shipping-street",className:"text-sm sm:text-gray-700",children:["Street Address ",(0,t.jsx)("span",{"aria-label":"required",children:"*"})]}),(0,t.jsx)(l.Input,{id:"shipping-street",value:e.street,onChange:e=>a("street",e.target.value),placeholder:"123 Main St",className:"bg-gray-50 border-gray-200 text-gray-900 placeholder-gray-400 mt-1 sm:mt-2",required:!0,"aria-required":"true"})]}),(0,t.jsxs)("div",{className:"mb-3 sm:mb-4",children:[(0,t.jsx)(i.Label,{htmlFor:"shipping-street2",className:"text-sm sm:text-gray-700",children:"Apt, Suite, etc. (optional)"}),(0,t.jsx)(l.Input,{id:"shipping-street2",value:e.street2,onChange:e=>a("street2",e.target.value),placeholder:"Apt 4B",className:"bg-gray-50 border-gray-200 text-gray-900 placeholder-gray-400 mt-1 sm:mt-2"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4 mb-3 sm:mb-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(i.Label,{className:"text-sm sm:text-gray-700",children:"City *"}),(0,t.jsx)(l.Input,{value:e.city,onChange:e=>a("city",e.target.value),className:"bg-gray-50 border-gray-200 text-gray-900 placeholder-gray-400 mt-1 sm:mt-2",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(i.Label,{className:"text-sm sm:text-gray-700",children:"Postal Code *"}),(0,t.jsx)(l.Input,{value:e.postalCode,onChange:e=>a("postalCode",e.target.value),className:"bg-gray-50 border-gray-200 text-gray-900 placeholder-gray-400 mt-1 sm:mt-2",required:!0})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(i.Label,{className:"text-sm sm:text-gray-700",children:"Country *"}),(0,t.jsxs)(o.Select,{value:e.country,onValueChange:e=>a("country",e),children:[(0,t.jsx)(o.SelectTrigger,{className:"bg-gray-50 border-gray-200 text-gray-900 mt-1 sm:mt-2",children:(0,t.jsx)(o.SelectValue,{})}),(0,t.jsx)(o.SelectContent,{className:"bg-white border-gray-200",children:n.map(e=>(0,t.jsx)(o.SelectItem,{value:e.code,className:"text-gray-900 hover:bg-gray-100",children:e.name},e.code))})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(i.Label,{className:"text-sm sm:text-gray-700",children:"State/Province *"}),"US"===e.country?(0,t.jsxs)(o.Select,{value:e.state,onValueChange:e=>a("state",e),children:[(0,t.jsx)(o.SelectTrigger,{className:"bg-gray-50 border-gray-200 text-gray-900 mt-1 sm:mt-2",children:(0,t.jsx)(o.SelectValue,{})}),(0,t.jsx)(o.SelectContent,{className:"bg-white border-gray-200 max-h-60",children:c.map(e=>(0,t.jsx)(o.SelectItem,{value:e,className:"text-gray-900 hover:bg-gray-100",children:e},e))})]}):(0,t.jsx)(l.Input,{value:e.state,onChange:e=>a("state",e.target.value),placeholder:"State/Province",className:"bg-gray-50 border-gray-200 text-gray-900 placeholder-gray-400 mt-1 sm:mt-2",required:!0})]})]})]}),(0,t.jsxs)("div",{className:"backdrop-blur-xl bg-white border border-gray-200 rounded-2xl p-4 sm:p-6",children:[(0,t.jsx)("h3",{className:"text-lg sm:text-xl font-bold mb-4 sm:mb-6",children:"Billing Address"}),(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-4 sm:mb-6",children:[(0,t.jsx)("input",{type:"checkbox",id:"sameAsShipping",checked:r.sameAsShipping,onChange:e=>d("sameAsShipping",e.target.checked),className:"w-5 h-5 rounded bg-gray-50 border-gray-200"}),(0,t.jsx)(i.Label,{htmlFor:"sameAsShipping",className:"text-sm sm:text-gray-700 cursor-pointer font-normal",children:"Same as shipping address"})]}),!r.sameAsShipping&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4 mb-3 sm:mb-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(i.Label,{className:"text-sm sm:text-gray-700",children:"First Name *"}),(0,t.jsx)(l.Input,{value:r.firstName,onChange:e=>d("firstName",e.target.value),className:"bg-gray-50 border-gray-200 text-gray-900 placeholder-gray-400 mt-1 sm:mt-2",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(i.Label,{className:"text-sm sm:text-gray-700",children:"Last Name *"}),(0,t.jsx)(l.Input,{value:r.lastName,onChange:e=>d("lastName",e.target.value),className:"bg-gray-50 border-gray-200 text-gray-900 placeholder-gray-400 mt-1 sm:mt-2",required:!0})]})]}),(0,t.jsxs)("div",{className:"mb-3 sm:mb-4",children:[(0,t.jsx)(i.Label,{className:"text-sm sm:text-gray-700",children:"Street Address *"}),(0,t.jsx)(l.Input,{value:r.street,onChange:e=>d("street",e.target.value),placeholder:"123 Main St",className:"bg-gray-50 border-gray-200 text-gray-900 placeholder-gray-400 mt-1 sm:mt-2",required:!0})]}),(0,t.jsxs)("div",{className:"mb-3 sm:mb-4",children:[(0,t.jsx)(i.Label,{className:"text-sm sm:text-gray-700",children:"Apt, Suite, etc. (optional)"}),(0,t.jsx)(l.Input,{value:r.street2,onChange:e=>d("street2",e.target.value),placeholder:"Apt 4B",className:"bg-gray-50 border-gray-200 text-gray-900 placeholder-gray-400 mt-1 sm:mt-2"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4 mb-3 sm:mb-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(i.Label,{className:"text-sm sm:text-gray-700",children:"City *"}),(0,t.jsx)(l.Input,{value:r.city,onChange:e=>d("city",e.target.value),className:"bg-gray-50 border-gray-200 text-gray-900 placeholder-gray-400 mt-1 sm:mt-2",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(i.Label,{className:"text-sm sm:text-gray-700",children:"Postal Code *"}),(0,t.jsx)(l.Input,{value:r.postalCode,onChange:e=>d("postalCode",e.target.value),className:"bg-gray-50 border-gray-200 text-gray-900 placeholder-gray-400 mt-1 sm:mt-2",required:!0})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(i.Label,{className:"text-sm sm:text-gray-700",children:"Country *"}),(0,t.jsxs)(o.Select,{value:r.country,onValueChange:e=>d("country",e),children:[(0,t.jsx)(o.SelectTrigger,{className:"bg-gray-50 border-gray-200 text-gray-900 mt-1 sm:mt-2",children:(0,t.jsx)(o.SelectValue,{})}),(0,t.jsx)(o.SelectContent,{className:"bg-white border-gray-200",children:n.map(e=>(0,t.jsx)(o.SelectItem,{value:e.code,className:"text-gray-900 hover:bg-gray-100",children:e.name},e.code))})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(i.Label,{className:"text-sm sm:text-gray-700",children:"State/Province *"}),"US"===r.country?(0,t.jsxs)(o.Select,{value:r.state,onValueChange:e=>d("state",e),children:[(0,t.jsx)(o.SelectTrigger,{className:"bg-gray-50 border-gray-200 text-gray-900 mt-1 sm:mt-2",children:(0,t.jsx)(o.SelectValue,{})}),(0,t.jsx)(o.SelectContent,{className:"bg-white border-gray-200 max-h-60",children:c.map(e=>(0,t.jsx)(o.SelectItem,{value:e,className:"text-gray-900 hover:bg-gray-100",children:e},e))})]}):(0,t.jsx)(l.Input,{value:r.state,onChange:e=>d("state",e.target.value),placeholder:"State/Province",className:"bg-gray-50 border-gray-200 text-gray-900 placeholder-gray-400 mt-1 sm:mt-2",required:!0})]})]})]})]})]})}var m=e.i(15788),u=e.i(63209),x=e.i(64659);function p({selectedOptionId:e,onSelectionChange:r}){let[a,l]=(0,s.useState)([]),[i,o]=(0,s.useState)(!0),[n,c]=(0,s.useState)(null),[d,p]=(0,s.useState)(null);(0,s.useEffect)(()=>{(async()=>{let t=null;for(let s=1;s<=3;s++)try{let a="/api/shipping-options";console.log(`Attempting to fetch shipping options (attempt ${s}/3) from:`,a);let i=new AbortController,n=setTimeout(()=>i.abort(),3e4);try{console.log("Starting fetch request for shipping options...");let t=await fetch(a,{method:"GET",headers:{"Content-Type":"application/json"},signal:i.signal}).catch(e=>{throw console.error("Network/CORS error details:",{message:e.message,type:e.constructor.name,stack:e.stack}),e});if(clearTimeout(n),console.log("Shipping options response status:",t.status),!t.ok){let e=(await t.json().catch(()=>({}))).error||`HTTP ${t.status}`;throw Error(`Failed to fetch shipping options: ${e}`)}let s=(await t.json()).data||[];if(console.log("Shipping options loaded successfully:",s.length),l(s),c(null),o(!1),s.length>0&&!e){let e=s[0],t=g(e);r(e.id,e.cost,t,e.name)}return}catch(e){if(clearTimeout(n),t=e instanceof Error&&"AbortError"===e.name?Error("Request timeout: Shipping options are taking too long to load"):e instanceof Error?e:Error(String(e)),console.warn(`Attempt ${s} failed:`,t.message),s<3){let e=Math.min(1e3*Math.pow(2,s-1),5e3);console.log(`Retrying in ${e}ms...`),await new Promise(t=>setTimeout(t,e))}throw t}}catch(e){if(t=e instanceof Error?e:Error(String(e)),3===s){console.error("All fetch attempts failed:",t);let s=t.message||"Failed to load shipping options";console.error("Full error details:",{error:e,message:s,type:t.constructor.name,stack:t.stack});let r=s;(s.includes("Failed to fetch")||s.includes("NetworkError"))&&(r="Network error: Unable to reach the server. Please check your connection and try again."),c(r),o(!1);break}}})()},[]);let g=e=>{let t=e.processing_time_days+e.estimated_delivery_days_max,s=new Date;return s.setDate(s.getDate()+t),s.toISOString().split("T")[0]},h=e=>{let t=g(e);r(e.id,e.cost,t,e.name)};return i?(0,t.jsxs)("div",{className:"backdrop-blur-xl bg-white border border-gray-200 rounded-lg p-4",children:[(0,t.jsxs)("h4",{className:"text-gray-900 font-bold mb-2 text-sm flex items-center gap-2",children:[(0,t.jsx)(m.Truck,{className:"w-4 h-4"}),"Shipping"]}),(0,t.jsxs)("div",{className:"flex items-center justify-center py-4",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"}),(0,t.jsx)("span",{className:"ml-2 text-gray-600 text-xs",children:"Loading..."})]})]}):n?(0,t.jsxs)("div",{className:"backdrop-blur-xl bg-white border border-gray-200 rounded-lg p-4",children:[(0,t.jsxs)("h4",{className:"text-gray-900 font-bold mb-2 text-sm flex items-center gap-2",children:[(0,t.jsx)(m.Truck,{className:"w-4 h-4"}),"Shipping"]}),(0,t.jsxs)("div",{className:"flex items-start gap-2 bg-red-500/20 border border-red-500/50 rounded p-3",children:[(0,t.jsx)(u.AlertCircle,{className:"w-4 h-4 text-red-400 flex-shrink-0 mt-0.5"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("p",{className:"text-red-400 text-xs font-medium mb-1",children:n}),(0,t.jsx)("p",{className:"text-red-400/70 text-xs",children:"Shipping costs will be calculated during checkout. You can continue without selecting an option."})]})]})]}):0===a.length?(0,t.jsxs)("div",{className:"backdrop-blur-xl bg-white border border-gray-200 rounded-lg p-4",children:[(0,t.jsxs)("h4",{className:"text-gray-900 font-bold mb-2 text-sm flex items-center gap-2",children:[(0,t.jsx)(m.Truck,{className:"w-4 h-4"}),"Shipping"]}),(0,t.jsx)("p",{className:"text-gray-600 text-xs",children:"No options available. Costs will be calculated at checkout."})]}):(0,t.jsxs)("div",{className:"backdrop-blur-xl bg-white border border-gray-200 rounded-lg p-4",children:[(0,t.jsxs)("h4",{className:"text-gray-900 font-bold mb-2 text-sm flex items-center gap-2",children:[(0,t.jsx)(m.Truck,{className:"w-4 h-4"}),"Shipping"]}),(0,t.jsx)("div",{className:"space-y-2",children:a.map(s=>{let r,a,l,i,{min:o,max:n}=(r=s.processing_time_days+s.estimated_delivery_days_min,a=s.processing_time_days+s.estimated_delivery_days_max,(l=new Date).setDate(l.getDate()+r),(i=new Date).setDate(i.getDate()+a),{min:l.toISOString().split("T")[0],max:i.toISOString().split("T")[0]}),c=new Date(o),m=new Date(n),u=c.toLocaleDateString("en-US",{month:"short",day:"numeric"}),g=m.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}),y=d===s.id,b=e===s.id;return(0,t.jsxs)("div",{className:"overflow-hidden rounded-lg border border-gray-200",children:[(0,t.jsxs)("button",{onClick:()=>{p(y?null:s.id),b||h(s)},className:`w-full flex items-center gap-2 p-3 transition-all text-sm ${b?"bg-blue-50 border-blue-600/50":"bg-white/5 hover:bg-gray-50"}`,children:[(0,t.jsx)("input",{type:"radio",name:"shipping-option",value:s.id,checked:b,onChange:()=>h(s),className:"w-4 h-4 cursor-pointer flex-shrink-0"}),(0,t.jsxs)("div",{className:"flex-1 text-left min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-baseline justify-between gap-2",children:[(0,t.jsx)("p",{className:"text-gray-900 font-semibold truncate",children:s.name}),(0,t.jsxs)("span",{className:"text-gray-900 font-bold flex-shrink-0 whitespace-nowrap",children:["$",s.cost.toFixed(2)]})]}),(0,t.jsxs)("p",{className:"text-xs text-gray-600 line-clamp-1",children:[s.processing_time_days,"d +"," ",s.estimated_delivery_days_min,"-",s.estimated_delivery_days_max,"d = ",u," ","to ",g]})]}),(0,t.jsx)(x.ChevronDown,{className:`w-4 h-4 text-gray-900/40 flex-shrink-0 transition-transform ${y?"rotate-180":""}`})]}),y&&(0,t.jsxs)("div",{className:"border-t border-gray-200 bg-white/5 p-3 space-y-3 text-xs text-gray-900/70",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("h5",{className:"font-semibold text-gray-900 text-sm",children:"Timing Breakdown"}),(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"Processing"}),(0,t.jsxs)("span",{className:"text-gray-900 font-medium",children:[s.processing_time_days," day",1!==s.processing_time_days?"s":""]})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"Shipping"}),(0,t.jsxs)("span",{className:"text-gray-900 font-medium",children:[s.estimated_delivery_days_min,"-",s.estimated_delivery_days_max," days"]})]}),(0,t.jsxs)("div",{className:"border-t border-gray-200 pt-1 flex justify-between",children:[(0,t.jsx)("span",{children:"Total"}),(0,t.jsxs)("span",{className:"text-gray-900 font-medium",children:[s.processing_time_days+s.estimated_delivery_days_min,"-",s.processing_time_days+s.estimated_delivery_days_max," ","days"]})]})]})]}),(0,t.jsxs)("div",{className:"space-y-1 border-t border-gray-200 pt-2",children:[(0,t.jsx)("h5",{className:"font-semibold text-gray-900 text-sm",children:"Estimated Delivery"}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"Earliest"}),(0,t.jsx)("span",{className:"text-green-400 font-medium",children:u})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"Latest"}),(0,t.jsx)("span",{className:"text-green-400 font-medium",children:g})]})]}),s.description&&(0,t.jsxs)("div",{className:"border-t border-gray-200 pt-2",children:[(0,t.jsx)("h5",{className:"font-semibold text-gray-900 text-sm mb-1",children:"Details"}),(0,t.jsx)("p",{className:"text-gray-600",children:s.description})]})]})]},s.id)})})]})}let g={get url(){return`file://${e.P("components/SquarePaymentForm.tsx")}`}};function h({amount:e,orderId:r,customerEmail:a,customerName:l,onPaymentSuccess:i,isLoading:o=!1,applicationId:n}){let c=(0,s.useRef)(!1);return(0,s.useEffect)(()=>{c.current||(async()=>{try{let t=0;for(;!window.Square&&t<100;)await new Promise(e=>setTimeout(e,100)),t++;if(!window.Square){console.error("Square SDK not loaded after timeout - check CSP headers and network");let e=document.getElementById("payment-status-container");e&&(e.innerHTML='<div class="text-red-600">Square SDK failed to load. Check browser console for details.</div>');return}console.log("Square SDK loaded successfully after",t,"attempts"),c.current=!0;let s=g.env.VITE_SQUARE_APP_ID,o=g.env.VITE_SQUARE_LOCATION_ID;if(!s||!o){console.error("Square credentials not configured");let e=document.getElementById("payment-status-container");e&&(e.innerHTML='<div class="text-red-600">Payment system not configured. Please contact support.</div>');return}let n=window.Square.payments(s,o);console.log("Square payments object created with appId:",s);let d=await n.card();if(console.log("Card object created"),!document.getElementById("card-container"))throw Error("Card container element (#card-container) not found in DOM");await d.attach("#card-container"),console.log("Card attached to container successfully");let m=document.getElementById("card-button");m&&m.addEventListener("click",async()=>{let t=document.getElementById("payment-status-container");try{t&&(t.innerHTML='<div class="text-gray-900">Processing payment...</div>');let s=await d.tokenize();if("OK"===s.status){let o;console.log(`Payment token is ${s.token}`),t&&(t.innerHTML='<div class="text-gray-900">Sending payment to Square...</div>');let n=await fetch("/api/square/create-payment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sourceId:s.token,amount:e,currency:"USD",orderId:r,customerEmail:a,customerId:l})});console.log("Payment response status:",n.status);try{o=await n.json()}catch(e){throw console.error("Error parsing payment response:",e),Error("Failed to parse payment response from server")}if(console.log("Payment response data:",o),n.ok&&o.success)console.log("Payment created successfully:",o.payment),t&&(t.innerHTML=`
                      <div class="bg-green-50 border border-green-200 rounded-lg p-3 space-y-2">
                        <div class="text-green-700 font-bold">âœ“ Payment completed successfully!</div>
                        <div class="text-sm text-green-600">Payment ID: ${o.payment.id}</div>
                        <div class="text-sm text-green-600">Amount: $${o.payment.amount.toFixed(2)}</div>
                      </div>
                    `),setTimeout(()=>{i(s.token)},2e3);else{let e=`Payment creation failed: ${o.error||"Unknown error"}`;throw o.details&&(e+=` - ${o.details}`),Error(e)}}else{let e=`Tokenization failed with status: ${s.status}`;throw s.errors&&(e+=` - ${JSON.stringify(s.errors)}`),Error(e)}}catch(e){if(console.error("Payment error:",e),t){let s=e instanceof Error?e.message:"Payment failed";t.innerHTML=`
                  <div class="bg-red-50 border border-red-200 rounded-lg p-3">
                    <div class="text-red-700 font-bold">âœ— Payment Failed</div>
                    <div class="text-sm text-red-600 mt-1">${s}</div>
                  </div>
                `}}})}catch(e){console.error("Failed to initialize Square payments:",e)}})()},[e,r,a,l,i]),(0,t.jsx)("div",{id:"payment-form",className:"space-y-4",children:(0,t.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:"Payment Details"}),(0,t.jsxs)("p",{className:"text-gray-600 text-sm",children:["Amount: $",e.toFixed(2)]})]}),(0,t.jsx)("div",{id:"payment-status-container",className:"mb-4 text-sm font-medium text-gray-900"}),(0,t.jsx)("div",{id:"card-container",className:"mb-6 p-4 bg-gray-50 rounded-lg border border-gray-200 min-h-14"}),(0,t.jsxs)("button",{id:"card-button",type:"button",disabled:o,className:"w-full bg-green-500 hover:bg-green-600 text-white font-bold py-3 rounded-lg transition-all disabled:opacity-50",children:["Pay $",e.toFixed(2)]}),(0,t.jsx)("p",{className:"text-xs text-gray-500 text-center mt-4",children:"Secure payment powered by Square"})]})})}var y=e.i(67881),b=e.i(31278),f=e.i(27612),j=e.i(62031),N=e.i(46696),v=e.i(43705),S=e.i(81097);function w(){let e=(0,r.useNavigate)(),[i]=(0,a.useSearchParams)(),o=i.get("cartId"),[n,c]=(0,s.useState)([]),[m,g]=(0,s.useState)(!0),[w,_]=(0,s.useState)(!1),[k,C]=(0,s.useState)(!1),[P,I]=(0,s.useState)(!1),[T,E]=(0,s.useState)(0),[A,F]=(0,s.useState)(""),[q,$]=(0,s.useState)(0),[D,L]=(0,s.useState)(0),{storeCredit:O,fetchStoreCredit:R}=(0,v.useStoreCredit)(),[U,M]=(0,s.useState)(null),[B,H]=(0,s.useState)(0),[V,Y]=(0,s.useState)(null),[W,K]=(0,s.useState)(""),[J,z]=(0,s.useState)({subtotal:0,tax:0,shipping:0,discount:0,blindShipmentFee:0,additionalPayment:0,total:0,storeCredit:0,appliedStoreCredit:0}),[G,Q]=(0,s.useState)({email:"",firstName:"",lastName:"",phone:"",street:"",street2:"",city:"",state:"CA",postalCode:"",country:"US"}),[X,Z]=(0,s.useState)({sameAsShipping:!0,firstName:"",lastName:"",street:"",street2:"",city:"",state:"CA",postalCode:"",country:"US"}),[ee,et]=(0,s.useState)(!1),[es,er]=(0,s.useState)(null),[ea,el]=(0,s.useState)(!1),[ei,eo]=(0,s.useState)(!1),[en,ec]=(0,s.useState)(null),[ed,em]=(0,s.useState)(!1),[eu,ex]=(0,s.useState)(!0),[ep,eg]=(0,s.useState)(!0),[eh,ey]=(0,s.useState)(!1),[eb,ef]=(0,s.useState)(!1);(0,s.useEffect)(()=>{let e=async()=>{try{let e,t=o||localStorage.getItem("cart_id"),s=localStorage.getItem("cart");if(s){let e=JSON.parse(s),t=[];for(let s of e)try{let e=`/api/public/products/${s.productId}`;if(s.productId.startsWith("admin_")){let t=s.productId.split("_")[1];e=`/api/public/products/admin/${t}`}else if(s.productId.startsWith("imported_")){let t=s.productId.split("_")[1];e=`/api/public/products/imported/${t}`}let r=await fetch(e);if(!r.ok){console.warn(`Failed to fetch product ${s.productId}: HTTP ${r.status}`);continue}let a=await r.json(),l=a.product||a;t.push({product_id:s.productId,product_name:l.name,quantity:s.quantity,price:s.pricePerUnit||l.base_price||0,image:l.images?.[0]?.url,basePrice:s.basePrice,savePercentage:s.savePercentage,design_file_url:s.design_file_url,selectedOptions:s.selectedOptions,options:l.options})}catch(e){console.warn(`Failed to load product ${s.productId}:`,e instanceof Error?e.message:e)}c(t);let r=t.reduce((e,t)=>e+(t.price||0)*t.quantity,0);ej(r,0),g(!1);return}if(!t){console.log("No cart ID found, skipping cart load"),g(!1);return}console.log("Loading cart with ID:",t);try{e=await fetch(`/api/cart/${t}`)}catch(e){console.warn("Network error loading cart:",e),g(!1);return}if(!e.ok){console.error("Failed to load cart - HTTP error:",{status:e.status,statusText:e.statusText});try{let t=await e.json();console.error("Error response data:",t)}catch(e){console.error("Could not parse error response")}if(404===e.status){console.warn("Cart not found, continuing with empty cart"),g(!1);return}throw Error(`Failed to load cart: ${e.status} ${e.statusText}`)}try{let t=await e.json(),s=t.data?.line_items||[];console.log("Cart loaded successfully:",{itemCount:s.length,subtotal:t.data?.subtotal});let r=[];for(let e of s)try{let t=await fetch(`/api/public/products/${e.product_id}`);if(t.ok){let s=(await t.json()).product;r.push({...e,options:s.options})}else r.push(e)}catch(t){console.warn(`Failed to fetch product ${e.product_id}:`,t instanceof Error?t.message:t),r.push(e)}c(r);let a=r.reduce((e,t)=>e+(t.price||.25)*t.quantity,0);ej(a,0)}catch(e){throw console.error("Error parsing cart response:",e),Error("Failed to parse cart response")}}catch(t){let e=t instanceof Error?t.message:String(t);console.error("Failed to load cart:",{message:e,error:t}),N.toast.error(`Cart loading error: ${e}`)}finally{g(!1)}};(async()=>{try{let e=localStorage.getItem("authToken");if(!e)return;let t=await fetch("/api/customers/me",{headers:{Authorization:`Bearer ${e}`}});if(t.ok){let e=await t.json();if(e.customer){let t=e.customer,s=t.addresses?.[0];console.log("Loaded customer info:",{email:t.email,firstName:t.firstName,lastName:t.lastName,phone:t.phone,addresses:t.addresses?.length||0});let r=s?.country_code||"US",a=["US","CA","GB","AU"].includes(r)?r:"US";Q({email:t.email||"",firstName:t.firstName||"",lastName:t.lastName||"",phone:t.phone||"",street:s?.street_1||"",street2:s?.street_2||"",city:s?.city||"",state:s?.state_or_province||"CA",postalCode:s?.postal_code||"",country:a})}}else console.warn("Failed to load customer info, status:",t.status)}catch(e){console.warn("Failed to load customer info:",e)}})(),e(),R();let t=()=>{document.hidden||R()};return document.addEventListener("visibilitychange",t),()=>{document.removeEventListener("visibilitychange",t)}},[o,R]),(0,s.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/return-refund-policy");if(e.ok){let t=await e.json();ec(t.policy)}}catch(e){console.error("Failed to fetch policy:",e)}})()},[]);let ej=(e,t,s=D,r=B)=>{let a=5*!!P,l=T/100*(e+0+r+a-t),i=Math.max(0,e+0+r+a+l-t-s);z({subtotal:e,tax:0,shipping:r,discount:t,blindShipmentFee:a,additionalPayment:l,total:i,storeCredit:.05*i,appliedStoreCredit:s})},eN=async()=>{if(!A)return void N.toast.error("Please enter a discount code");try{let e=await fetch("/api/discounts/validate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:A,orderTotal:J.subtotal})}),t=await e.json();if(!e.ok)return void N.toast.error(t.error||"Invalid discount code");if(t.success&&t.discount){let e=t.discount.amount;$(e),ej(J.subtotal,e,D),N.toast.success(`Discount applied! You save $${e.toFixed(2)}`)}}catch(e){console.error("Error applying discount code:",e),N.toast.error("Failed to apply discount code")}},ev=async e=>{if(e.preventDefault(),G.firstName&&G.lastName&&G.email&&G.phone&&G.street&&G.city&&G.state&&G.postalCode&&G.country?X.sameAsShipping||X.firstName&&X.lastName&&X.street&&X.city&&X.state&&X.postalCode&&X.country?0===n.length?(N.toast.error("Your cart is empty"),!1):ea?ed?eh?!!eb||(N.toast.error("Please agree to the Shipping Policy to proceed"),!1):(N.toast.error("Please agree to the Terms of Service to proceed"),!1):(N.toast.error("Please agree to the Privacy Policy to proceed"),!1):(N.toast.error("Please agree to the Return & Refund Policy to proceed"),!1):(N.toast.error("Please fill in all required billing fields"),!1):(N.toast.error("Please fill in all required shipping fields"),!1)){_(!0);try{let e,t,s=localStorage.getItem("customerId"),r={amount:J.total,currency:"USD",items:n.map(e=>({product_id:e.product_id,product_name:e.product_name,quantity:e.quantity,price:e.price,design_file_url:e.design_file_url,options:e.selectedOptions&&Object.keys(e.selectedOptions).length>0?Object.entries(e.selectedOptions).map(([t,s])=>{let r=e.options?.find(e=>e.id===t),a=r?.values?.find(e=>e.id===s),l=a?.name||s,i=a?.priceModifier||0;return{option_id:t,option_name:r?.name,option_value:l,modifier_price:i}}):e.product_options&&e.product_options.length>0?e.product_options.map(t=>{let s;if("string"==typeof t)return{option_id:"custom",option_value:t,modifier_price:0};let r=t.modifier_price||0;if(!r&&e.options&&t.option_id){let s=e.options.find(e=>e.id===t.option_id);if(s&&s.values){let e=s.values.find(e=>e.id===t.option_value||e.name===t.option_value);r=e?.priceModifier||0}}return{option_id:t.option_id||"custom",option_name:(s=e.options?.find(e=>e.id===t.option_id),s?.name||void 0),option_value:t.option_value||"",modifier_price:r}}):[]})),phone:G.phone,shippingAddress:{firstName:G.firstName,lastName:G.lastName,street:G.street,street2:G.street2,city:G.city,state:G.state,postalCode:G.postalCode,country:G.country},billingAddress:X.sameAsShipping?{firstName:G.firstName,lastName:G.lastName,street:G.street,street2:G.street2,city:G.city,state:G.state,postalCode:G.postalCode,country:G.country}:{firstName:X.firstName,lastName:X.lastName,street:X.street,street2:X.street2,city:X.city,state:X.state,postalCode:X.postalCode,country:X.country},subtotal:J.subtotal,tax:J.tax,shipping:J.shipping,discount:q,discountCode:A||void 0,total:J.total,appliedStoreCredit:D,customerId:s?parseInt(s):void 0,customerEmail:G.email,customerName:`${G.firstName} ${G.lastName}`,...U&&{shipping_option_id:U},shipping_option_name:W,estimated_delivery_date:V,policies:{returnAndRefund:ea,privacy:ed,gdpr:eu,ccpa:ep,terms:eh,shipping:eb}};console.log("Checkout payload being sent:",{amount:r.amount,items:r.items?.length,customerEmail:r.customerEmail,total:r.total,payloadSize:JSON.stringify(r).length});let a=new AbortController,l=setTimeout(()=>a.abort(),3e4);try{e=await fetch("/api/square/checkout",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r),signal:a.signal}),clearTimeout(l),console.log("Checkout response status:",e.status);try{t=await e.json()}catch(t){throw console.error("Failed to parse checkout response:",t),Error(`Server error (${e.status}): Could not parse response`)}if(console.log("Checkout response data:",t),!e.ok){let s=t?.error||t?.message||`HTTP ${e.status}: Checkout failed`;throw Error(s)}}catch(e){if(clearTimeout(l),e instanceof Error&&"AbortError"===e.name)throw Error("Request timeout: Checkout is taking too long. Please try again.");if(e instanceof TypeError)throw console.error("Network error details:",{message:e.message,stack:e.stack}),Error(`Network error: ${e.message}. Please check your connection and try again.`);throw e}if(t.order?.id)er(t.order.id),t.checkoutUrl?(N.toast.success("Order created! Redirecting to payment..."),setTimeout(()=>{window.location.href=t.checkoutUrl},1e3)):(et(!0),N.toast.success("Order created! Please complete payment below."));else throw Error("No order ID returned from checkout")}catch(t){let e=t instanceof Error?t.message:"Checkout failed";N.toast.error(e)}finally{_(!1)}}};return m?(0,t.jsx)(t.Fragment,{children:(0,t.jsx)("main",{className:"pt-20 min-h-screen bg-[#fafafa] flex items-center justify-center",children:(0,t.jsx)(b.Loader2,{className:"w-8 h-8 animate-spin text-blue-600"})})}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("a",{href:"#checkout-form",className:"sr-only focus:not-sr-only focus:absolute focus:top-0 focus:left-0 focus:z-50 bg-blue-600 text-white px-4 py-2",children:"Skip to checkout form"}),(0,t.jsx)("main",{className:"pt-20 min-h-screen bg-[#fafafa] text-gray-900 px-4 sm:px-6 md:px-10 py-6 sm:py-8 md:py-12",id:"checkout-main",role:"main","aria-label":"Checkout page",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto pt-[15px]",children:[(0,t.jsx)("h1",{className:"text-2xl sm:text-3xl md:text-4xl font-bold mb-4 sm:mb-6 md:mb-8",children:"Your Cart"}),(0,t.jsx)("form",{onSubmit:ev,children:(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,t.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[n.map((e,s)=>{let r,a,l,i;return(0,t.jsx)("div",{className:"backdrop-blur-xl bg-white border border-gray-200 rounded-2xl p-4 sm:p-6",children:(0,t.jsxs)("div",{className:"flex gap-3 sm:gap-6 flex-col sm:flex-row",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-3 sm:gap-4 flex-shrink-0",children:[(0,t.jsx)("div",{className:"w-24 h-24 sm:w-40 md:w-48 sm:h-40 md:h-48 bg-gradient-to-br from-gray-100 to-gray-200 rounded-xl flex items-center justify-center",children:e.image?(0,t.jsx)("img",{src:e.image,alt:e.product_name,className:"w-full h-full object-cover rounded-xl"}):(0,t.jsx)("div",{className:"text-gray-500 text-center",children:(0,t.jsx)("p",{className:"text-sm",children:"No image"})})}),e.design_file_url&&(0,t.jsx)("div",{className:"w-24 sm:w-40 md:w-48 bg-white border border-gray-200 rounded-xl flex items-center justify-center p-2",children:e.design_file_url.match(/\.(jpg|jpeg|png|gif|webp)$/i)||e.design_file_url.startsWith("data:image")?(0,t.jsx)("img",{src:e.design_file_url,alt:"Design thumbnail",className:"w-full h-auto object-contain rounded-lg"}):(0,t.jsx)("div",{className:"p-4 text-center",children:(0,t.jsx)("p",{className:"text-xs text-gray-600",children:"Design file uploaded"})})})]}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-3 sm:mb-4 gap-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg sm:text-xl font-bold",children:e.product_name||`Product #${e.product_id}`}),(0,t.jsx)("div",{className:"text-sm space-y-1",children:e.savePercentage&&e.savePercentage>0?(0,t.jsx)(t.Fragment,{children:(a=(r=e.basePrice||e.price/(1-e.savePercentage/100))*e.quantity,l=r*e.savePercentage/100*e.quantity,i=(e.price||.25)*e.quantity,(0,t.jsxs)(t.Fragment,{children:[r>0&&(0,t.jsxs)("p",{className:"text-gray-600",children:["Regular: $",a.toFixed(2)]}),(0,t.jsxs)("p",{className:"text-gray-600",children:["Quantity: ",e.quantity]}),(0,t.jsxs)("p",{className:"text-green-600 font-semibold",children:["Save ",e.savePercentage,"%"]}),(0,t.jsxs)("p",{className:"text-green-600",children:["Amount Saved: $",l.toFixed(2)]}),(0,t.jsxs)("p",{className:"text-gray-900 font-bold border-t border-gray-200 pt-1",children:["Total: $",i.toFixed(2)]})]}))}):(0,t.jsxs)("p",{className:"text-gray-600",children:["$",((e.price||.25)*e.quantity).toFixed(2)]})})]}),(0,t.jsx)("button",{type:"button",onClick:()=>(e=>{let t=n.filter((t,s)=>s!==e);c(t);let s=localStorage.getItem("cart");if(s){let t=JSON.parse(s),r=t.filter((t,s)=>s!==e);localStorage.setItem("cart",JSON.stringify(r));let a=r.reduce((e,t)=>e+t.quantity,0);window.dispatchEvent(new StorageEvent("storage",{key:"cart",newValue:JSON.stringify(r),oldValue:JSON.stringify(t),storageArea:localStorage})),N.toast.success(0===a?"Item removed from cart":1===a?"1 item removed - 1 item remaining":`Item removed - ${a} items remaining in cart`)}else N.toast.success("Item removed from cart");ej(t.reduce((e,t)=>e+(t.price||.25)*t.quantity,0),q,D)})(s),className:"text-red-500 hover:text-red-400 transition",children:(0,t.jsx)(f.Trash2,{className:"w-5 h-5"})})]}),(0,t.jsxs)("div",{className:"space-y-3 bg-gray-50 rounded-lg p-4 mb-4",children:[(0,t.jsx)("h4",{className:"text-blue-600 text-sm font-bold uppercase tracking-wider",children:"Product Specifications"}),(0,t.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Price per sticker"}),(0,t.jsxs)("span",{className:"font-medium",children:["$",(e.price||.25).toFixed(2)]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Quantity"}),(0,t.jsx)("span",{className:"font-medium",children:e.quantity})]}),e.selectedOptions&&Object.keys(e.selectedOptions).length>0&&(0,t.jsx)(t.Fragment,{children:Object.entries(e.selectedOptions).map(([s,r])=>{let a=e.options?.find(e=>e.id===s),l=a?.values?.find(e=>e.id===r),i=l?.name||r;return(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-gray-600",children:a?.name||"Option"}),(0,t.jsx)("span",{className:"font-medium",children:i})]},s)})}),!e.selectedOptions&&e.product_options&&e.product_options.length>0&&(0,t.jsx)(t.Fragment,{children:e.product_options.map((s,r)=>{let a="string"==typeof s?s:s.option_value||"",l="string"!=typeof s&&s.option_id&&e.options?e.options.find(e=>e.id===s.option_id)?.name:null;return(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-gray-600",children:l||"Option"}),(0,t.jsx)("span",{className:"font-medium",children:a})]},r)})})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-blue-600 text-sm font-bold uppercase tracking-wider",children:"Additional Notes"}),(0,t.jsx)("textarea",{placeholder:"Any special instructions or requests...",rows:3,className:"w-full bg-white border border-gray-200 rounded-lg px-4 py-2 text-gray-900 placeholder-gray-400 text-sm"})]})]})]})},s)}),(0,t.jsx)("div",{className:"backdrop-blur-xl bg-white border border-gray-200 rounded-2xl p-6",children:(0,t.jsxs)("fieldset",{children:[(0,t.jsx)("legend",{className:"sr-only",children:"Discount Code Section"}),q>0?(0,t.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:(0,t.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Discount Applied"}),(0,t.jsxs)("p",{className:"text-xl font-bold text-green-600",children:["-$",q.toFixed(2)]}),(0,t.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Code:"," ",(0,t.jsx)("code",{className:"font-mono",children:A})]})]}),(0,t.jsx)(y.Button,{type:"button",onClick:()=>{F(""),$(0),ej(J.subtotal,0,D),N.toast.info("Discount code removed")},variant:"outline",className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:"Remove"})]})}):(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)("div",{className:"flex-1 relative",children:[(0,t.jsx)("label",{htmlFor:"discount-code",className:"sr-only",children:"Discount code"}),(0,t.jsx)(l.Input,{id:"discount-code",placeholder:"Discount code",value:A,onChange:e=>F(e.target.value),onKeyDown:e=>{"Enter"===e.key&&eN()},className:"bg-gray-50 border-gray-200 text-gray-900 placeholder-gray-400","aria-label":"Discount code","aria-describedby":"discount-help"}),(0,t.jsx)("span",{id:"discount-help",className:"sr-only",children:"Enter your discount code to apply savings to your order"})]}),(0,t.jsx)(y.Button,{type:"button",onClick:eN,disabled:!A,className:"bg-green-500 hover:bg-green-600 text-white px-6","aria-label":"Apply discount code",children:"Apply"})]})]})}),(0,t.jsx)(d,{customerInfo:G,billingInfo:X,onCustomerChange:(e,t)=>{Q(s=>({...s,[e]:t}))},onBillingChange:(e,t)=>{"sameAsShipping"===e?(Z(e=>({...e,sameAsShipping:t})),t&&Z(e=>({...e,firstName:G.firstName,lastName:G.lastName,street:G.street,street2:G.street2,city:G.city,state:G.state,postalCode:G.postalCode,country:G.country}))):Z(s=>({...s,[e]:t}))}}),(0,t.jsxs)("div",{className:"backdrop-blur-xl bg-white border border-gray-200 rounded-2xl p-6",children:[(0,t.jsxs)("button",{type:"button",onClick:()=>eo(!ei),className:"w-full flex items-center justify-between mb-4 hover:opacity-80 transition",children:[(0,t.jsx)("h4",{className:"text-gray-900 font-bold text-lg",children:"Return & Refund Policy"}),(0,t.jsx)(x.ChevronDown,{className:`w-5 h-5 text-gray-600 transition-transform ${ei?"rotate-180":""}`})]}),ei&&(0,t.jsx)("div",{className:"mb-4 pb-4 border-b border-gray-200",children:(0,t.jsx)("div",{className:"bg-gray-50 rounded-lg p-4 mb-4 max-h-80 overflow-y-auto text-sm space-y-3",children:en?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{className:"font-semibold text-gray-900 mb-2",children:[en.guarantee_days,"-Day Money-Back Guarantee"]}),(0,t.jsxs)("p",{className:"text-gray-600",children:["We offer a ",en.guarantee_days,"-day money-back guarantee on all orders. If you're not satisfied with your custom stickers for any reason, you can request a full refund within"," ",en.guarantee_days," days of your purchase."]})]}),en.return_conditions&&en.return_conditions.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-semibold text-gray-900 mb-2",children:"Return Conditions"}),(0,t.jsx)("ul",{className:"text-gray-600 space-y-1",children:en.return_conditions.map((e,s)=>(0,t.jsxs)("li",{children:["â€¢ ",e]},s))})]}),en.how_to_return&&en.how_to_return.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-semibold text-gray-900 mb-2",children:"How to Return"}),(0,t.jsx)("ol",{className:"text-gray-600 space-y-1",children:en.how_to_return.map((e,s)=>(0,t.jsxs)("li",{children:[s+1,". ",e]},s))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-semibold text-gray-900 mb-2",children:"Defective or Damaged Items"}),(0,t.jsxs)("p",{className:"text-gray-600",children:["If your stickers arrive damaged or defective, we'll replace them at no cost to you within"," ",en.defective_items_days," days of delivery."]})]}),en.non_returnable_items&&en.non_returnable_items.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-semibold text-gray-900 mb-2",children:"Non-Returnable Items"}),(0,t.jsx)("ul",{className:"text-gray-600 space-y-1",children:en.non_returnable_items.map((e,s)=>(0,t.jsxs)("li",{children:["â€¢ ",e]},s))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-semibold text-gray-900 mb-2",children:"Refund Timeline"}),(0,t.jsx)("p",{className:"text-gray-600",children:en.refund_timeline})]}),(0,t.jsx)("div",{className:"flex items-center gap-2 pt-2 border-t border-gray-200",children:(0,t.jsx)("a",{href:"/return-refund-policy",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 font-medium text-sm",children:"Read Full Policy â†’"})})]}):(0,t.jsx)("p",{className:"text-gray-500 text-sm",children:"Loading policy..."})})}),(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)("input",{type:"checkbox",id:"agreeToPolicy",checked:ea,onChange:e=>el(e.target.checked),className:"w-5 h-5 rounded border-gray-300 text-green-600 focus:ring-2 focus:ring-green-500 mt-1 flex-shrink-0 cursor-pointer"}),(0,t.jsxs)("label",{htmlFor:"agreeToPolicy",className:"text-gray-600 text-sm flex-1 cursor-pointer",children:["I have read and agree to the"," ",(0,t.jsx)("a",{href:"/return-refund-policy",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 font-medium",children:"Return & Refund Policy"})]})]}),!ea&&(0,t.jsxs)("div",{className:"mt-3 p-3 bg-amber-50 border border-amber-200 rounded-lg flex gap-2",role:"alert",children:[(0,t.jsx)(u.AlertCircle,{className:"w-4 h-4 text-amber-600 flex-shrink-0 mt-0.5","aria-hidden":"true"}),(0,t.jsx)("p",{className:"text-xs text-amber-800",children:"You must agree to the Return & Refund Policy to complete your purchase."})]}),(0,t.jsxs)("div",{className:"border-t border-gray-200 pt-6 mt-6",children:[(0,t.jsx)("h4",{className:"text-gray-900 font-bold text-lg mb-4",children:"Privacy & Data Protection"}),(0,t.jsxs)("div",{className:"flex items-start gap-3 mb-4",children:[(0,t.jsx)("input",{type:"checkbox",id:"agreeToPrivacy",checked:ed,onChange:e=>em(e.target.checked),className:"w-5 h-5 rounded border-gray-300 text-blue-600 focus:ring-2 focus:ring-blue-500 mt-1 flex-shrink-0 cursor-pointer"}),(0,t.jsxs)("label",{htmlFor:"agreeToPrivacy",className:"text-gray-600 text-sm flex-1 cursor-pointer",children:["I have read and agree to the"," ",(0,t.jsx)("a",{href:"/privacy",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 font-medium",children:"Privacy Policy"})]})]}),(0,t.jsxs)("div",{className:"flex items-start gap-3 mb-4",children:[(0,t.jsx)("input",{type:"checkbox",id:"agreeToTerms",checked:eh,onChange:e=>ey(e.target.checked),className:"w-5 h-5 rounded border-gray-300 text-red-600 focus:ring-2 focus:ring-red-500 mt-1 flex-shrink-0 cursor-pointer"}),(0,t.jsxs)("label",{htmlFor:"agreeToTerms",className:"text-gray-600 text-sm flex-1 cursor-pointer",children:["I have read and agree to the"," ",(0,t.jsx)("a",{href:"/terms",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 font-medium",children:"Terms of Service"})]})]}),(0,t.jsxs)("div",{className:"flex items-start gap-3 mb-4",children:[(0,t.jsx)("input",{type:"checkbox",id:"agreeToShippingPolicy",checked:eb,onChange:e=>ef(e.target.checked),className:"w-5 h-5 rounded border-gray-300 text-green-600 focus:ring-2 focus:ring-green-500 mt-1 flex-shrink-0 cursor-pointer"}),(0,t.jsxs)("label",{htmlFor:"agreeToShippingPolicy",className:"text-gray-600 text-sm flex-1 cursor-pointer",children:["I have read and agree to the"," ",(0,t.jsx)("a",{href:"/shipping",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 font-medium",children:"Shipping Policy"})]})]}),(0,t.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 text-sm text-gray-700",children:[(0,t.jsx)("p",{className:"font-semibold text-gray-900 mb-2",children:"How We Handle Your Data"}),(0,t.jsxs)("ul",{className:"space-y-2 text-xs",children:[(0,t.jsx)("li",{children:"âœ“ Your personal information is encrypted and transmitted securely using SSL/TLS"}),(0,t.jsx)("li",{children:"âœ“ Payment information is processed by Square and never stored on our servers"}),(0,t.jsx)("li",{children:"âœ“ We do not sell or share your personal data with third parties for marketing"}),(0,t.jsx)("li",{children:"âœ“ You can request access, correction, or deletion of your data at any time"}),(0,t.jsx)("li",{children:"âœ“ We retain your data only as long as necessary for order fulfillment and legal compliance"})]})]})]}),(!ed||!eh||!eb)&&(0,t.jsxs)("div",{className:"mt-4 p-3 bg-amber-50 border border-amber-200 rounded-lg flex gap-2",children:[(0,t.jsx)(u.AlertCircle,{className:"w-4 h-4 text-amber-600 flex-shrink-0 mt-0.5"}),(0,t.jsx)("p",{className:"text-xs text-amber-800",children:"You must agree to all policies and terms to complete your purchase."})]}),(0,t.jsxs)("div",{className:"backdrop-blur-xl bg-white border border-gray-200 rounded-2xl p-6 mt-6",children:[(0,t.jsx)("h4",{className:"text-gray-900 font-bold mb-4 flex items-center gap-2",children:"ðŸ’¬ Need Help?"}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-gray-600 mb-1",children:"Email Support"}),(0,t.jsx)("a",{href:"mailto:sticky@stickerland.com",className:"text-blue-600 hover:text-blue-700 font-medium text-sm break-all",children:"sticky@stickerland.com"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-gray-600 mb-1",children:"Create a Support Ticket"}),(0,t.jsx)("a",{href:"/support",className:"text-blue-600 hover:text-blue-700 font-medium text-sm",children:"Contact Support â†’"})]}),(0,t.jsx)("div",{className:"pt-2 border-t border-gray-200",children:(0,t.jsx)("p",{className:"text-xs text-gray-500",children:"We typically respond within 24 hours"})})]})]})]})]}),(0,t.jsx)("div",{className:"lg:col-span-1",children:(0,t.jsxs)("div",{className:"sticky top-32 space-y-6",children:[(0,t.jsxs)("div",{className:"backdrop-blur-xl bg-white border border-gray-200 rounded-2xl p-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsx)("h3",{className:"text-xl font-bold",children:"Order Summary"}),(0,t.jsx)("button",{type:"button",className:"text-gray-600 hover:text-gray-900 transition",children:(0,t.jsx)(j.Share2,{className:"w-5 h-5"})})]}),(0,t.jsxs)("div",{className:"space-y-3 text-sm mb-6 pb-6 border-b border-gray-200",children:[(0,t.jsxs)("div",{className:"flex justify-between text-gray-600",children:[(0,t.jsxs)("span",{children:["Subtotal (",n.length," items)"]}),(0,t.jsxs)("span",{children:["$",J.subtotal.toFixed(2)]})]}),(0,t.jsxs)("div",{className:"flex justify-between text-gray-600",children:[(0,t.jsx)("span",{children:"You're paying"}),(0,t.jsxs)("span",{children:["$",(J.subtotal/(n.reduce((e,t)=>e+t.quantity,0)||1)).toFixed(2)," ","per sticker"]})]}),B>0&&(0,t.jsxs)("div",{className:"flex justify-between text-blue-600",children:[(0,t.jsx)("span",{children:"Shipping"}),(0,t.jsxs)("span",{className:"font-bold",children:["$",B.toFixed(2)]})]}),0===B&&(0,t.jsxs)("div",{className:"flex justify-between text-green-600",children:[(0,t.jsx)("span",{children:"Shipping"}),(0,t.jsx)("span",{className:"font-bold",children:"FREE"})]}),q>0&&(0,t.jsxs)("div",{className:"flex justify-between text-green-600",children:[(0,t.jsx)("span",{children:"Deal Savings"}),(0,t.jsxs)("span",{className:"font-bold",children:["-$",q.toFixed(2)]})]}),P&&(0,t.jsxs)("div",{className:"flex justify-between text-orange-600",children:[(0,t.jsx)("span",{children:"Blind Shipment Fee"}),(0,t.jsxs)("span",{children:["+$",J.blindShipmentFee.toFixed(2)]})]}),J.additionalPayment>0&&(0,t.jsxs)("div",{className:"flex justify-between text-orange-600",children:[(0,t.jsx)("span",{children:"Additional Payment"}),(0,t.jsxs)("span",{children:["+$",J.additionalPayment.toFixed(2)]})]})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6 text-xl font-bold",children:[(0,t.jsx)("span",{children:"Total"}),(0,t.jsxs)("span",{children:["$",J.total.toFixed(2)]})]})]}),(0,t.jsx)(p,{selectedOptionId:U,onSelectionChange:(e,t,s,r)=>{M(e),H(t),Y(s),K(r),ej(J.subtotal,q,D,t)}}),V&&(0,t.jsxs)("div",{className:"backdrop-blur-xl bg-white border border-gray-200 rounded-2xl p-6",children:[(0,t.jsx)("h4",{className:"text-gray-900 font-bold mb-4 flex items-center gap-2",children:"ðŸ“¦ Estimated Delivery"}),(0,t.jsxs)("div",{className:"border-t border-gray-200 pt-3 flex justify-between font-bold text-lg",children:[(0,t.jsx)("span",{children:"Delivery by"}),(0,t.jsx)("span",{className:"text-green-600",children:new Date(V).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})})]}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-3",children:"* Delivery may not occur on weekends. Dates are automatically moved to the next business day."})]}),ee&&es?(0,t.jsxs)("div",{className:"mb-3",children:[(0,t.jsx)(h,{amount:J.total,orderId:es,customerEmail:G.email,customerName:`${G.firstName} ${G.lastName}`,onPaymentSuccess:t=>{localStorage.removeItem("cart"),localStorage.removeItem("cart_id"),es&&setTimeout(()=>{let t=(0,S.formatOrderNumber)(es);e(`/order-confirmation/${t}`)},1e3)},isLoading:w}),(0,t.jsxs)("div",{className:"mt-4 p-3 bg-green-50 border border-green-200 rounded-lg flex items-center gap-3",children:[(0,t.jsx)("div",{className:"flex-shrink-0",children:(0,t.jsx)("svg",{className:"w-5 h-5 text-green-600",fill:"currentColor",viewBox:"0 0 20 20",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-semibold text-green-900",children:"PCI DSS Level 1 Compliant"}),(0,t.jsx)("p",{className:"text-xs text-green-700",children:"Your payment information is processed securely by Square Payment Systems, certified to PCI DSS Level 1 standards."})]})]})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(y.Button,{type:"submit",disabled:w||!ea||!ed||!eh||!eb,className:"w-full bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white py-6 text-lg font-bold rounded-lg mb-3 disabled:opacity-50 disabled:cursor-not-allowed",children:w?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(b.Loader2,{className:"w-5 h-5 mr-2 animate-spin"}),"Processing..."]}):(0,t.jsx)(t.Fragment,{children:"ðŸ’³ Go to Checkout"})}),(0,t.jsx)("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:(0,t.jsxs)("p",{className:"text-xs text-blue-800",children:["ðŸ”’"," ",(0,t.jsx)("span",{className:"font-semibold",children:"Payment Security:"})," ","Your payment information will be processed securely by Square Payment Systems, which is PCI DSS Level 1 certified. We never store your credit card information on our servers."]})})]})]})})]})})]})})]})}e.s(["default",()=>w],92274)}]);