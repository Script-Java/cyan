module.exports=[60753,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(65967),e=a.i(73320),f=a.i(34075),g=a.i(13749),h=a.i(92983),i=a.i(40695),j=a.i(5522),k=a.i(46893),l=a.i(17171),m=a.i(77687);function n(){let a,{productId:n}=(0,d.useParams)(),o=(0,d.useNavigate)(),{toast:p}=(0,m.useToast)(),[q,r]=(0,c.useState)(null),[s,t]=(0,c.useState)(!0),[u,v]=(0,c.useState)(0),[w,x]=(0,c.useState)({}),[y,z]=(0,c.useState)(null),[A,B]=(0,c.useState)(null),[C,D]=(0,c.useState)({}),[E,F]=(0,c.useState)(""),[G,H]=(0,c.useState)(100),[I,J]=(0,c.useState)(!1),[K,L]=(0,c.useState)(100),M=a=>{try{let b=localStorage.getItem(`product_defaults_${a}`);return b?JSON.parse(b):{}}catch{return{}}},N=a=>{if(n)try{localStorage.setItem(`product_defaults_${n}`,JSON.stringify(a))}catch(a){console.error("Failed to save default options:",a)}};(0,c.useEffect)(()=>{(async()=>{try{if(!n)return;let a=await fetch(`/api/public/products/${n}`);if(!a.ok)throw Error("Failed to fetch product");let b=await a.json();r(b.product);let c=M(n),d={};b.product.options.forEach(a=>{c[a.id]?d[a.id]=c[a.id]:a.defaultValueId&&(d[a.id]=a.defaultValueId)}),x(d),c.quantity&&(H(c.quantity),L(c.quantity));let e={};b.product.optional_fields.forEach(a=>{e[a.name]=""}),D(e)}catch(a){console.error("Error fetching product:",a),p({title:"Error",description:"Failed to load product",variant:"destructive"})}finally{t(!1)}})()},[n,p]);let O=()=>{if(!q)return 0;let a=(()=>{if(!q?.shared_variants)return null;for(let a of q.shared_variants){let b=!0;for(let c of a.optionSelections){let a=w[c.optionId];if(!a||!c.selectedValueIds.includes(a)){b=!1;break}}if(b)return a}return null})();if(a)return a.price.toFixed(2);let b=0,c=!1;return(Object.entries(w).forEach(([a,d])=>{let e=q.options.find(b=>b.id===a);if(e){let a=e.values.find(a=>a.id===d);a&&0!==a.priceModifier&&(c=!0,b+=a.priceModifier)}}),c)?b.toFixed(2):q.base_price.toFixed(2)},P=async()=>{let a=(q?.options.filter(a=>a.required)||[]).filter(a=>!w[a.id]);if(a.length>0)return void p({title:"Missing Required Options",description:`Please select: ${a.map(a=>a.name).join(", ")}`,variant:"destructive"});N(w),J(!0);try{let a,b=parseFloat(O()),c=[{qty:50,discountPercent:0},{qty:100,discountPercent:0},{qty:200,discountPercent:0},{qty:300,discountPercent:0},{qty:500,discountPercent:0},{qty:1e3,discountPercent:0},{qty:2500,discountPercent:0}].find(a=>a.qty===G),d=c?.discountPercent||0,e=b*(1-d/100);if(y)try{let b=new FileReader,c=await new Promise(a=>{b.onload=b=>{let c=(b.target?.result).split(",")[1];a(c)},b.readAsDataURL(y)}),d=localStorage.getItem("authToken"),e=await fetch("/api/designs/upload",{method:"POST",headers:{"Content-Type":"application/json",...d&&{Authorization:`Bearer ${d}`}},body:JSON.stringify({fileData:c,fileName:y.name,fileType:y.type})});if(!e.ok)throw Error("Failed to upload design file");a=(await e.json()).fileUrl}catch(a){console.error("Error uploading design file:",a),p({title:"Warning",description:"Design file upload failed. Try again or continue without uploading.",variant:"destructive"})}let f={productId:n,selectedOptions:w,design_file_url:a,optionalFields:C,orderNotes:E,quantity:G,pricePerUnit:e,totalPrice:e*G,basePrice:b,savePercentage:d},g=JSON.parse(localStorage.getItem("cart")||"[]");g.push(f),localStorage.setItem("cart",JSON.stringify(g)),p({title:"Success",description:"Product added to cart! You can continue shopping or proceed to checkout."})}catch(a){console.error("Error adding to cart:",a),p({title:"Error",description:"Failed to add product to cart",variant:"destructive"})}finally{J(!1)}};return s?(0,b.jsx)(b.Fragment,{children:(0,b.jsx)("div",{className:"min-h-screen bg-[#fafafa] text-black flex items-center justify-center",children:(0,b.jsx)("div",{className:"text-center",children:(0,b.jsx)("p",{className:"text-gray-600",children:"Loading product..."})})})}):q?(0,b.jsx)(b.Fragment,{children:(0,b.jsx)("main",{className:"min-h-screen bg-white text-black",children:(0,b.jsxs)("div",{style:{maxWidth:"1100px",margin:"0 auto 3px",padding:"12px 12px 80px"},className:"px-3 sm:px-4 lg:px-6",children:[(0,b.jsx)("button",{onClick:()=>o("/products"),className:"flex items-center gap-2 text-blue-600 hover:text-blue-700 transition mb-2",children:(0,b.jsx)(g.ChevronLeft,{className:"w-5 h-5"})}),(0,b.jsx)("div",{className:"mb-3 bg-white rounded-lg border border-gray-200 p-3",style:{backdropFilter:"blur(4px)",backgroundColor:"rgb(255, 255, 255)",borderColor:"rgba(220, 220, 220, 0.8)"},children:(0,b.jsx)("div",{className:"mb-2",children:(0,b.jsx)(h.default,{images:q.images.map(a=>a.url),productName:q.name,productDescription:q.description})})}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3 mb-3",children:[q.options.map(a=>(0,b.jsxs)("div",{className:"backdrop-blur-xl bg-gray-50 border border-gray-200 rounded-lg",style:{marginRight:"0px",padding:"10px 8px 10px 8px"},children:[(0,b.jsxs)("h2",{className:"text-xs font-bold mb-1.5 flex items-center gap-1",children:["Shape"===a.name&&(0,b.jsx)("img",{src:"https://res.cloudinary.com/dxcnvqk6b/image/upload/v1763135086/StickerShuttle_DieCutIcon_r0vire.png",alt:a.name,className:"w-5 h-5"}),"Material"===a.name&&(0,b.jsx)("img",{src:"https://res.cloudinary.com/dxcnvqk6b/image/upload/v1763228661/StickerShuttle_KissCutIcon_pynbqq.png",alt:a.name,className:"w-5 h-5"}),"Size"===a.name&&(0,b.jsx)("img",{src:"https://res.cloudinary.com/dxcnvqk6b/image/upload/v1763135086/StickerShuttle_CircleIcon_igib6i.png",alt:a.name,className:"w-5 h-5"}),(0,b.jsxs)("span",{className:"truncate",children:["Select a ",a.name]})]}),"dropdown"===a.type&&(0,b.jsx)("div",{className:"grid grid-cols-2 gap-1.5",children:a.values.map((c,d)=>(0,b.jsxs)("button",{onClick:()=>{let b={...w,[a.id]:c.id};x(b),N(b)},className:`relative flex flex-col items-center justify-center border-2 rounded p-1.5 transition text-center ${w[a.id]===c.id?"border-purple-500 bg-purple-100 shadow-lg shadow-purple-200/50":"border-gray-200 hover:border-gray-300 bg-gray-50"}`,children:["Material"===a.name&&c.name?.toLowerCase()==="satin"?(0,b.jsx)("img",{src:"https://cdn.builder.io/api/v1/image/assets%2F1e00ee8c48924560b1c928d354e4521b%2F1b04ce3e2b7342ff891113ccedd6beda?format=webp&width=800",alt:"Satin",className:"w-8 h-8 object-contain mb-0.5"}):c.image&&(0,b.jsx)("img",{src:c.image.preview||c.image.url,alt:c.name,className:"w-8 h-8 object-contain mb-0.5"}),(0,b.jsx)("p",{className:"font-medium text-xs text-black",children:c.name}),0!==c.priceModifier&&(0,b.jsxs)("p",{className:"text-xs text-gray-600 mt-0.5",children:["+$",c.priceModifier.toFixed(2)]}),0===d&&(0,b.jsx)("span",{className:"absolute top-1 right-1 text-xxs font-bold text-white bg-purple-600 px-1.5 py-0.5 rounded",style:{fontSize:"10px"},children:"Popular"})]},c.id))}),"radio"===a.type&&(0,b.jsx)("div",{className:"grid grid-cols-2 gap-1",children:a.values.map(c=>(0,b.jsxs)("button",{onClick:()=>{let b={...w,[a.id]:c.id};x(b),N(b)},className:`border-2 rounded-lg p-1 transition text-center text-xs ${w[a.id]===c.id?"border-purple-500 bg-purple-100":"border-gray-200 hover:border-gray-300 bg-gray-50"}`,children:[c.image&&(0,b.jsx)("img",{src:c.image.preview||c.image.url,alt:c.name,className:"w-8 h-8 object-cover mx-auto mb-0.5 rounded"}),(0,b.jsx)("p",{className:"font-medium text-xs text-black",children:c.name}),0!==c.priceModifier&&(0,b.jsxs)("p",{className:"text-xs text-gray-600 mt-0.5",children:["+$",c.priceModifier.toFixed(2)]})]},c.id))}),"swatch"===a.type&&(0,b.jsx)("div",{className:"grid grid-cols-2 gap-1.5",children:a.values.map(c=>(0,b.jsxs)("button",{onClick:()=>{let b={...w,[a.id]:c.id};x(b),N(b)},className:`relative border-2 rounded overflow-hidden transition flex flex-col items-center justify-center p-1 ${w[a.id]===c.id?"border-purple-500":"border-gray-200 hover:border-gray-300"}`,children:[c.image?(0,b.jsx)("img",{src:c.image.preview||c.image.url,alt:c.name,className:"w-10 h-10 object-contain"}):(0,b.jsx)("div",{className:"w-full h-10 bg-gray-100 flex items-center justify-center",children:(0,b.jsx)("span",{className:"text-gray-600 text-xs text-center px-1 truncate",children:c.name})}),(0,b.jsx)("span",{className:"text-gray-700 text-xs mt-0.5 font-medium text-center truncate",children:c.name}),(0,b.jsxs)("span",{className:"text-purple-600 text-xs font-bold mt-0.5",children:["$",((a,b)=>{if(!q)return 0;let c=q.options.find(b=>b.id===a);if(c){let a=c.values.find(a=>a.id===b);if(a)return a.priceModifier}return 0})(a.id,c.id).toFixed(2)]})]},c.id))}),"text"===a.type&&(0,b.jsx)(j.Input,{type:"text",value:w[a.id]||"",onChange:b=>x(c=>({...c,[a.id]:b.target.value})),placeholder:`Enter ${a.name}`,className:"bg-gray-50 border-gray-200 text-black placeholder-gray-500 text-xs"})]},a.id)),(0,b.jsxs)("div",{className:"rounded-lg border transition",style:{margin:"0 0 0 0",padding:"10px 8px",backdropFilter:"blur(12px)",backgroundColor:"rgba(255, 255, 255, 0.05)",borderColor:"rgba(255, 255, 255, 0.1)",borderWidth:"1px",boxShadow:"rgba(0, 0, 0, 0.3) 0px 8px 32px 0px, rgba(255, 255, 255, 0.1) 0px 1px 0px 0px inset"},children:[(0,b.jsxs)("h2",{className:"font-bold mb-1.5 flex items-center gap-1 text-xs",style:{fontFamily:"Rubik, sans-serif",fontSize:"12px",fontWeight:"700",color:"rgb(0, 0, 0)",lineHeight:"20px"},children:[(0,b.jsx)("svg",{fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",style:{width:"16px",height:"16px",stroke:"rgb(0, 0, 0)"},children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M7 20l4-16m2 16l4-16M6 9h14M4 15h14"})}),"Select a quantity"]}),(0,b.jsx)("div",{style:{position:"relative"},children:(a=parseFloat(O()),[{qty:50,discountPercent:0},{qty:100,discountPercent:0},{qty:200,discountPercent:0},{qty:300,discountPercent:0},{qty:500,discountPercent:0},{qty:1e3,discountPercent:0},{qty:2500,discountPercent:0}].map(b=>{let c=a*(1-b.discountPercent/100)*b.qty;return{qty:b.qty,price:c,save:b.discountPercent>0?b.discountPercent:null}})).map((a,c)=>(0,b.jsxs)("button",{onClick:()=>{if(H(a.qty),L(a.qty),n)try{let b=M(n);localStorage.setItem(`product_defaults_${n}`,JSON.stringify({...b,quantity:a.qty}))}catch(a){console.error("Failed to save default quantity:",a)}},style:{marginBottom:"3px",width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"6px 8px",borderRadius:"6px",border:K===a.qty?"2px solid rgb(253, 224, 71)":"1px solid oklab(0.714 0.117894 -0.165257 / 0.2)",backdropFilter:"blur(12px)",backgroundColor:K===a.qty?"rgba(253, 224, 71, 0.15)":"rgba(255, 255, 255, 0.1)",color:"rgb(0, 0, 0)",cursor:"pointer",transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)"},children:[(0,b.jsx)("span",{style:{fontFamily:"Rubik, sans-serif",fontSize:"14px",fontWeight:"500",color:"rgb(0, 0, 0)",lineHeight:"20px"},children:a.qty.toLocaleString()}),(0,b.jsx)("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:(0,b.jsxs)("span",{style:{fontFamily:"Rubik, sans-serif",fontWeight:"600",color:"rgb(0, 0, 0)",fontSize:"13px"},children:["$",a.price.toFixed(2)]})})]},a.qty))})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-3 mb-3",children:[q.optional_fields.length>0&&(0,b.jsxs)("div",{className:"backdrop-blur-xl bg-gray-50 border border-gray-200 rounded-lg p-3",children:[(0,b.jsx)("h2",{className:"text-xs font-bold mb-1.5",children:"âœï¸ Additional Instructions (optional)"}),(0,b.jsx)("div",{className:"space-y-1.5",children:q.optional_fields.map(a=>(0,b.jsxs)("div",{children:[(0,b.jsx)(l.Label,{className:"text-gray-700 text-xs mb-1 block",children:a.name}),"textarea"===a.type?(0,b.jsx)(k.Textarea,{value:C[a.name]||"",onChange:b=>D(c=>({...c,[a.name]:b.target.value})),placeholder:"Enter any special requests or instructions here...",className:"bg-gray-50 border-gray-200 text-black placeholder-gray-500 min-h-12 text-xs"}):"date"===a.type?(0,b.jsx)(j.Input,{type:"date",value:C[a.name]||"",onChange:b=>D(c=>({...c,[a.name]:b.target.value})),className:"bg-gray-50 border-gray-200 text-black placeholder-gray-500 text-xs"}):"number"===a.type?(0,b.jsx)(j.Input,{type:"number",value:C[a.name]||"",onChange:b=>D(c=>({...c,[a.name]:b.target.value})),placeholder:`Enter ${a.name}`,className:"bg-gray-50 border-gray-200 text-black placeholder-gray-500 text-xs"}):(0,b.jsx)(j.Input,{type:"text",value:C[a.name]||"",onChange:b=>D(c=>({...c,[a.name]:b.target.value})),placeholder:`Enter ${a.name}`,className:"bg-gray-50 border-gray-200 text-black placeholder-gray-500 text-xs"})]},a.name))})]}),q.customer_upload_config.enabled&&(0,b.jsxs)("div",{className:"backdrop-blur-xl bg-gray-50 border border-gray-200 rounded-lg p-3",children:[(0,b.jsx)("h2",{className:"text-xs font-bold mb-1",children:"Upload your artwork"}),(0,b.jsx)("p",{className:"text-gray-600 text-xs mb-1.5",children:q.customer_upload_config.description}),A?(0,b.jsxs)("div",{className:"space-y-1.5",children:[(0,b.jsxs)("div",{className:"relative bg-gray-50 border border-gray-200 rounded overflow-hidden",children:[(0,b.jsx)("img",{src:A,alt:"Design preview",className:"w-full h-20 object-contain p-1.5"}),(0,b.jsx)("button",{onClick:()=>{z(null),B(null)},className:"absolute top-2 right-2 bg-red-600/80 hover:bg-red-700 text-white p-1 rounded",children:(0,b.jsx)(f.X,{className:"w-4 h-4"})})]}),(0,b.jsxs)("p",{className:"text-gray-600 text-xs",children:[y?.name," (",((y?.size||0)/1024/1024).toFixed(2)," MB)"]})]}):(0,b.jsxs)("label",{className:"flex flex-col items-center justify-center gap-1.5 border-2 border-dashed border-green-600 rounded p-2 cursor-pointer hover:border-green-700 transition bg-green-50",children:[(0,b.jsx)("img",{src:"https://cdn.builder.io/api/v1/image/assets%2F1e00ee8c48924560b1c928d354e4521b%2Fcee606b598864f7a983db9ee1358acf5?format=webp&width=800",alt:"Upload",className:"w-8 h-8"}),(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("p",{className:"text-black font-medium text-xs",children:"Drag or click to upload"}),(0,b.jsxs)("p",{className:"text-gray-600 text-xs mt-0.5",children:["All formats supported. Max file size:"," ",q.customer_upload_config.maxFileSize,"MB | 1 file per order"]})]}),(0,b.jsx)("input",{type:"file",accept:q.customer_upload_config.allowedFormats.map(a=>`.${a}`).join(","),onChange:a=>{let b=a.target.files?.[0];if(!b)return;if(!q?.customer_upload_config.allowedFormats.includes(b.name.split(".").pop()?.toLowerCase()||""))return void p({title:"Invalid File Format",description:`Allowed formats: ${q?.customer_upload_config.allowedFormats.join(", ")}`,variant:"destructive"});if(b.size>1024*(q?.customer_upload_config.maxFileSize||5)*1024)return void p({title:"File Too Large",description:`Maximum file size: ${q?.customer_upload_config.maxFileSize}MB`,variant:"destructive"});z(b);let c=new FileReader;c.onload=a=>{B(a.target?.result)},c.readAsDataURL(b)},className:"hidden"})]})]}),(0,b.jsxs)("div",{className:"backdrop-blur-xl bg-gray-50 border border-gray-200 rounded-lg p-3",children:[(0,b.jsx)("h2",{className:"text-xs font-bold mb-1.5",children:"ðŸ“ Order Notes (optional)"}),(0,b.jsx)(k.Textarea,{value:E,onChange:a=>F(a.target.value),placeholder:"Add any special requests or notes...",className:"bg-white border-gray-300 text-black placeholder-gray-500 min-h-10 text-xs"}),(0,b.jsx)("p",{className:"text-gray-600 text-xs mt-1",children:"Let us know about any special requirements or customizations"})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[(0,b.jsx)("div",{className:"backdrop-blur-xl bg-gray-50 border border-gray-200 rounded-lg p-3",children:(0,b.jsxs)(i.Button,{onClick:P,disabled:I||!q.availability,className:"w-full bg-white/60 hover:bg-[#FFD713] border border-gray-300 text-black hover:text-black py-1.5 text-xs font-semibold gap-2 rounded transition-all disabled:bg-gray-100 disabled:text-gray-400",children:[(0,b.jsx)(e.Upload,{className:"w-3 h-3"}),I?"Adding...":q.availability?"Add to Cart":"Out of Stock"]})}),(0,b.jsx)("div",{className:"backdrop-blur-xl bg-gray-50 border border-gray-200 rounded-lg p-3",children:(0,b.jsx)(i.Button,{onClick:()=>o("/checkout-new"),className:"w-full bg-white/60 hover:bg-[#FFD713] border border-gray-300 text-black hover:text-black py-1.5 text-xs font-semibold gap-2 rounded transition-all",children:"ðŸ›’ Checkout"})})]}),(0,b.jsx)("p",{className:"text-center text-gray-600 text-xs",children:"Continue adding products or proceed to checkout when ready"})]})]})})}):(0,b.jsx)(b.Fragment,{children:(0,b.jsx)("div",{className:"min-h-screen bg-[#fafafa] text-black flex items-center justify-center",children:(0,b.jsx)("div",{className:"text-center",children:(0,b.jsx)("p",{className:"text-gray-600",children:"Product not found"})})})})}a.s(["default",()=>n])}];

//# sourceMappingURL=client_pages_ProductPage_tsx_75c0be41._.js.map