{"version":3,"sources":["../../../../client/pages/ProductPage.tsx"],"sourcesContent":["import { useEffect, useState } from \"react\";\r\nimport { useParams, useNavigate } from \"react-router-dom\";\r\nimport { Upload, X, ChevronLeft, ChevronRight } from \"lucide-react\";\nimport ProductGallery from \"@/components/ProductGallery\";\nimport { Button } from \"@/components/ui/button\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Textarea } from \"@/components/ui/textarea\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport { useToast } from \"@/hooks/use-toast\";\r\n\r\ninterface ProductImage {\r\n  id: string;\r\n  url: string;\r\n  name: string;\r\n  preview?: string;\r\n}\r\n\r\ninterface VariantValue {\r\n  id: string;\r\n  name: string;\r\n  priceModifier: number;\r\n  image?: {\r\n    id: string;\r\n    url: string;\r\n    name: string;\r\n    preview?: string;\r\n  };\r\n}\r\n\r\ninterface ProductOption {\r\n  id: string;\r\n  name: string;\r\n  type: \"dropdown\" | \"swatch\" | \"radio\" | \"text\";\r\n  required: boolean;\r\n  values: VariantValue[];\r\n  defaultValueId?: string;\r\n  displayOrder: number;\r\n}\r\n\r\ninterface OptionSelection {\r\n  optionId: string;\r\n  optionName: string;\r\n  selectedValueIds: string[];\r\n}\r\n\r\ninterface SharedVariant {\r\n  id: string;\r\n  name: string;\r\n  description: string;\r\n  optionSelections: OptionSelection[];\r\n  price: number;\r\n}\r\n\r\ninterface CustomerUploadConfig {\r\n  enabled: boolean;\r\n  maxFileSize: number;\r\n  allowedFormats: string[];\r\n  description: string;\r\n}\r\n\r\ninterface Product {\r\n  id: string;\r\n  name: string;\r\n  base_price: number;\r\n  description: string;\r\n  images: ProductImage[];\r\n  options: ProductOption[];\r\n  shared_variants?: SharedVariant[];\r\n  customer_upload_config: CustomerUploadConfig;\r\n  optional_fields: { name: string; type: string }[];\r\n  availability: boolean;\r\n}\r\n\r\ninterface CartItem {\r\n  productId: string;\r\n  selectedOptions: { [optionId: string]: string };\r\n  designFile?: File;\r\n  optionalFields: { [fieldName: string]: string };\r\n  quantity: number;\r\n  pricePerUnit: number;\r\n  totalPrice: number;\r\n  basePrice: number;\r\n  savePercentage: number;\r\n}\r\n\r\nexport default function ProductPage() {\r\n  const { productId } = useParams<{ productId: string }>();\r\n  const navigate = useNavigate();\r\n  const { toast } = useToast();\r\n  const [product, setProduct] = useState<Product | null>(null);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [currentImageIndex, setCurrentImageIndex] = useState(0);\r\n  const [selectedOptions, setSelectedOptions] = useState<{\r\n    [optionId: string]: string;\r\n  }>({});\r\n  const [designFile, setDesignFile] = useState<File | null>(null);\r\n  const [designPreview, setDesignPreview] = useState<string | null>(null);\r\n  const [optionalFields, setOptionalFields] = useState<{\r\n    [fieldName: string]: string;\r\n  }>({});\r\n  const [orderNotes, setOrderNotes] = useState(\"\");\r\n  const [quantity, setQuantity] = useState(100);\r\n  const [isAddingToCart, setIsAddingToCart] = useState(false);\r\n  const [activeQuantityOption, setActiveQuantityOption] = useState<\r\n    number | null\r\n  >(100);\r\n\r\n  const getSavedDefaults = (productId: string) => {\r\n    try {\r\n      const saved = localStorage.getItem(`product_defaults_${productId}`);\r\n      return saved ? JSON.parse(saved) : {};\r\n    } catch {\r\n      return {};\r\n    }\r\n  };\r\n\r\n  const saveAsDefault = (options: { [optionId: string]: string }) => {\r\n    if (!productId) return;\r\n    try {\r\n      localStorage.setItem(\r\n        `product_defaults_${productId}`,\r\n        JSON.stringify(options),\r\n      );\r\n    } catch (error) {\r\n      console.error(\"Failed to save default options:\", error);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    const fetchProduct = async () => {\r\n      try {\r\n        if (!productId) return;\r\n\r\n        const response = await fetch(`/api/public/products/${productId}`);\r\n        if (!response.ok) {\r\n          throw new Error(\"Failed to fetch product\");\r\n        }\r\n\r\n        const data = await response.json();\r\n        setProduct(data.product);\r\n\r\n        const savedDefaults = getSavedDefaults(productId);\r\n        const initialOptions: { [key: string]: string } = {};\r\n        data.product.options.forEach((option: ProductOption) => {\r\n          if (savedDefaults[option.id]) {\r\n            initialOptions[option.id] = savedDefaults[option.id];\r\n          } else if (option.defaultValueId) {\r\n            initialOptions[option.id] = option.defaultValueId;\r\n          }\r\n        });\r\n        setSelectedOptions(initialOptions);\r\n\r\n        if (savedDefaults.quantity) {\r\n          setQuantity(savedDefaults.quantity);\r\n          setActiveQuantityOption(savedDefaults.quantity);\r\n        }\r\n\r\n        const initialFields: { [key: string]: string } = {};\r\n        data.product.optional_fields.forEach(\r\n          (field: { name: string; type: string }) => {\r\n            initialFields[field.name] = \"\";\r\n          },\r\n        );\r\n        setOptionalFields(initialFields);\r\n      } catch (error) {\r\n        console.error(\"Error fetching product:\", error);\r\n        toast({\r\n          title: \"Error\",\r\n          description: \"Failed to load product\",\r\n          variant: \"destructive\",\r\n        });\r\n      } finally {\r\n        setIsLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchProduct();\r\n  }, [productId, toast]);\r\n\r\n  const handleDesignUpload = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const file = e.target.files?.[0];\r\n    if (!file) return;\r\n\r\n    if (\r\n      !product?.customer_upload_config.allowedFormats.includes(\r\n        file.name.split(\".\").pop()?.toLowerCase() || \"\",\r\n      )\r\n    ) {\r\n      toast({\r\n        title: \"Invalid File Format\",\r\n        description: `Allowed formats: ${product?.customer_upload_config.allowedFormats.join(\", \")}`,\r\n        variant: \"destructive\",\r\n      });\r\n      return;\r\n    }\r\n\r\n    if (\r\n      file.size >\r\n      (product?.customer_upload_config.maxFileSize || 5) * 1024 * 1024\r\n    ) {\r\n      toast({\r\n        title: \"File Too Large\",\r\n        description: `Maximum file size: ${product?.customer_upload_config.maxFileSize}MB`,\r\n        variant: \"destructive\",\r\n      });\r\n      return;\r\n    }\r\n\r\n    setDesignFile(file);\r\n    const reader = new FileReader();\r\n    reader.onload = (event) => {\r\n      setDesignPreview(event.target?.result as string);\r\n    };\r\n    reader.readAsDataURL(file);\r\n  };\r\n\r\n  const removeDesign = () => {\r\n    setDesignFile(null);\r\n    setDesignPreview(null);\r\n  };\r\n\r\n  const checkSharedVariantMatch = (): SharedVariant | null => {\r\n    if (!product?.shared_variants) return null;\r\n\r\n    for (const sharedVariant of product.shared_variants) {\r\n      let isMatch = true;\r\n\r\n      for (const selection of sharedVariant.optionSelections) {\r\n        const selectedValueId = selectedOptions[selection.optionId];\r\n        if (\r\n          !selectedValueId ||\r\n          !selection.selectedValueIds.includes(selectedValueId)\r\n        ) {\r\n          isMatch = false;\r\n          break;\r\n        }\r\n      }\r\n\r\n      if (isMatch) {\r\n        return sharedVariant;\r\n      }\r\n    }\r\n\r\n    return null;\r\n  };\r\n\r\n  const calculatePriceForValue = (optionId: string, valueId: string) => {\r\n    if (!product) return 0;\r\n\r\n    const option = product.options.find((o) => o.id === optionId);\r\n    if (option) {\r\n      const value = option.values.find((v) => v.id === valueId);\r\n      if (value) {\r\n        return value.priceModifier;\r\n      }\r\n    }\r\n\r\n    return 0;\r\n  };\r\n\r\n  const calculatePrice = () => {\r\n    if (!product) return 0;\r\n\r\n    const matchedSharedVariant = checkSharedVariantMatch();\r\n    if (matchedSharedVariant) {\r\n      return matchedSharedVariant.price.toFixed(2);\r\n    }\r\n\r\n    let totalPrice = 0;\r\n    let hasOptionPrice = false;\r\n\r\n    Object.entries(selectedOptions).forEach(([optionId, valueId]) => {\r\n      const option = product.options.find((o) => o.id === optionId);\r\n      if (option) {\r\n        const value = option.values.find((v) => v.id === valueId);\r\n        if (value && value.priceModifier !== 0) {\r\n          hasOptionPrice = true;\r\n          totalPrice += value.priceModifier;\r\n        }\r\n      }\r\n    });\r\n\r\n    if (hasOptionPrice) {\r\n      return totalPrice.toFixed(2);\r\n    }\r\n\r\n    return product.base_price.toFixed(2);\r\n  };\r\n\r\n  const calculateTotalPrice = () => {\r\n    const pricePerUnit = parseFloat(calculatePrice());\r\n    return (pricePerUnit * quantity).toFixed(2);\r\n  };\r\n\r\n  const calculatePricePerUnit = () => {\r\n    const totalPrice = parseFloat(calculateTotalPrice());\r\n    return (totalPrice / quantity).toFixed(2);\r\n  };\r\n\r\n  const getQuantityTierPricing = () => {\r\n    const basePricePerUnit = parseFloat(calculatePrice());\r\n    const quantityTiers = [\r\n      { qty: 50, discountPercent: 0 },\r\n      { qty: 100, discountPercent: 0 },\r\n      { qty: 200, discountPercent: 0 },\r\n      { qty: 300, discountPercent: 0 },\r\n      { qty: 500, discountPercent: 0 },\r\n      { qty: 1000, discountPercent: 0 },\r\n      { qty: 2500, discountPercent: 0 },\r\n    ];\r\n\r\n    return quantityTiers.map((tier) => {\r\n      const discountedPrice =\r\n        basePricePerUnit * (1 - tier.discountPercent / 100);\r\n      const totalPrice = discountedPrice * tier.qty;\r\n      return {\r\n        qty: tier.qty,\r\n        price: totalPrice,\r\n        save: tier.discountPercent > 0 ? tier.discountPercent : null,\r\n      };\r\n    });\r\n  };\r\n\r\n  const handleAddToCart = async () => {\r\n    const requiredOptions = product?.options.filter((o) => o.required) || [];\r\n    const missingOptions = requiredOptions.filter(\r\n      (o) => !selectedOptions[o.id],\r\n    );\r\n\r\n    if (missingOptions.length > 0) {\r\n      toast({\r\n        title: \"Missing Required Options\",\r\n        description: `Please select: ${missingOptions.map((o) => o.name).join(\", \")}`,\r\n        variant: \"destructive\",\r\n      });\r\n      return;\r\n    }\r\n\r\n    saveAsDefault(selectedOptions);\r\n\r\n    // Design file is now optional - allow adding to cart without it\r\n\r\n    setIsAddingToCart(true);\r\n    try {\r\n      const basePrice = parseFloat(calculatePrice());\r\n\r\n      // Find save percentage for current quantity\r\n      const quantityTiers = [\r\n        { qty: 50, discountPercent: 0 },\r\n        { qty: 100, discountPercent: 0 },\r\n        { qty: 200, discountPercent: 0 },\r\n        { qty: 300, discountPercent: 0 },\r\n        { qty: 500, discountPercent: 0 },\r\n        { qty: 1000, discountPercent: 0 },\r\n        { qty: 2500, discountPercent: 0 },\r\n      ];\r\n      const tierInfo = quantityTiers.find((t) => t.qty === quantity);\r\n      const savePercentage = tierInfo?.discountPercent || 0;\r\n\r\n      // Calculate discounted price based on quantity tier\r\n      const discountedPricePerUnit = basePrice * (1 - savePercentage / 100);\r\n      const totalPrice = discountedPricePerUnit * quantity;\r\n\r\n      // Upload design file to server if provided\r\n      let design_file_url: string | undefined;\r\n      if (designFile) {\r\n        try {\r\n          const reader = new FileReader();\r\n          const fileData = await new Promise<string>((resolve) => {\r\n            reader.onload = (event) => {\r\n              const result = event.target?.result as string;\r\n              // Extract base64 part\r\n              const base64 = result.split(\",\")[1];\r\n              resolve(base64);\r\n            };\r\n            reader.readAsDataURL(designFile);\r\n          });\r\n\r\n          const token = localStorage.getItem(\"authToken\");\r\n          const uploadResponse = await fetch(\"/api/designs/upload\", {\r\n            method: \"POST\",\r\n            headers: {\r\n              \"Content-Type\": \"application/json\",\r\n              ...(token && { Authorization: `Bearer ${token}` }),\r\n            },\r\n            body: JSON.stringify({\r\n              fileData,\r\n              fileName: designFile.name,\r\n              fileType: designFile.type,\r\n            }),\r\n          });\r\n\r\n          if (!uploadResponse.ok) {\r\n            throw new Error(\"Failed to upload design file\");\r\n          }\r\n\r\n          const uploadData = await uploadResponse.json();\r\n          design_file_url = uploadData.fileUrl;\r\n        } catch (error) {\r\n          console.error(\"Error uploading design file:\", error);\r\n          toast({\r\n            title: \"Warning\",\r\n            description:\r\n              \"Design file upload failed. Try again or continue without uploading.\",\r\n            variant: \"destructive\",\r\n          });\r\n        }\r\n      }\r\n\r\n      const cartItem = {\r\n        productId: productId!,\r\n        selectedOptions,\r\n        design_file_url,\r\n        optionalFields,\r\n        orderNotes,\r\n        quantity,\r\n        pricePerUnit: discountedPricePerUnit,\r\n        totalPrice,\r\n        basePrice,\r\n        savePercentage,\r\n      };\r\n\r\n      const existingCart = JSON.parse(localStorage.getItem(\"cart\") || \"[]\");\r\n      existingCart.push(cartItem);\r\n      localStorage.setItem(\"cart\", JSON.stringify(existingCart));\r\n\r\n      toast({\r\n        title: \"Success\",\r\n        description:\r\n          \"Product added to cart! You can continue shopping or proceed to checkout.\",\r\n      });\r\n    } catch (error) {\r\n      console.error(\"Error adding to cart:\", error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to add product to cart\",\r\n        variant: \"destructive\",\r\n      });\r\n    } finally {\r\n      setIsAddingToCart(false);\r\n    }\r\n  };\r\n\r\n  if (isLoading) {\n    return (\n      <>\n        <div className=\"min-h-screen bg-[#fafafa] text-black flex items-center justify-center\">\n          <div className=\"text-center\">\r\n            <p className=\"text-gray-600\">Loading product...</p>\r\n          </div>\r\n        </div>\r\n      </>\r\n    );\r\n  }\r\n\r\n  if (!product) {\n    return (\n      <>\n        <div className=\"min-h-screen bg-[#fafafa] text-black flex items-center justify-center\">\n          <div className=\"text-center\">\r\n            <p className=\"text-gray-600\">Product not found</p>\r\n          </div>\r\n        </div>\r\n      </>\r\n    );\r\n  }\r\n\r\n  return (\n    <>\n      <main className=\"min-h-screen bg-white text-black\">\n        <div\r\n          style={{\r\n            maxWidth: \"1100px\",\r\n            margin: \"0 auto 3px\",\r\n            padding: \"12px 12px 80px\",\r\n          }}\r\n          className=\"px-3 sm:px-4 lg:px-6\"\r\n        >\r\n          {/* Back Navigation */}\r\n          <button\r\n            onClick={() => navigate(\"/products\")}\r\n            className=\"flex items-center gap-2 text-blue-600 hover:text-blue-700 transition mb-2\"\r\n          >\r\n            <ChevronLeft className=\"w-5 h-5\" />\r\n          </button>\r\n\r\n          {/* Product Gallery with Description */}\r\n          <div\r\n            className=\"mb-3 bg-white rounded-lg border border-gray-200 p-3\"\r\n            style={{\r\n              backdropFilter: \"blur(4px)\",\r\n              backgroundColor: \"rgb(255, 255, 255)\",\r\n              borderColor: \"rgba(220, 220, 220, 0.8)\",\r\n            }}\r\n          >\r\n            {/* Gallery at top */}\r\n            <div className=\"mb-2\">\r\n              <ProductGallery\r\n                images={product.images.map((img) => img.url)}\r\n                productName={product.name}\r\n                productDescription={product.description}\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          {/* Main Content Grid - 4 Columns */}\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3 mb-3\">\r\n            {/* Product Options - Each in Own Column */}\r\n            {product.options.map((option) => (\r\n              <div\r\n                key={option.id}\r\n                className=\"backdrop-blur-xl bg-gray-50 border border-gray-200 rounded-lg\"\r\n                style={{ marginRight: \"0px\", padding: \"10px 8px 10px 8px\" }}\r\n              >\r\n                <h2 className=\"text-xs font-bold mb-1.5 flex items-center gap-1\">\r\n                  {option.name === \"Shape\" && (\r\n                    <img\r\n                      src=\"https://res.cloudinary.com/dxcnvqk6b/image/upload/v1763135086/StickerShuttle_DieCutIcon_r0vire.png\"\r\n                      alt={option.name}\r\n                      className=\"w-5 h-5\"\r\n                    />\r\n                  )}\r\n                  {option.name === \"Material\" && (\r\n                    <img\r\n                      src=\"https://res.cloudinary.com/dxcnvqk6b/image/upload/v1763228661/StickerShuttle_KissCutIcon_pynbqq.png\"\r\n                      alt={option.name}\r\n                      className=\"w-5 h-5\"\r\n                    />\r\n                  )}\r\n                  {option.name === \"Size\" && (\r\n                    <img\r\n                      src=\"https://res.cloudinary.com/dxcnvqk6b/image/upload/v1763135086/StickerShuttle_CircleIcon_igib6i.png\"\r\n                      alt={option.name}\r\n                      className=\"w-5 h-5\"\r\n                    />\r\n                  )}\r\n                  <span className=\"truncate\">Select a {option.name}</span>\r\n                </h2>\r\n\r\n                {option.type === \"dropdown\" && (\r\n                  <div className=\"grid grid-cols-2 gap-1.5\">\r\n                    {option.values.map((value, index) => (\r\n                      <button\r\n                        key={value.id}\r\n                        onClick={() => {\r\n                          const newOptions = {\r\n                            ...selectedOptions,\r\n                            [option.id]: value.id,\r\n                          };\r\n                          setSelectedOptions(newOptions);\r\n                          saveAsDefault(newOptions);\r\n                        }}\r\n                        className={`relative flex flex-col items-center justify-center border-2 rounded p-1.5 transition text-center ${\r\n                          selectedOptions[option.id] === value.id\r\n                            ? \"border-purple-500 bg-purple-100 shadow-lg shadow-purple-200/50\"\r\n                            : \"border-gray-200 hover:border-gray-300 bg-gray-50\"\r\n                        }`}\r\n                      >\r\n                        {option.name === \"Material\" &&\r\n                        value.name?.toLowerCase() === \"satin\" ? (\r\n                          <img\r\n                            src=\"https://cdn.builder.io/api/v1/image/assets%2F1e00ee8c48924560b1c928d354e4521b%2F1b04ce3e2b7342ff891113ccedd6beda?format=webp&width=800\"\r\n                            alt=\"Satin\"\r\n                            className=\"w-8 h-8 object-contain mb-0.5\"\r\n                          />\r\n                        ) : (\r\n                          value.image && (\r\n                            <img\r\n                              src={value.image.preview || value.image.url}\r\n                              alt={value.name}\r\n                              className=\"w-8 h-8 object-contain mb-0.5\"\r\n                            />\r\n                          )\r\n                        )}\r\n                        <p className=\"font-medium text-xs text-black\">\r\n                          {value.name}\r\n                        </p>\r\n                        {value.priceModifier !== 0 && (\r\n                          <p className=\"text-xs text-gray-600 mt-0.5\">\r\n                            +${value.priceModifier.toFixed(2)}\r\n                          </p>\r\n                        )}\r\n                        {index === 0 && (\r\n                          <span\r\n                            className=\"absolute top-1 right-1 text-xxs font-bold text-white bg-purple-600 px-1.5 py-0.5 rounded\"\r\n                            style={{ fontSize: \"10px\" }}\r\n                          >\r\n                            Popular\r\n                          </span>\r\n                        )}\r\n                      </button>\r\n                    ))}\r\n                  </div>\r\n                )}\r\n\r\n                {option.type === \"radio\" && (\r\n                  <div className=\"grid grid-cols-2 gap-1\">\r\n                    {option.values.map((value) => (\r\n                      <button\r\n                        key={value.id}\r\n                        onClick={() => {\r\n                          const newOptions = {\r\n                            ...selectedOptions,\r\n                            [option.id]: value.id,\r\n                          };\r\n                          setSelectedOptions(newOptions);\r\n                          saveAsDefault(newOptions);\r\n                        }}\r\n                        className={`border-2 rounded-lg p-1 transition text-center text-xs ${\r\n                          selectedOptions[option.id] === value.id\r\n                            ? \"border-purple-500 bg-purple-100\"\r\n                            : \"border-gray-200 hover:border-gray-300 bg-gray-50\"\r\n                        }`}\r\n                      >\r\n                        {value.image && (\r\n                          <img\r\n                            src={value.image.preview || value.image.url}\r\n                            alt={value.name}\r\n                            className=\"w-8 h-8 object-cover mx-auto mb-0.5 rounded\"\r\n                          />\r\n                        )}\r\n                        <p className=\"font-medium text-xs text-black\">\r\n                          {value.name}\r\n                        </p>\r\n                        {value.priceModifier !== 0 && (\r\n                          <p className=\"text-xs text-gray-600 mt-0.5\">\r\n                            +${value.priceModifier.toFixed(2)}\r\n                          </p>\r\n                        )}\r\n                      </button>\r\n                    ))}\r\n                  </div>\r\n                )}\r\n\r\n                {option.type === \"swatch\" && (\r\n                  <div className=\"grid grid-cols-2 gap-1.5\">\r\n                    {option.values.map((value) => (\r\n                      <button\r\n                        key={value.id}\r\n                        onClick={() => {\r\n                          const newOptions = {\r\n                            ...selectedOptions,\r\n                            [option.id]: value.id,\r\n                          };\r\n                          setSelectedOptions(newOptions);\r\n                          saveAsDefault(newOptions);\r\n                        }}\r\n                        className={`relative border-2 rounded overflow-hidden transition flex flex-col items-center justify-center p-1 ${\r\n                          selectedOptions[option.id] === value.id\r\n                            ? \"border-purple-500\"\r\n                            : \"border-gray-200 hover:border-gray-300\"\r\n                        }`}\r\n                      >\r\n                        {value.image ? (\r\n                          <img\r\n                            src={value.image.preview || value.image.url}\r\n                            alt={value.name}\r\n                            className=\"w-10 h-10 object-contain\"\r\n                          />\r\n                        ) : (\r\n                          <div className=\"w-full h-10 bg-gray-100 flex items-center justify-center\">\r\n                            <span className=\"text-gray-600 text-xs text-center px-1 truncate\">\r\n                              {value.name}\r\n                            </span>\r\n                          </div>\r\n                        )}\r\n                        <span className=\"text-gray-700 text-xs mt-0.5 font-medium text-center truncate\">\r\n                          {value.name}\r\n                        </span>\r\n                        <span className=\"text-purple-600 text-xs font-bold mt-0.5\">\r\n                          $\r\n                          {calculatePriceForValue(option.id, value.id).toFixed(\r\n                            2,\r\n                          )}\r\n                        </span>\r\n                      </button>\r\n                    ))}\r\n                  </div>\r\n                )}\r\n\r\n                {option.type === \"text\" && (\r\n                  <Input\r\n                    type=\"text\"\r\n                    value={selectedOptions[option.id] || \"\"}\r\n                    onChange={(e) =>\r\n                      setSelectedOptions((prev) => ({\r\n                        ...prev,\r\n                        [option.id]: e.target.value,\r\n                      }))\r\n                    }\r\n                    placeholder={`Enter ${option.name}`}\r\n                    className=\"bg-gray-50 border-gray-200 text-black placeholder-gray-500 text-xs\"\r\n                  />\r\n                )}\r\n              </div>\r\n            ))}\r\n\r\n            {/* Quantity Selection Column */}\r\n            <div\r\n              className=\"rounded-lg border transition\"\r\n              style={{\r\n                margin: \"0 0 0 0\",\r\n                padding: \"10px 8px\",\r\n                backdropFilter: \"blur(12px)\",\r\n                backgroundColor: \"rgba(255, 255, 255, 0.05)\",\r\n                borderColor: \"rgba(255, 255, 255, 0.1)\",\r\n                borderWidth: \"1px\",\r\n                boxShadow:\r\n                  \"rgba(0, 0, 0, 0.3) 0px 8px 32px 0px, rgba(255, 255, 255, 0.1) 0px 1px 0px 0px inset\",\r\n              }}\r\n            >\r\n              <h2\r\n                className=\"font-bold mb-1.5 flex items-center gap-1 text-xs\"\r\n                style={{\r\n                  fontFamily: \"Rubik, sans-serif\",\r\n                  fontSize: \"12px\",\r\n                  fontWeight: \"700\",\r\n                  color: \"rgb(0, 0, 0)\",\r\n                  lineHeight: \"20px\",\r\n                }}\r\n              >\r\n                <svg\r\n                  fill=\"none\"\r\n                  viewBox=\"0 0 24 24\"\r\n                  stroke=\"currentColor\"\r\n                  style={{\r\n                    width: \"16px\",\r\n                    height: \"16px\",\r\n                    stroke: \"rgb(0, 0, 0)\",\r\n                  }}\r\n                >\r\n                  <path\r\n                    strokeLinecap=\"round\"\r\n                    strokeLinejoin=\"round\"\r\n                    strokeWidth=\"2\"\r\n                    d=\"M7 20l4-16m2 16l4-16M6 9h14M4 15h14\"\r\n                  />\r\n                </svg>\r\n                Select a quantity\r\n              </h2>\r\n\r\n              <div style={{ position: \"relative\" }}>\r\n                {getQuantityTierPricing().map((option, index) => (\r\n                  <button\r\n                    key={option.qty}\r\n                    onClick={() => {\r\n                      setQuantity(option.qty);\r\n                      setActiveQuantityOption(option.qty);\r\n                      if (productId) {\r\n                        try {\r\n                          const savedDefaults = getSavedDefaults(productId);\r\n                          localStorage.setItem(\r\n                            `product_defaults_${productId}`,\r\n                            JSON.stringify({\r\n                              ...savedDefaults,\r\n                              quantity: option.qty,\r\n                            }),\r\n                          );\r\n                        } catch (error) {\r\n                          console.error(\r\n                            \"Failed to save default quantity:\",\r\n                            error,\r\n                          );\r\n                        }\r\n                      }\r\n                    }}\r\n                    style={{\r\n                      marginBottom: \"3px\",\r\n                      width: \"100%\",\r\n                      display: \"flex\",\r\n                      alignItems: \"center\",\r\n                      justifyContent: \"space-between\",\r\n                      padding: \"6px 8px\",\r\n                      borderRadius: \"6px\",\r\n                      border:\r\n                        activeQuantityOption === option.qty\r\n                          ? \"2px solid rgb(253, 224, 71)\"\r\n                          : \"1px solid oklab(0.714 0.117894 -0.165257 / 0.2)\",\r\n                      backdropFilter: \"blur(12px)\",\r\n                      backgroundColor:\r\n                        activeQuantityOption === option.qty\r\n                          ? \"rgba(253, 224, 71, 0.15)\"\r\n                          : \"rgba(255, 255, 255, 0.1)\",\r\n                      color: \"rgb(0, 0, 0)\",\r\n                      cursor: \"pointer\",\r\n                      transition: \"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)\",\r\n                    }}\r\n                  >\r\n                    <span\r\n                      style={{\r\n                        fontFamily: \"Rubik, sans-serif\",\r\n                        fontSize: \"14px\",\r\n                        fontWeight: \"500\",\r\n                        color: \"rgb(0, 0, 0)\",\r\n                        lineHeight: \"20px\",\r\n                      }}\r\n                    >\r\n                      {option.qty.toLocaleString()}\r\n                    </span>\r\n                    <div\r\n                      style={{\r\n                        display: \"flex\",\r\n                        gap: \"8px\",\r\n                        alignItems: \"center\",\r\n                      }}\r\n                    >\r\n                      <span\r\n                        style={{\r\n                          fontFamily: \"Rubik, sans-serif\",\r\n                          fontWeight: \"600\",\r\n                          color: \"rgb(0, 0, 0)\",\r\n                          fontSize: \"13px\",\r\n                        }}\r\n                      >\r\n                        ${option.price.toFixed(2)}\r\n                      </span>\r\n                    </div>\r\n                  </button>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Below Grid - Additional Fields and Upload */}\r\n          <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-3 mb-3\">\r\n            {/* Additional Fields */}\r\n            {product.optional_fields.length > 0 && (\r\n              <div className=\"backdrop-blur-xl bg-gray-50 border border-gray-200 rounded-lg p-3\">\r\n                <h2 className=\"text-xs font-bold mb-1.5\">\r\n                  ‚úèÔ∏è Additional Instructions (optional)\r\n                </h2>\r\n                <div className=\"space-y-1.5\">\r\n                  {product.optional_fields.map((field) => (\r\n                    <div key={field.name}>\r\n                      <Label className=\"text-gray-700 text-xs mb-1 block\">\r\n                        {field.name}\r\n                      </Label>\r\n                      {field.type === \"textarea\" ? (\r\n                        <Textarea\r\n                          value={optionalFields[field.name] || \"\"}\r\n                          onChange={(e) =>\r\n                            setOptionalFields((prev) => ({\r\n                              ...prev,\r\n                              [field.name]: e.target.value,\r\n                            }))\r\n                          }\r\n                          placeholder={`Enter any special requests or instructions here...`}\r\n                          className=\"bg-gray-50 border-gray-200 text-black placeholder-gray-500 min-h-12 text-xs\"\r\n                        />\r\n                      ) : field.type === \"date\" ? (\r\n                        <Input\r\n                          type=\"date\"\r\n                          value={optionalFields[field.name] || \"\"}\r\n                          onChange={(e) =>\r\n                            setOptionalFields((prev) => ({\r\n                              ...prev,\r\n                              [field.name]: e.target.value,\r\n                            }))\r\n                          }\r\n                          className=\"bg-gray-50 border-gray-200 text-black placeholder-gray-500 text-xs\"\r\n                        />\r\n                      ) : field.type === \"number\" ? (\r\n                        <Input\r\n                          type=\"number\"\r\n                          value={optionalFields[field.name] || \"\"}\r\n                          onChange={(e) =>\r\n                            setOptionalFields((prev) => ({\r\n                              ...prev,\r\n                              [field.name]: e.target.value,\r\n                            }))\r\n                          }\r\n                          placeholder={`Enter ${field.name}`}\r\n                          className=\"bg-gray-50 border-gray-200 text-black placeholder-gray-500 text-xs\"\r\n                        />\r\n                      ) : (\r\n                        <Input\r\n                          type=\"text\"\r\n                          value={optionalFields[field.name] || \"\"}\r\n                          onChange={(e) =>\r\n                            setOptionalFields((prev) => ({\r\n                              ...prev,\r\n                              [field.name]: e.target.value,\r\n                            }))\r\n                          }\r\n                          placeholder={`Enter ${field.name}`}\r\n                          className=\"bg-gray-50 border-gray-200 text-black placeholder-gray-500 text-xs\"\r\n                        />\r\n                      )}\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {/* Custom Design Upload */}\r\n            {product.customer_upload_config.enabled && (\r\n              <div className=\"backdrop-blur-xl bg-gray-50 border border-gray-200 rounded-lg p-3\">\r\n                <h2 className=\"text-xs font-bold mb-1\">Upload your artwork</h2>\r\n                <p className=\"text-gray-600 text-xs mb-1.5\">\r\n                  {product.customer_upload_config.description}\r\n                </p>\r\n\r\n                {designPreview ? (\r\n                  <div className=\"space-y-1.5\">\r\n                    <div className=\"relative bg-gray-50 border border-gray-200 rounded overflow-hidden\">\r\n                      <img\r\n                        src={designPreview}\r\n                        alt=\"Design preview\"\r\n                        className=\"w-full h-20 object-contain p-1.5\"\r\n                      />\r\n                      <button\r\n                        onClick={removeDesign}\r\n                        className=\"absolute top-2 right-2 bg-red-600/80 hover:bg-red-700 text-white p-1 rounded\"\r\n                      >\r\n                        <X className=\"w-4 h-4\" />\r\n                      </button>\r\n                    </div>\r\n                    <p className=\"text-gray-600 text-xs\">\r\n                      {designFile?.name} (\r\n                      {((designFile?.size || 0) / 1024 / 1024).toFixed(2)} MB)\r\n                    </p>\r\n                  </div>\r\n                ) : (\r\n                  <label className=\"flex flex-col items-center justify-center gap-1.5 border-2 border-dashed border-green-600 rounded p-2 cursor-pointer hover:border-green-700 transition bg-green-50\">\r\n                    <img\r\n                      src=\"https://cdn.builder.io/api/v1/image/assets%2F1e00ee8c48924560b1c928d354e4521b%2Fcee606b598864f7a983db9ee1358acf5?format=webp&width=800\"\r\n                      alt=\"Upload\"\r\n                      className=\"w-8 h-8\"\r\n                    />\r\n                    <div className=\"text-center\">\r\n                      <p className=\"text-black font-medium text-xs\">\r\n                        Drag or click to upload\r\n                      </p>\r\n                      <p className=\"text-gray-600 text-xs mt-0.5\">\r\n                        All formats supported. Max file size:{\" \"}\r\n                        {product.customer_upload_config.maxFileSize}MB | 1 file\r\n                        per order\r\n                      </p>\r\n                    </div>\r\n                    <input\r\n                      type=\"file\"\r\n                      accept={product.customer_upload_config.allowedFormats\r\n                        .map((f) => `.${f}`)\r\n                        .join(\",\")}\r\n                      onChange={handleDesignUpload}\r\n                      className=\"hidden\"\r\n                    />\r\n                  </label>\r\n                )}\r\n              </div>\r\n            )}\r\n\r\n            {/* Order Notes */}\r\n            <div className=\"backdrop-blur-xl bg-gray-50 border border-gray-200 rounded-lg p-3\">\r\n              <h2 className=\"text-xs font-bold mb-1.5\">\r\n                üìù Order Notes (optional)\r\n              </h2>\r\n              <Textarea\r\n                value={orderNotes}\r\n                onChange={(e) => setOrderNotes(e.target.value)}\r\n                placeholder=\"Add any special requests or notes...\"\r\n                className=\"bg-white border-gray-300 text-black placeholder-gray-500 min-h-10 text-xs\"\r\n              />\r\n              <p className=\"text-gray-600 text-xs mt-1\">\r\n                Let us know about any special requirements or customizations\r\n              </p>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Add to Cart Button & Checkout */}\r\n          <div className=\"space-y-2\">\r\n            <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-3\">\r\n              {/* Add to Cart Button */}\r\n              <div className=\"backdrop-blur-xl bg-gray-50 border border-gray-200 rounded-lg p-3\">\r\n                <Button\r\n                  onClick={handleAddToCart}\r\n                  disabled={isAddingToCart || !product.availability}\r\n                  className=\"w-full bg-white/60 hover:bg-[#FFD713] border border-gray-300 text-black hover:text-black py-1.5 text-xs font-semibold gap-2 rounded transition-all disabled:bg-gray-100 disabled:text-gray-400\"\r\n                >\r\n                  <Upload className=\"w-3 h-3\" />\r\n                  {isAddingToCart\r\n                    ? \"Adding...\"\r\n                    : !product.availability\r\n                      ? \"Out of Stock\"\r\n                      : \"Add to Cart\"}\r\n                </Button>\r\n              </div>\r\n\r\n              {/* Go to Checkout Button */}\r\n              <div className=\"backdrop-blur-xl bg-gray-50 border border-gray-200 rounded-lg p-3\">\r\n                <Button\r\n                  onClick={() => navigate(\"/checkout-new\")}\r\n                  className=\"w-full bg-white/60 hover:bg-[#FFD713] border border-gray-300 text-black hover:text-black py-1.5 text-xs font-semibold gap-2 rounded transition-all\"\r\n                >\r\n                  üõí Checkout\r\n                </Button>\r\n              </div>\r\n            </div>\r\n\r\n            <p className=\"text-center text-gray-600 text-xs\">\r\n              Continue adding products or proceed to checkout when ready\r\n            </p>\r\n          </div>\r\n        </div>\r\n      </main>\r\n    </>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}