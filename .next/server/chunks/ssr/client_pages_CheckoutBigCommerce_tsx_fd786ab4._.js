module.exports=[30421,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(65967),e=a.i(40695),f=a.i(5522),g=a.i(17171),h=a.i(3130),i=a.i(32860),j=a.i(96221),k=a.i(92e3),l=a.i(23292),m=a.i(87682),n=a.i(65602);let o=[{code:"US",name:"United States"},{code:"CA",name:"Canada"},{code:"GB",name:"United Kingdom"},{code:"AU",name:"Australia"}],p=["AL","AK","AZ","AR","CA","CO","CT","DE","FL","GA","HI","ID","IL","IN","IA","KS","KY","LA","ME","MD","MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH","OK","OR","PA","RI","SC","SD","TN","TX","UT","VT","VA","WA","WV","WI","WY"];function q(){let a=(0,d.useNavigate)(),[q,r]=(0,c.useState)(!0),[s,t]=(0,c.useState)(!1),[u,v]=(0,c.useState)(null),[w,x]=(0,c.useState)(null),[y,z]=(0,c.useState)(null),[A,B]=(0,c.useState)(""),[C,D]=(0,c.useState)({firstName:"",lastName:"",email:"",phone:"",street:"",street2:"",city:"",state:"CA",postalCode:"",country:"US"}),[E,F]=(0,c.useState)({same_as_shipping:!0,firstName:"",lastName:"",street:"",street2:"",city:"",state:"CA",postalCode:"",country:"US"});(0,c.useEffect)(()=>{v(localStorage.getItem("auth_token"));let a=sessionStorage.getItem("pending_checkout");if(!a){x("No checkout data found. Please add items to your cart."),r(!1);return}try{let b=JSON.parse(a);z(b)}catch(a){x("Invalid checkout data"),r(!1);return}r(!1)},[a]);let G=(a,b)=>{let c={...C,[a]:b};D(c),E.same_as_shipping&&F(a=>({...a,firstName:c.firstName,lastName:c.lastName,street:c.street,street2:c.street2,city:c.city,state:c.state,postalCode:c.postalCode,country:c.country}))},H=(a,b)=>{"same_as_shipping"===a?(F(a=>({...a,same_as_shipping:b})),b&&F(a=>({...a,firstName:C.firstName,lastName:C.lastName,street:C.street,street2:C.street2,city:C.city,state:C.state,postalCode:C.postalCode,country:C.country}))):F(c=>({...c,[a]:b}))},I=async a=>{if(a.preventDefault(),x(null),(C.firstName&&C.lastName&&C.email&&C.phone&&C.street&&C.city&&C.state&&C.postalCode?!!E.same_as_shipping||!!E.firstName&&!!E.lastName&&!!E.street&&!!E.city&&!!E.state&&!!E.postalCode||(x("Please fill in all required billing fields"),!1):(x("Please fill in all required shipping fields"),!1))&&y){t(!0);try{let a,b={customer_id:null,customer_email:C.email,products:[{product_id:y.product_id,quantity:y.quantity,price_inc_tax:0}],billing_address:{first_name:E.firstName,last_name:E.lastName,street_1:E.street,street_2:E.street2,city:E.city,state_or_province:E.state,postal_code:E.postalCode,country_code:E.country},shipping_addresses:[{first_name:C.firstName,last_name:C.lastName,street_1:C.street,street_2:C.street2,city:C.city,state_or_province:C.state,postal_code:C.postalCode,country_code:C.country}]};y.selectedOptions&&Object.keys(y.selectedOptions).length>0&&(b.product_options=y.selectedOptions);let c={"Content-Type":"application/json"};u&&(c.Authorization=`Bearer ${u}`);let d=await fetch("/api/bigcommerce/checkout",{method:"POST",headers:c,body:JSON.stringify(b)}),e="";try{e=await d.text(),console.log("Raw response text:",e),a=e?JSON.parse(e):{}}catch(a){throw console.error("Failed to parse checkout response:",{error:a,responseText:e||"[empty response]",status:d.status,statusText:d.statusText}),Error(`Server error (${d.status}): ${e||"[empty response]"}`)}if(!d.ok){let b=a?.error||a?.message||"Failed to create BigCommerce checkout";throw Error(b)}if(a.data?.checkout_url)l.toast.success("Redirecting to BigCommerce checkout..."),sessionStorage.removeItem("pending_checkout"),setTimeout(()=>{window.location.href=a.data.checkout_url},500);else throw Error("No checkout URL returned")}catch(b){let a=b instanceof Error?b.message:"Failed to proceed to checkout";x(a),l.toast.error(a),console.error("BigCommerce checkout error:",b)}finally{t(!1)}}};return q?(0,b.jsx)(b.Fragment,{children:(0,b.jsx)("main",{className:"pt-20 min-h-screen bg-gray-50 flex items-center justify-center",children:(0,b.jsx)(j.Loader2,{className:"w-8 h-8 animate-spin text-blue-600"})})}):w&&!1===q&&!y?(0,b.jsx)(b.Fragment,{children:(0,b.jsx)("main",{className:"pt-20 min-h-screen bg-gray-50 py-12",children:(0,b.jsxs)("div",{className:"max-w-2xl mx-auto px-4",children:[(0,b.jsxs)(n.Alert,{variant:"destructive",children:[(0,b.jsx)(k.AlertCircle,{className:"h-4 w-4"}),(0,b.jsx)(n.AlertDescription,{children:w})]}),(0,b.jsx)(e.Button,{onClick:()=>a("/products"),className:"mt-6 w-full",children:"Back to Shopping"})]})})}):(0,b.jsx)(b.Fragment,{children:(0,b.jsx)("main",{className:"pt-20 min-h-screen bg-gray-50 py-12",children:(0,b.jsxs)("div",{className:"max-w-4xl mx-auto px-4",children:[(0,b.jsxs)("div",{className:"mb-8",children:[(0,b.jsx)("h1",{className:"text-4xl font-bold text-gray-900 mb-2",children:"Shipping Information"}),(0,b.jsx)("p",{className:"text-gray-600",children:"Please enter your shipping details to proceed to BigCommerce checkout"})]}),w&&(0,b.jsxs)("div",{className:"mb-6 bg-red-50 border border-red-200 rounded-lg p-4 flex gap-3",children:[(0,b.jsx)(k.AlertCircle,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),(0,b.jsx)("p",{className:"text-sm text-red-800",children:w})]}),(0,b.jsx)("form",{onSubmit:I,children:(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,b.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,b.jsxs)(h.Card,{children:[(0,b.jsxs)(h.CardHeader,{children:[(0,b.jsx)(h.CardTitle,{children:"Shipping Address"}),(0,b.jsx)(h.CardDescription,{children:"Where should we deliver your order?"})]}),(0,b.jsxs)(h.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{htmlFor:"firstName",children:"First Name *"}),(0,b.jsx)(f.Input,{id:"firstName",placeholder:"John",value:C.firstName,onChange:a=>G("firstName",a.target.value),required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{htmlFor:"lastName",children:"Last Name *"}),(0,b.jsx)(f.Input,{id:"lastName",placeholder:"Doe",value:C.lastName,onChange:a=>G("lastName",a.target.value),required:!0})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{htmlFor:"email",children:"Email *"}),(0,b.jsx)(f.Input,{id:"email",type:"email",placeholder:"john@example.com",value:C.email,onChange:a=>G("email",a.target.value),required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{htmlFor:"phone",children:"Phone *"}),(0,b.jsx)(f.Input,{id:"phone",type:"tel",placeholder:"(555) 123-4567",value:C.phone,onChange:a=>G("phone",a.target.value),required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{htmlFor:"street",children:"Street Address *"}),(0,b.jsx)(f.Input,{id:"street",placeholder:"123 Main St",value:C.street,onChange:a=>G("street",a.target.value),required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{htmlFor:"street2",children:"Apt, Suite, etc. (Optional)"}),(0,b.jsx)(f.Input,{id:"street2",placeholder:"Apt 4B",value:C.street2,onChange:a=>G("street2",a.target.value)})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{htmlFor:"city",children:"City *"}),(0,b.jsx)(f.Input,{id:"city",placeholder:"New York",value:C.city,onChange:a=>G("city",a.target.value),required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{htmlFor:"state",children:"State *"}),"US"===C.country?(0,b.jsxs)(m.Select,{value:C.state,onValueChange:a=>G("state",a),children:[(0,b.jsx)(m.SelectTrigger,{children:(0,b.jsx)(m.SelectValue,{placeholder:"Select state"})}),(0,b.jsx)(m.SelectContent,{children:p.map(a=>(0,b.jsx)(m.SelectItem,{value:a,children:a},a))})]}):(0,b.jsx)(f.Input,{placeholder:"Province/State",value:C.state,onChange:a=>G("state",a.target.value)})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{htmlFor:"postalCode",children:"Postal Code *"}),(0,b.jsx)(f.Input,{id:"postalCode",placeholder:"10001",value:C.postalCode,onChange:a=>G("postalCode",a.target.value),required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{htmlFor:"country",children:"Country *"}),(0,b.jsxs)(m.Select,{value:C.country,onValueChange:a=>G("country",a),children:[(0,b.jsx)(m.SelectTrigger,{children:(0,b.jsx)(m.SelectValue,{placeholder:"Select country"})}),(0,b.jsx)(m.SelectContent,{children:o.map(a=>(0,b.jsx)(m.SelectItem,{value:a.code,children:a.name},a.code))})]})]})]})]})]}),(0,b.jsxs)(h.Card,{children:[(0,b.jsx)(h.CardHeader,{children:(0,b.jsx)(h.CardTitle,{children:"Billing Address"})}),(0,b.jsxs)(h.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,b.jsx)("input",{type:"checkbox",checked:E.same_as_shipping,onChange:a=>H("same_as_shipping",a.target.checked),className:"w-4 h-4"}),(0,b.jsx)("span",{className:"text-sm font-medium",children:"Same as shipping address"})]}),!E.same_as_shipping&&(0,b.jsxs)("div",{className:"space-y-4 mt-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{htmlFor:"billingFirstName",children:"First Name *"}),(0,b.jsx)(f.Input,{id:"billingFirstName",placeholder:"John",value:E.firstName,onChange:a=>H("firstName",a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{htmlFor:"billingLastName",children:"Last Name *"}),(0,b.jsx)(f.Input,{id:"billingLastName",placeholder:"Doe",value:E.lastName,onChange:a=>H("lastName",a.target.value)})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{htmlFor:"billingStreet",children:"Street Address *"}),(0,b.jsx)(f.Input,{id:"billingStreet",placeholder:"123 Main St",value:E.street,onChange:a=>H("street",a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{htmlFor:"billingStreet2",children:"Apt, Suite, etc. (Optional)"}),(0,b.jsx)(f.Input,{id:"billingStreet2",placeholder:"Apt 4B",value:E.street2,onChange:a=>H("street2",a.target.value)})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{htmlFor:"billingCity",children:"City *"}),(0,b.jsx)(f.Input,{id:"billingCity",placeholder:"New York",value:E.city,onChange:a=>H("city",a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{htmlFor:"billingState",children:"State *"}),(0,b.jsx)(f.Input,{id:"billingState",placeholder:"NY",value:E.state,onChange:a=>H("state",a.target.value)})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{htmlFor:"billingPostalCode",children:"Postal Code *"}),(0,b.jsx)(f.Input,{id:"billingPostalCode",placeholder:"10001",value:E.postalCode,onChange:a=>H("postalCode",a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{htmlFor:"billingCountry",children:"Country *"}),(0,b.jsxs)(m.Select,{value:E.country,onValueChange:a=>H("country",a),children:[(0,b.jsx)(m.SelectTrigger,{children:(0,b.jsx)(m.SelectValue,{placeholder:"Select country"})}),(0,b.jsx)(m.SelectContent,{children:o.map(a=>(0,b.jsx)(m.SelectItem,{value:a.code,children:a.name},a.code))})]})]})]})]})]})]})]}),(0,b.jsx)("div",{className:"lg:col-span-1",children:(0,b.jsxs)(h.Card,{className:"sticky top-24",children:[(0,b.jsx)(h.CardHeader,{children:(0,b.jsx)(h.CardTitle,{children:"Order Summary"})}),(0,b.jsx)(h.CardContent,{className:"space-y-4",children:y&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"space-y-2 border-b pb-4",children:[(0,b.jsx)("div",{className:"flex justify-between text-sm",children:(0,b.jsxs)("span",{children:["Product ID: ",y.product_id]})}),(0,b.jsx)("div",{className:"flex justify-between text-sm",children:(0,b.jsxs)("span",{children:["Quantity: ",y.quantity]})})]}),(0,b.jsx)("div",{className:"text-sm text-gray-600",children:(0,b.jsx)("p",{className:"mb-3",children:"You will complete payment and review order details on the BigCommerce checkout page."})}),(0,b.jsx)(e.Button,{type:"submit",className:"w-full bg-blue-600 hover:bg-blue-700 text-white py-6 text-lg font-bold",disabled:s,children:s?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(j.Loader2,{className:"w-5 h-5 mr-2 animate-spin"}),"Processing..."]}):(0,b.jsxs)(b.Fragment,{children:["Continue to BigCommerce",(0,b.jsx)(i.ArrowRight,{className:"w-5 h-5 ml-2"})]})}),(0,b.jsx)(e.Button,{type:"button",variant:"outline",className:"w-full border-gray-300 text-gray-700 hover:bg-gray-50",onClick:()=>a("/products"),disabled:s,children:"Cancel"})]})})]})})]})})]})})})}a.s(["default",()=>q])}];

//# sourceMappingURL=client_pages_CheckoutBigCommerce_tsx_fd786ab4._.js.map