module.exports=[38105,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(65967),e=a.i(57999),f=a.i(5522),g=a.i(17171),h=a.i(87682);let i=[{code:"US",name:"United States"},{code:"CA",name:"Canada"},{code:"GB",name:"United Kingdom"},{code:"AU",name:"Australia"}],j=["AL","AK","AZ","AR","CA","CO","CT","DE","FL","GA","HI","ID","IL","IN","IA","KS","KY","LA","ME","MD","MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH","OK","OR","PA","RI","SC","SD","TN","TX","UT","VT","VA","WA","WV","WI","WY"];function k({customerInfo:a,billingInfo:d,onCustomerChange:e,onBillingChange:k}){let[l,m]=(0,c.useState)([]),[n,o]=(0,c.useState)(!1),[p,q]=(0,c.useState)(null);return(0,c.useEffect)(()=>{(async()=>{let a=localStorage.getItem("authToken");if(a)try{o(!0);let b=await fetch("/api/customers/me/addresses",{headers:{Authorization:`Bearer ${a}`}});if(b.ok){let a=await b.json();if(m(a.addresses||[]),a.addresses&&a.addresses.length>0){let b=a.addresses[0];q(b.id),e("firstName",b.first_name),e("lastName",b.last_name),e("street",b.street_1),e("street2",b.street_2||""),e("city",b.city),e("state",b.state_or_province),e("postalCode",b.postal_code);let c=i.some(a=>a.code===b.country_code)?b.country_code:"US";e("country",c)}}}catch(a){console.error("Error loading saved addresses:",a)}finally{o(!1)}})()},[]),(0,b.jsxs)("div",{className:"space-y-6",children:[l.length>0&&(0,b.jsxs)("div",{className:"backdrop-blur-xl bg-white border border-gray-200 rounded-2xl p-6",children:[(0,b.jsx)("h3",{className:"text-xl font-bold mb-6",children:"Saved Addresses"}),(0,b.jsx)("div",{className:"space-y-2 mb-4",children:l.map(a=>(0,b.jsxs)("button",{onClick:()=>{var b;let c;return b=a.id,void(!(c=l.find(a=>a.id===b))||(q(b),e("firstName",c.first_name),e("lastName",c.last_name),e("street",c.street_1),e("street2",c.street_2||""),e("city",c.city),e("state",c.state_or_province),e("postalCode",c.postal_code),e("country",i.some(a=>a.code===c.country_code)?c.country_code:"US")))},className:`w-full text-left p-4 rounded-lg border-2 transition-colors ${p===a.id?"border-blue-600 bg-blue-50":"border-gray-200 hover:border-gray-300 bg-gray-50"}`,children:[(0,b.jsxs)("p",{className:"font-semibold text-gray-900",children:[a.first_name," ",a.last_name]}),(0,b.jsx)("p",{className:"text-gray-700 text-sm",children:a.street_1}),a.street_2&&(0,b.jsx)("p",{className:"text-gray-700 text-sm",children:a.street_2}),(0,b.jsxs)("p",{className:"text-gray-700 text-sm",children:[a.city,", ",a.state_or_province," ",a.postal_code]})]},a.id))}),(0,b.jsx)("p",{className:"text-gray-600 text-sm mb-6",children:"Or enter a different address below:"})]}),(0,b.jsxs)("div",{className:"backdrop-blur-xl bg-white border border-gray-200 rounded-2xl p-4 sm:p-6",children:[(0,b.jsx)("h3",{className:"text-lg sm:text-xl font-bold mb-4 sm:mb-6",children:"Shipping Address"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4 mb-3 sm:mb-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)(g.Label,{htmlFor:"shipping-first-name",className:"text-gray-700",children:["First Name ",(0,b.jsx)("span",{"aria-label":"required",children:"*"})]}),(0,b.jsx)(f.Input,{id:"shipping-first-name",value:a.firstName,onChange:a=>e("firstName",a.target.value),className:"bg-gray-50 border-gray-200 text-gray-900 placeholder-gray-400 mt-2",required:!0,"aria-required":"true"})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)(g.Label,{htmlFor:"shipping-last-name",className:"text-gray-700",children:["Last Name ",(0,b.jsx)("span",{"aria-label":"required",children:"*"})]}),(0,b.jsx)(f.Input,{id:"shipping-last-name",value:a.lastName,onChange:a=>e("lastName",a.target.value),className:"bg-gray-50 border-gray-200 text-gray-900 placeholder-gray-400 mt-2",required:!0,"aria-required":"true"})]})]}),(0,b.jsxs)("div",{className:"mb-3 sm:mb-4",children:[(0,b.jsxs)(g.Label,{htmlFor:"shipping-email",className:"text-sm sm:text-gray-700",children:["Email Address ",(0,b.jsx)("span",{"aria-label":"required",children:"*"})]}),(0,b.jsx)(f.Input,{id:"shipping-email",type:"email",value:a.email,onChange:a=>e("email",a.target.value),className:"bg-gray-50 border-gray-200 text-gray-900 placeholder-gray-400 mt-1 sm:mt-2",required:!0,"aria-required":"true"})]}),(0,b.jsxs)("div",{className:"mb-3 sm:mb-4",children:[(0,b.jsxs)(g.Label,{htmlFor:"shipping-phone",className:"text-sm sm:text-gray-700",children:["Phone Number ",(0,b.jsx)("span",{"aria-label":"required",children:"*"})]}),(0,b.jsx)(f.Input,{id:"shipping-phone",type:"tel",value:a.phone,onChange:a=>e("phone",a.target.value),className:"bg-gray-50 border-gray-200 text-gray-900 placeholder-gray-400 mt-1 sm:mt-2",required:!0,"aria-required":"true"})]}),(0,b.jsxs)("div",{className:"mb-3 sm:mb-4",children:[(0,b.jsxs)(g.Label,{htmlFor:"shipping-street",className:"text-sm sm:text-gray-700",children:["Street Address ",(0,b.jsx)("span",{"aria-label":"required",children:"*"})]}),(0,b.jsx)(f.Input,{id:"shipping-street",value:a.street,onChange:a=>e("street",a.target.value),placeholder:"123 Main St",className:"bg-gray-50 border-gray-200 text-gray-900 placeholder-gray-400 mt-1 sm:mt-2",required:!0,"aria-required":"true"})]}),(0,b.jsxs)("div",{className:"mb-3 sm:mb-4",children:[(0,b.jsx)(g.Label,{htmlFor:"shipping-street2",className:"text-sm sm:text-gray-700",children:"Apt, Suite, etc. (optional)"}),(0,b.jsx)(f.Input,{id:"shipping-street2",value:a.street2,onChange:a=>e("street2",a.target.value),placeholder:"Apt 4B",className:"bg-gray-50 border-gray-200 text-gray-900 placeholder-gray-400 mt-1 sm:mt-2"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4 mb-3 sm:mb-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{className:"text-sm sm:text-gray-700",children:"City *"}),(0,b.jsx)(f.Input,{value:a.city,onChange:a=>e("city",a.target.value),className:"bg-gray-50 border-gray-200 text-gray-900 placeholder-gray-400 mt-1 sm:mt-2",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{className:"text-sm sm:text-gray-700",children:"Postal Code *"}),(0,b.jsx)(f.Input,{value:a.postalCode,onChange:a=>e("postalCode",a.target.value),className:"bg-gray-50 border-gray-200 text-gray-900 placeholder-gray-400 mt-1 sm:mt-2",required:!0})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{className:"text-sm sm:text-gray-700",children:"Country *"}),(0,b.jsxs)(h.Select,{value:a.country,onValueChange:a=>e("country",a),children:[(0,b.jsx)(h.SelectTrigger,{className:"bg-gray-50 border-gray-200 text-gray-900 mt-1 sm:mt-2",children:(0,b.jsx)(h.SelectValue,{})}),(0,b.jsx)(h.SelectContent,{className:"bg-white border-gray-200",children:i.map(a=>(0,b.jsx)(h.SelectItem,{value:a.code,className:"text-gray-900 hover:bg-gray-100",children:a.name},a.code))})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{className:"text-sm sm:text-gray-700",children:"State/Province *"}),"US"===a.country?(0,b.jsxs)(h.Select,{value:a.state,onValueChange:a=>e("state",a),children:[(0,b.jsx)(h.SelectTrigger,{className:"bg-gray-50 border-gray-200 text-gray-900 mt-1 sm:mt-2",children:(0,b.jsx)(h.SelectValue,{})}),(0,b.jsx)(h.SelectContent,{className:"bg-white border-gray-200 max-h-60",children:j.map(a=>(0,b.jsx)(h.SelectItem,{value:a,className:"text-gray-900 hover:bg-gray-100",children:a},a))})]}):(0,b.jsx)(f.Input,{value:a.state,onChange:a=>e("state",a.target.value),placeholder:"State/Province",className:"bg-gray-50 border-gray-200 text-gray-900 placeholder-gray-400 mt-1 sm:mt-2",required:!0})]})]})]}),(0,b.jsxs)("div",{className:"backdrop-blur-xl bg-white border border-gray-200 rounded-2xl p-4 sm:p-6",children:[(0,b.jsx)("h3",{className:"text-lg sm:text-xl font-bold mb-4 sm:mb-6",children:"Billing Address"}),(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-4 sm:mb-6",children:[(0,b.jsx)("input",{type:"checkbox",id:"sameAsShipping",checked:d.sameAsShipping,onChange:a=>k("sameAsShipping",a.target.checked),className:"w-5 h-5 rounded bg-gray-50 border-gray-200"}),(0,b.jsx)(g.Label,{htmlFor:"sameAsShipping",className:"text-sm sm:text-gray-700 cursor-pointer font-normal",children:"Same as shipping address"})]}),!d.sameAsShipping&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4 mb-3 sm:mb-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{className:"text-sm sm:text-gray-700",children:"First Name *"}),(0,b.jsx)(f.Input,{value:d.firstName,onChange:a=>k("firstName",a.target.value),className:"bg-gray-50 border-gray-200 text-gray-900 placeholder-gray-400 mt-1 sm:mt-2",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{className:"text-sm sm:text-gray-700",children:"Last Name *"}),(0,b.jsx)(f.Input,{value:d.lastName,onChange:a=>k("lastName",a.target.value),className:"bg-gray-50 border-gray-200 text-gray-900 placeholder-gray-400 mt-1 sm:mt-2",required:!0})]})]}),(0,b.jsxs)("div",{className:"mb-3 sm:mb-4",children:[(0,b.jsx)(g.Label,{className:"text-sm sm:text-gray-700",children:"Street Address *"}),(0,b.jsx)(f.Input,{value:d.street,onChange:a=>k("street",a.target.value),placeholder:"123 Main St",className:"bg-gray-50 border-gray-200 text-gray-900 placeholder-gray-400 mt-1 sm:mt-2",required:!0})]}),(0,b.jsxs)("div",{className:"mb-3 sm:mb-4",children:[(0,b.jsx)(g.Label,{className:"text-sm sm:text-gray-700",children:"Apt, Suite, etc. (optional)"}),(0,b.jsx)(f.Input,{value:d.street2,onChange:a=>k("street2",a.target.value),placeholder:"Apt 4B",className:"bg-gray-50 border-gray-200 text-gray-900 placeholder-gray-400 mt-1 sm:mt-2"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4 mb-3 sm:mb-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{className:"text-sm sm:text-gray-700",children:"City *"}),(0,b.jsx)(f.Input,{value:d.city,onChange:a=>k("city",a.target.value),className:"bg-gray-50 border-gray-200 text-gray-900 placeholder-gray-400 mt-1 sm:mt-2",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{className:"text-sm sm:text-gray-700",children:"Postal Code *"}),(0,b.jsx)(f.Input,{value:d.postalCode,onChange:a=>k("postalCode",a.target.value),className:"bg-gray-50 border-gray-200 text-gray-900 placeholder-gray-400 mt-1 sm:mt-2",required:!0})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{className:"text-sm sm:text-gray-700",children:"Country *"}),(0,b.jsxs)(h.Select,{value:d.country,onValueChange:a=>k("country",a),children:[(0,b.jsx)(h.SelectTrigger,{className:"bg-gray-50 border-gray-200 text-gray-900 mt-1 sm:mt-2",children:(0,b.jsx)(h.SelectValue,{})}),(0,b.jsx)(h.SelectContent,{className:"bg-white border-gray-200",children:i.map(a=>(0,b.jsx)(h.SelectItem,{value:a.code,className:"text-gray-900 hover:bg-gray-100",children:a.name},a.code))})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{className:"text-sm sm:text-gray-700",children:"State/Province *"}),"US"===d.country?(0,b.jsxs)(h.Select,{value:d.state,onValueChange:a=>k("state",a),children:[(0,b.jsx)(h.SelectTrigger,{className:"bg-gray-50 border-gray-200 text-gray-900 mt-1 sm:mt-2",children:(0,b.jsx)(h.SelectValue,{})}),(0,b.jsx)(h.SelectContent,{className:"bg-white border-gray-200 max-h-60",children:j.map(a=>(0,b.jsx)(h.SelectItem,{value:a,className:"text-gray-900 hover:bg-gray-100",children:a},a))})]}):(0,b.jsx)(f.Input,{value:d.state,onChange:a=>k("state",a.target.value),placeholder:"State/Province",className:"bg-gray-50 border-gray-200 text-gray-900 placeholder-gray-400 mt-1 sm:mt-2",required:!0})]})]})]})]})]})}var l=a.i(10227),m=a.i(92e3),n=a.i(5784);function o({selectedOptionId:a,onSelectionChange:d}){let[e,f]=(0,c.useState)([]),[g,h]=(0,c.useState)(!0),[i,j]=(0,c.useState)(null),[k,o]=(0,c.useState)(null);(0,c.useEffect)(()=>{(async()=>{let b=null;for(let c=1;c<=3;c++)try{let e="/api/shipping-options";console.log(`Attempting to fetch shipping options (attempt ${c}/3) from:`,e);let g=new AbortController,i=setTimeout(()=>g.abort(),3e4);try{console.log("Starting fetch request for shipping options...");let b=await fetch(e,{method:"GET",headers:{"Content-Type":"application/json"},signal:g.signal}).catch(a=>{throw console.error("Network/CORS error details:",{message:a.message,type:a.constructor.name,stack:a.stack}),a});if(clearTimeout(i),console.log("Shipping options response status:",b.status),!b.ok){let a=(await b.json().catch(()=>({}))).error||`HTTP ${b.status}`;throw Error(`Failed to fetch shipping options: ${a}`)}let c=(await b.json()).data||[];if(console.log("Shipping options loaded successfully:",c.length),f(c),j(null),h(!1),c.length>0&&!a){let a=c[0],b=p(a);d(a.id,a.cost,b,a.name)}return}catch(a){if(clearTimeout(i),b=a instanceof Error&&"AbortError"===a.name?Error("Request timeout: Shipping options are taking too long to load"):a instanceof Error?a:Error(String(a)),console.warn(`Attempt ${c} failed:`,b.message),c<3){let a=Math.min(1e3*Math.pow(2,c-1),5e3);console.log(`Retrying in ${a}ms...`),await new Promise(b=>setTimeout(b,a))}throw b}}catch(a){if(b=a instanceof Error?a:Error(String(a)),3===c){console.error("All fetch attempts failed:",b);let c=b.message||"Failed to load shipping options";console.error("Full error details:",{error:a,message:c,type:b.constructor.name,stack:b.stack});let d=c;(c.includes("Failed to fetch")||c.includes("NetworkError"))&&(d="Network error: Unable to reach the server. Please check your connection and try again."),j(d),h(!1);break}}})()},[]);let p=a=>{let b=a.processing_time_days+a.estimated_delivery_days_max,c=new Date;return c.setDate(c.getDate()+b),c.toISOString().split("T")[0]},q=a=>{let b=p(a);d(a.id,a.cost,b,a.name)};return g?(0,b.jsxs)("div",{className:"backdrop-blur-xl bg-white border border-gray-200 rounded-lg p-4",children:[(0,b.jsxs)("h4",{className:"text-gray-900 font-bold mb-2 text-sm flex items-center gap-2",children:[(0,b.jsx)(l.Truck,{className:"w-4 h-4"}),"Shipping"]}),(0,b.jsxs)("div",{className:"flex items-center justify-center py-4",children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"}),(0,b.jsx)("span",{className:"ml-2 text-gray-600 text-xs",children:"Loading..."})]})]}):i?(0,b.jsxs)("div",{className:"backdrop-blur-xl bg-white border border-gray-200 rounded-lg p-4",children:[(0,b.jsxs)("h4",{className:"text-gray-900 font-bold mb-2 text-sm flex items-center gap-2",children:[(0,b.jsx)(l.Truck,{className:"w-4 h-4"}),"Shipping"]}),(0,b.jsxs)("div",{className:"flex items-start gap-2 bg-red-500/20 border border-red-500/50 rounded p-3",children:[(0,b.jsx)(m.AlertCircle,{className:"w-4 h-4 text-red-400 flex-shrink-0 mt-0.5"}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"text-red-400 text-xs font-medium mb-1",children:i}),(0,b.jsx)("p",{className:"text-red-400/70 text-xs",children:"Shipping costs will be calculated during checkout. You can continue without selecting an option."})]})]})]}):0===e.length?(0,b.jsxs)("div",{className:"backdrop-blur-xl bg-white border border-gray-200 rounded-lg p-4",children:[(0,b.jsxs)("h4",{className:"text-gray-900 font-bold mb-2 text-sm flex items-center gap-2",children:[(0,b.jsx)(l.Truck,{className:"w-4 h-4"}),"Shipping"]}),(0,b.jsx)("p",{className:"text-gray-600 text-xs",children:"No options available. Costs will be calculated at checkout."})]}):(0,b.jsxs)("div",{className:"backdrop-blur-xl bg-white border border-gray-200 rounded-lg p-4",children:[(0,b.jsxs)("h4",{className:"text-gray-900 font-bold mb-2 text-sm flex items-center gap-2",children:[(0,b.jsx)(l.Truck,{className:"w-4 h-4"}),"Shipping"]}),(0,b.jsx)("div",{className:"space-y-2",children:e.map(c=>{let d,e,f,g,{min:h,max:i}=(d=c.processing_time_days+c.estimated_delivery_days_min,e=c.processing_time_days+c.estimated_delivery_days_max,(f=new Date).setDate(f.getDate()+d),(g=new Date).setDate(g.getDate()+e),{min:f.toISOString().split("T")[0],max:g.toISOString().split("T")[0]}),j=new Date(h),l=new Date(i),m=j.toLocaleDateString("en-US",{month:"short",day:"numeric"}),p=l.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}),r=k===c.id,s=a===c.id;return(0,b.jsxs)("div",{className:"overflow-hidden rounded-lg border border-gray-200",children:[(0,b.jsxs)("button",{onClick:()=>{o(r?null:c.id),s||q(c)},className:`w-full flex items-center gap-2 p-3 transition-all text-sm ${s?"bg-blue-50 border-blue-600/50":"bg-white/5 hover:bg-gray-50"}`,children:[(0,b.jsx)("input",{type:"radio",name:"shipping-option",value:c.id,checked:s,onChange:()=>q(c),className:"w-4 h-4 cursor-pointer flex-shrink-0"}),(0,b.jsxs)("div",{className:"flex-1 text-left min-w-0",children:[(0,b.jsxs)("div",{className:"flex items-baseline justify-between gap-2",children:[(0,b.jsx)("p",{className:"text-gray-900 font-semibold truncate",children:c.name}),(0,b.jsxs)("span",{className:"text-gray-900 font-bold flex-shrink-0 whitespace-nowrap",children:["$",c.cost.toFixed(2)]})]}),(0,b.jsxs)("p",{className:"text-xs text-gray-600 line-clamp-1",children:[c.processing_time_days,"d +"," ",c.estimated_delivery_days_min,"-",c.estimated_delivery_days_max,"d = ",m," ","to ",p]})]}),(0,b.jsx)(n.ChevronDown,{className:`w-4 h-4 text-gray-900/40 flex-shrink-0 transition-transform ${r?"rotate-180":""}`})]}),r&&(0,b.jsxs)("div",{className:"border-t border-gray-200 bg-white/5 p-3 space-y-3 text-xs text-gray-900/70",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("h5",{className:"font-semibold text-gray-900 text-sm",children:"Timing Breakdown"}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{children:"Processing"}),(0,b.jsxs)("span",{className:"text-gray-900 font-medium",children:[c.processing_time_days," day",1!==c.processing_time_days?"s":""]})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{children:"Shipping"}),(0,b.jsxs)("span",{className:"text-gray-900 font-medium",children:[c.estimated_delivery_days_min,"-",c.estimated_delivery_days_max," days"]})]}),(0,b.jsxs)("div",{className:"border-t border-gray-200 pt-1 flex justify-between",children:[(0,b.jsx)("span",{children:"Total"}),(0,b.jsxs)("span",{className:"text-gray-900 font-medium",children:[c.processing_time_days+c.estimated_delivery_days_min,"-",c.processing_time_days+c.estimated_delivery_days_max," ","days"]})]})]})]}),(0,b.jsxs)("div",{className:"space-y-1 border-t border-gray-200 pt-2",children:[(0,b.jsx)("h5",{className:"font-semibold text-gray-900 text-sm",children:"Estimated Delivery"}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{children:"Earliest"}),(0,b.jsx)("span",{className:"text-green-400 font-medium",children:m})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{children:"Latest"}),(0,b.jsx)("span",{className:"text-green-400 font-medium",children:p})]})]}),c.description&&(0,b.jsxs)("div",{className:"border-t border-gray-200 pt-2",children:[(0,b.jsx)("h5",{className:"font-semibold text-gray-900 text-sm mb-1",children:"Details"}),(0,b.jsx)("p",{className:"text-gray-600",children:c.description})]})]})]},c.id)})})]})}let p={get url(){return`file://${a.P("components/SquarePaymentForm.tsx")}`}};function q({amount:a,orderId:d,customerEmail:e,customerName:f,onPaymentSuccess:g,isLoading:h=!1,applicationId:i}){let j=(0,c.useRef)(!1);return(0,c.useEffect)(()=>{j.current||(async()=>{try{let b=0;for(;!window.Square&&b<100;)await new Promise(a=>setTimeout(a,100)),b++;if(!window.Square){console.error("Square SDK not loaded after timeout - check CSP headers and network");let a=document.getElementById("payment-status-container");a&&(a.innerHTML='<div class="text-red-600">Square SDK failed to load. Check browser console for details.</div>');return}console.log("Square SDK loaded successfully after",b,"attempts"),j.current=!0;let c=p.env.VITE_SQUARE_APP_ID,h=p.env.VITE_SQUARE_LOCATION_ID;if(!c||!h){console.error("Square credentials not configured");let a=document.getElementById("payment-status-container");a&&(a.innerHTML='<div class="text-red-600">Payment system not configured. Please contact support.</div>');return}let i=window.Square.payments(c,h);console.log("Square payments object created with appId:",c);let k=await i.card();if(console.log("Card object created"),!document.getElementById("card-container"))throw Error("Card container element (#card-container) not found in DOM");await k.attach("#card-container"),console.log("Card attached to container successfully");let l=document.getElementById("card-button");l&&l.addEventListener("click",async()=>{let b=document.getElementById("payment-status-container");try{b&&(b.innerHTML='<div class="text-gray-900">Processing payment...</div>');let c=await k.tokenize();if("OK"===c.status){let h;console.log(`Payment token is ${c.token}`),b&&(b.innerHTML='<div class="text-gray-900">Sending payment to Square...</div>');let i=await fetch("/api/square/create-payment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sourceId:c.token,amount:a,currency:"USD",orderId:d,customerEmail:e,customerId:f})});console.log("Payment response status:",i.status);try{h=await i.json()}catch(a){throw console.error("Error parsing payment response:",a),Error("Failed to parse payment response from server")}if(console.log("Payment response data:",h),i.ok&&h.success)console.log("Payment created successfully:",h.payment),b&&(b.innerHTML=`
                      <div class="bg-green-50 border border-green-200 rounded-lg p-3 space-y-2">
                        <div class="text-green-700 font-bold">âœ“ Payment completed successfully!</div>
                        <div class="text-sm text-green-600">Payment ID: ${h.payment.id}</div>
                        <div class="text-sm text-green-600">Amount: $${h.payment.amount.toFixed(2)}</div>
                      </div>
                    `),setTimeout(()=>{g(c.token)},2e3);else{let a=`Payment creation failed: ${h.error||"Unknown error"}`;throw h.details&&(a+=` - ${h.details}`),Error(a)}}else{let a=`Tokenization failed with status: ${c.status}`;throw c.errors&&(a+=` - ${JSON.stringify(c.errors)}`),Error(a)}}catch(a){if(console.error("Payment error:",a),b){let c=a instanceof Error?a.message:"Payment failed";b.innerHTML=`
                  <div class="bg-red-50 border border-red-200 rounded-lg p-3">
                    <div class="text-red-700 font-bold">âœ— Payment Failed</div>
                    <div class="text-sm text-red-600 mt-1">${c}</div>
                  </div>
                `}}})}catch(a){console.error("Failed to initialize Square payments:",a)}})()},[a,d,e,f,g]),(0,b.jsx)("div",{id:"payment-form",className:"space-y-4",children:(0,b.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsx)("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:"Payment Details"}),(0,b.jsxs)("p",{className:"text-gray-600 text-sm",children:["Amount: $",a.toFixed(2)]})]}),(0,b.jsx)("div",{id:"payment-status-container",className:"mb-4 text-sm font-medium text-gray-900"}),(0,b.jsx)("div",{id:"card-container",className:"mb-6 p-4 bg-gray-50 rounded-lg border border-gray-200 min-h-14"}),(0,b.jsxs)("button",{id:"card-button",type:"button",disabled:h,className:"w-full bg-green-500 hover:bg-green-600 text-white font-bold py-3 rounded-lg transition-all disabled:opacity-50",children:["Pay $",a.toFixed(2)]}),(0,b.jsx)("p",{className:"text-xs text-gray-500 text-center mt-4",children:"Secure payment powered by Square"})]})})}var r=a.i(40695),s=a.i(96221),t=a.i(81560),u=a.i(53569),v=a.i(23292),w=a.i(42542),x=a.i(48195);function y(){let a=(0,d.useNavigate)(),[g]=(0,e.useSearchParams)(),h=g.get("cartId"),[i,j]=(0,c.useState)([]),[l,p]=(0,c.useState)(!0),[y,z]=(0,c.useState)(!1),[A,B]=(0,c.useState)(!1),[C,D]=(0,c.useState)(!1),[E,F]=(0,c.useState)(0),[G,H]=(0,c.useState)(""),[I,J]=(0,c.useState)(0),[K,L]=(0,c.useState)(0),{storeCredit:M,fetchStoreCredit:N}=(0,w.useStoreCredit)(),[O,P]=(0,c.useState)(null),[Q,R]=(0,c.useState)(0),[S,T]=(0,c.useState)(null),[U,V]=(0,c.useState)(""),[W,X]=(0,c.useState)({subtotal:0,tax:0,shipping:0,discount:0,blindShipmentFee:0,additionalPayment:0,total:0,storeCredit:0,appliedStoreCredit:0}),[Y,Z]=(0,c.useState)({email:"",firstName:"",lastName:"",phone:"",street:"",street2:"",city:"",state:"CA",postalCode:"",country:"US"}),[$,_]=(0,c.useState)({sameAsShipping:!0,firstName:"",lastName:"",street:"",street2:"",city:"",state:"CA",postalCode:"",country:"US"}),[aa,ab]=(0,c.useState)(!1),[ac,ad]=(0,c.useState)(null),[ae,af]=(0,c.useState)(!1),[ag,ah]=(0,c.useState)(!1),[ai,aj]=(0,c.useState)(null),[ak,al]=(0,c.useState)(!1),[am,an]=(0,c.useState)(!0),[ao,ap]=(0,c.useState)(!0),[aq,ar]=(0,c.useState)(!1),[as,at]=(0,c.useState)(!1);(0,c.useEffect)(()=>{let a=async()=>{try{let a,b=h||localStorage.getItem("cart_id"),c=localStorage.getItem("cart");if(c){let a=JSON.parse(c),b=[];for(let c of a)try{let a=`/api/public/products/${c.productId}`;if(c.productId.startsWith("admin_")){let b=c.productId.split("_")[1];a=`/api/public/products/admin/${b}`}else if(c.productId.startsWith("imported_")){let b=c.productId.split("_")[1];a=`/api/public/products/imported/${b}`}let d=await fetch(a);if(!d.ok){console.warn(`Failed to fetch product ${c.productId}: HTTP ${d.status}`);continue}let e=await d.json(),f=e.product||e;b.push({product_id:c.productId,product_name:f.name,quantity:c.quantity,price:c.pricePerUnit||f.base_price||0,image:f.images?.[0]?.url,basePrice:c.basePrice,savePercentage:c.savePercentage,design_file_url:c.design_file_url,selectedOptions:c.selectedOptions,options:f.options})}catch(a){console.warn(`Failed to load product ${c.productId}:`,a instanceof Error?a.message:a)}j(b);let d=b.reduce((a,b)=>a+(b.price||0)*b.quantity,0);au(d,0),p(!1);return}if(!b){console.log("No cart ID found, skipping cart load"),p(!1);return}console.log("Loading cart with ID:",b);try{a=await fetch(`/api/cart/${b}`)}catch(a){console.warn("Network error loading cart:",a),p(!1);return}if(!a.ok){console.error("Failed to load cart - HTTP error:",{status:a.status,statusText:a.statusText});try{let b=await a.json();console.error("Error response data:",b)}catch(a){console.error("Could not parse error response")}if(404===a.status){console.warn("Cart not found, continuing with empty cart"),p(!1);return}throw Error(`Failed to load cart: ${a.status} ${a.statusText}`)}try{let b=await a.json(),c=b.data?.line_items||[];console.log("Cart loaded successfully:",{itemCount:c.length,subtotal:b.data?.subtotal});let d=[];for(let a of c)try{let b=await fetch(`/api/public/products/${a.product_id}`);if(b.ok){let c=(await b.json()).product;d.push({...a,options:c.options})}else d.push(a)}catch(b){console.warn(`Failed to fetch product ${a.product_id}:`,b instanceof Error?b.message:b),d.push(a)}j(d);let e=d.reduce((a,b)=>a+(b.price||.25)*b.quantity,0);au(e,0)}catch(a){throw console.error("Error parsing cart response:",a),Error("Failed to parse cart response")}}catch(b){let a=b instanceof Error?b.message:String(b);console.error("Failed to load cart:",{message:a,error:b}),v.toast.error(`Cart loading error: ${a}`)}finally{p(!1)}};(async()=>{try{let a=localStorage.getItem("authToken");if(!a)return;let b=await fetch("/api/customers/me",{headers:{Authorization:`Bearer ${a}`}});if(b.ok){let a=await b.json();if(a.customer){let b=a.customer,c=b.addresses?.[0];console.log("Loaded customer info:",{email:b.email,firstName:b.firstName,lastName:b.lastName,phone:b.phone,addresses:b.addresses?.length||0});let d=c?.country_code||"US",e=["US","CA","GB","AU"].includes(d)?d:"US";Z({email:b.email||"",firstName:b.firstName||"",lastName:b.lastName||"",phone:b.phone||"",street:c?.street_1||"",street2:c?.street_2||"",city:c?.city||"",state:c?.state_or_province||"CA",postalCode:c?.postal_code||"",country:e})}}else console.warn("Failed to load customer info, status:",b.status)}catch(a){console.warn("Failed to load customer info:",a)}})(),a(),N();let b=()=>{document.hidden||N()};return document.addEventListener("visibilitychange",b),()=>{document.removeEventListener("visibilitychange",b)}},[h,N]),(0,c.useEffect)(()=>{(async()=>{try{let a=await fetch("/api/return-refund-policy");if(a.ok){let b=await a.json();aj(b.policy)}}catch(a){console.error("Failed to fetch policy:",a)}})()},[]);let au=(a,b,c=K,d=Q)=>{let e=5*!!C,f=E/100*(a+0+d+e-b),g=Math.max(0,a+0+d+e+f-b-c);X({subtotal:a,tax:0,shipping:d,discount:b,blindShipmentFee:e,additionalPayment:f,total:g,storeCredit:.05*g,appliedStoreCredit:c})},av=async()=>{if(!G)return void v.toast.error("Please enter a discount code");try{let a=await fetch("/api/discounts/validate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:G,orderTotal:W.subtotal})}),b=await a.json();if(!a.ok)return void v.toast.error(b.error||"Invalid discount code");if(b.success&&b.discount){let a=b.discount.amount;J(a),au(W.subtotal,a,K),v.toast.success(`Discount applied! You save $${a.toFixed(2)}`)}}catch(a){console.error("Error applying discount code:",a),v.toast.error("Failed to apply discount code")}},aw=async a=>{if(a.preventDefault(),Y.firstName&&Y.lastName&&Y.email&&Y.phone&&Y.street&&Y.city&&Y.state&&Y.postalCode&&Y.country?$.sameAsShipping||$.firstName&&$.lastName&&$.street&&$.city&&$.state&&$.postalCode&&$.country?0===i.length?(v.toast.error("Your cart is empty"),!1):ae?ak?aq?!!as||(v.toast.error("Please agree to the Shipping Policy to proceed"),!1):(v.toast.error("Please agree to the Terms of Service to proceed"),!1):(v.toast.error("Please agree to the Privacy Policy to proceed"),!1):(v.toast.error("Please agree to the Return & Refund Policy to proceed"),!1):(v.toast.error("Please fill in all required billing fields"),!1):(v.toast.error("Please fill in all required shipping fields"),!1)){z(!0);try{let a,b,c=localStorage.getItem("customerId"),d={amount:W.total,currency:"USD",items:i.map(a=>({product_id:a.product_id,product_name:a.product_name,quantity:a.quantity,price:a.price,design_file_url:a.design_file_url,options:a.selectedOptions&&Object.keys(a.selectedOptions).length>0?Object.entries(a.selectedOptions).map(([b,c])=>{let d=a.options?.find(a=>a.id===b),e=d?.values?.find(a=>a.id===c),f=e?.name||c,g=e?.priceModifier||0;return{option_id:b,option_name:d?.name,option_value:f,modifier_price:g}}):a.product_options&&a.product_options.length>0?a.product_options.map(b=>{let c;if("string"==typeof b)return{option_id:"custom",option_value:b,modifier_price:0};let d=b.modifier_price||0;if(!d&&a.options&&b.option_id){let c=a.options.find(a=>a.id===b.option_id);if(c&&c.values){let a=c.values.find(a=>a.id===b.option_value||a.name===b.option_value);d=a?.priceModifier||0}}return{option_id:b.option_id||"custom",option_name:(c=a.options?.find(a=>a.id===b.option_id),c?.name||void 0),option_value:b.option_value||"",modifier_price:d}}):[]})),phone:Y.phone,shippingAddress:{firstName:Y.firstName,lastName:Y.lastName,street:Y.street,street2:Y.street2,city:Y.city,state:Y.state,postalCode:Y.postalCode,country:Y.country},billingAddress:$.sameAsShipping?{firstName:Y.firstName,lastName:Y.lastName,street:Y.street,street2:Y.street2,city:Y.city,state:Y.state,postalCode:Y.postalCode,country:Y.country}:{firstName:$.firstName,lastName:$.lastName,street:$.street,street2:$.street2,city:$.city,state:$.state,postalCode:$.postalCode,country:$.country},subtotal:W.subtotal,tax:W.tax,shipping:W.shipping,discount:I,discountCode:G||void 0,total:W.total,appliedStoreCredit:K,customerId:c?parseInt(c):void 0,customerEmail:Y.email,customerName:`${Y.firstName} ${Y.lastName}`,...O&&{shipping_option_id:O},shipping_option_name:U,estimated_delivery_date:S,policies:{returnAndRefund:ae,privacy:ak,gdpr:am,ccpa:ao,terms:aq,shipping:as}};console.log("Checkout payload being sent:",{amount:d.amount,items:d.items?.length,customerEmail:d.customerEmail,total:d.total,payloadSize:JSON.stringify(d).length});let e=new AbortController,f=setTimeout(()=>e.abort(),3e4);try{a=await fetch("/api/square/checkout",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d),signal:e.signal}),clearTimeout(f),console.log("Checkout response status:",a.status);try{b=await a.json()}catch(b){throw console.error("Failed to parse checkout response:",b),Error(`Server error (${a.status}): Could not parse response`)}if(console.log("Checkout response data:",b),!a.ok){let c=b?.error||b?.message||`HTTP ${a.status}: Checkout failed`;throw Error(c)}}catch(a){if(clearTimeout(f),a instanceof Error&&"AbortError"===a.name)throw Error("Request timeout: Checkout is taking too long. Please try again.");if(a instanceof TypeError)throw console.error("Network error details:",{message:a.message,stack:a.stack}),Error(`Network error: ${a.message}. Please check your connection and try again.`);throw a}if(b.order?.id)ad(b.order.id),b.checkoutUrl?(v.toast.success("Order created! Redirecting to payment..."),setTimeout(()=>{window.location.href=b.checkoutUrl},1e3)):(ab(!0),v.toast.success("Order created! Please complete payment below."));else throw Error("No order ID returned from checkout")}catch(b){let a=b instanceof Error?b.message:"Checkout failed";v.toast.error(a)}finally{z(!1)}}};return l?(0,b.jsx)(b.Fragment,{children:(0,b.jsx)("main",{className:"pt-20 min-h-screen bg-[#fafafa] flex items-center justify-center",children:(0,b.jsx)(s.Loader2,{className:"w-8 h-8 animate-spin text-blue-600"})})}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("a",{href:"#checkout-form",className:"sr-only focus:not-sr-only focus:absolute focus:top-0 focus:left-0 focus:z-50 bg-blue-600 text-white px-4 py-2",children:"Skip to checkout form"}),(0,b.jsx)("main",{className:"pt-20 min-h-screen bg-[#fafafa] text-gray-900 px-4 sm:px-6 md:px-10 py-6 sm:py-8 md:py-12",id:"checkout-main",role:"main","aria-label":"Checkout page",children:(0,b.jsxs)("div",{className:"max-w-7xl mx-auto pt-[15px]",children:[(0,b.jsx)("h1",{className:"text-2xl sm:text-3xl md:text-4xl font-bold mb-4 sm:mb-6 md:mb-8",children:"Your Cart"}),(0,b.jsx)("form",{onSubmit:aw,children:(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,b.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[i.map((a,c)=>{let d,e,f,g;return(0,b.jsx)("div",{className:"backdrop-blur-xl bg-white border border-gray-200 rounded-2xl p-4 sm:p-6",children:(0,b.jsxs)("div",{className:"flex gap-3 sm:gap-6 flex-col sm:flex-row",children:[(0,b.jsxs)("div",{className:"flex flex-col gap-3 sm:gap-4 flex-shrink-0",children:[(0,b.jsx)("div",{className:"w-24 h-24 sm:w-40 md:w-48 sm:h-40 md:h-48 bg-gradient-to-br from-gray-100 to-gray-200 rounded-xl flex items-center justify-center",children:a.image?(0,b.jsx)("img",{src:a.image,alt:a.product_name,className:"w-full h-full object-cover rounded-xl"}):(0,b.jsx)("div",{className:"text-gray-500 text-center",children:(0,b.jsx)("p",{className:"text-sm",children:"No image"})})}),a.design_file_url&&(0,b.jsx)("div",{className:"w-24 sm:w-40 md:w-48 bg-white border border-gray-200 rounded-xl flex items-center justify-center p-2",children:a.design_file_url.match(/\.(jpg|jpeg|png|gif|webp)$/i)||a.design_file_url.startsWith("data:image")?(0,b.jsx)("img",{src:a.design_file_url,alt:"Design thumbnail",className:"w-full h-auto object-contain rounded-lg"}):(0,b.jsx)("div",{className:"p-4 text-center",children:(0,b.jsx)("p",{className:"text-xs text-gray-600",children:"Design file uploaded"})})})]}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex justify-between items-start mb-3 sm:mb-4 gap-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-lg sm:text-xl font-bold",children:a.product_name||`Product #${a.product_id}`}),(0,b.jsx)("div",{className:"text-sm space-y-1",children:a.savePercentage&&a.savePercentage>0?(0,b.jsx)(b.Fragment,{children:(e=(d=a.basePrice||a.price/(1-a.savePercentage/100))*a.quantity,f=d*a.savePercentage/100*a.quantity,g=(a.price||.25)*a.quantity,(0,b.jsxs)(b.Fragment,{children:[d>0&&(0,b.jsxs)("p",{className:"text-gray-600",children:["Regular: $",e.toFixed(2)]}),(0,b.jsxs)("p",{className:"text-gray-600",children:["Quantity: ",a.quantity]}),(0,b.jsxs)("p",{className:"text-green-600 font-semibold",children:["Save ",a.savePercentage,"%"]}),(0,b.jsxs)("p",{className:"text-green-600",children:["Amount Saved: $",f.toFixed(2)]}),(0,b.jsxs)("p",{className:"text-gray-900 font-bold border-t border-gray-200 pt-1",children:["Total: $",g.toFixed(2)]})]}))}):(0,b.jsxs)("p",{className:"text-gray-600",children:["$",((a.price||.25)*a.quantity).toFixed(2)]})})]}),(0,b.jsx)("button",{type:"button",onClick:()=>(a=>{let b=i.filter((b,c)=>c!==a);j(b);let c=localStorage.getItem("cart");if(c){let b=JSON.parse(c),d=b.filter((b,c)=>c!==a);localStorage.setItem("cart",JSON.stringify(d));let e=d.reduce((a,b)=>a+b.quantity,0);window.dispatchEvent(new StorageEvent("storage",{key:"cart",newValue:JSON.stringify(d),oldValue:JSON.stringify(b),storageArea:localStorage})),v.toast.success(0===e?"Item removed from cart":1===e?"1 item removed - 1 item remaining":`Item removed - ${e} items remaining in cart`)}else v.toast.success("Item removed from cart");au(b.reduce((a,b)=>a+(b.price||.25)*b.quantity,0),I,K)})(c),className:"text-red-500 hover:text-red-400 transition",children:(0,b.jsx)(t.Trash2,{className:"w-5 h-5"})})]}),(0,b.jsxs)("div",{className:"space-y-3 bg-gray-50 rounded-lg p-4 mb-4",children:[(0,b.jsx)("h4",{className:"text-blue-600 text-sm font-bold uppercase tracking-wider",children:"Product Specifications"}),(0,b.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"text-gray-600",children:"Price per sticker"}),(0,b.jsxs)("span",{className:"font-medium",children:["$",(a.price||.25).toFixed(2)]})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"text-gray-600",children:"Quantity"}),(0,b.jsx)("span",{className:"font-medium",children:a.quantity})]}),a.selectedOptions&&Object.keys(a.selectedOptions).length>0&&(0,b.jsx)(b.Fragment,{children:Object.entries(a.selectedOptions).map(([c,d])=>{let e=a.options?.find(a=>a.id===c),f=e?.values?.find(a=>a.id===d),g=f?.name||d;return(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"text-gray-600",children:e?.name||"Option"}),(0,b.jsx)("span",{className:"font-medium",children:g})]},c)})}),!a.selectedOptions&&a.product_options&&a.product_options.length>0&&(0,b.jsx)(b.Fragment,{children:a.product_options.map((c,d)=>{let e="string"==typeof c?c:c.option_value||"",f="string"!=typeof c&&c.option_id&&a.options?a.options.find(a=>a.id===c.option_id)?.name:null;return(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"text-gray-600",children:f||"Option"}),(0,b.jsx)("span",{className:"font-medium",children:e})]},d)})})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-blue-600 text-sm font-bold uppercase tracking-wider",children:"Additional Notes"}),(0,b.jsx)("textarea",{placeholder:"Any special instructions or requests...",rows:3,className:"w-full bg-white border border-gray-200 rounded-lg px-4 py-2 text-gray-900 placeholder-gray-400 text-sm"})]})]})]})},c)}),(0,b.jsx)("div",{className:"backdrop-blur-xl bg-white border border-gray-200 rounded-2xl p-6",children:(0,b.jsxs)("fieldset",{children:[(0,b.jsx)("legend",{className:"sr-only",children:"Discount Code Section"}),I>0?(0,b.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:(0,b.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Discount Applied"}),(0,b.jsxs)("p",{className:"text-xl font-bold text-green-600",children:["-$",I.toFixed(2)]}),(0,b.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Code:"," ",(0,b.jsx)("code",{className:"font-mono",children:G})]})]}),(0,b.jsx)(r.Button,{type:"button",onClick:()=>{H(""),J(0),au(W.subtotal,0,K),v.toast.info("Discount code removed")},variant:"outline",className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:"Remove"})]})}):(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)("div",{className:"flex-1 relative",children:[(0,b.jsx)("label",{htmlFor:"discount-code",className:"sr-only",children:"Discount code"}),(0,b.jsx)(f.Input,{id:"discount-code",placeholder:"Discount code",value:G,onChange:a=>H(a.target.value),onKeyDown:a=>{"Enter"===a.key&&av()},className:"bg-gray-50 border-gray-200 text-gray-900 placeholder-gray-400","aria-label":"Discount code","aria-describedby":"discount-help"}),(0,b.jsx)("span",{id:"discount-help",className:"sr-only",children:"Enter your discount code to apply savings to your order"})]}),(0,b.jsx)(r.Button,{type:"button",onClick:av,disabled:!G,className:"bg-green-500 hover:bg-green-600 text-white px-6","aria-label":"Apply discount code",children:"Apply"})]})]})}),(0,b.jsx)(k,{customerInfo:Y,billingInfo:$,onCustomerChange:(a,b)=>{Z(c=>({...c,[a]:b}))},onBillingChange:(a,b)=>{"sameAsShipping"===a?(_(a=>({...a,sameAsShipping:b})),b&&_(a=>({...a,firstName:Y.firstName,lastName:Y.lastName,street:Y.street,street2:Y.street2,city:Y.city,state:Y.state,postalCode:Y.postalCode,country:Y.country}))):_(c=>({...c,[a]:b}))}}),(0,b.jsxs)("div",{className:"backdrop-blur-xl bg-white border border-gray-200 rounded-2xl p-6",children:[(0,b.jsxs)("button",{type:"button",onClick:()=>ah(!ag),className:"w-full flex items-center justify-between mb-4 hover:opacity-80 transition",children:[(0,b.jsx)("h4",{className:"text-gray-900 font-bold text-lg",children:"Return & Refund Policy"}),(0,b.jsx)(n.ChevronDown,{className:`w-5 h-5 text-gray-600 transition-transform ${ag?"rotate-180":""}`})]}),ag&&(0,b.jsx)("div",{className:"mb-4 pb-4 border-b border-gray-200",children:(0,b.jsx)("div",{className:"bg-gray-50 rounded-lg p-4 mb-4 max-h-80 overflow-y-auto text-sm space-y-3",children:ai?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("p",{className:"font-semibold text-gray-900 mb-2",children:[ai.guarantee_days,"-Day Money-Back Guarantee"]}),(0,b.jsxs)("p",{className:"text-gray-600",children:["We offer a ",ai.guarantee_days,"-day money-back guarantee on all orders. If you're not satisfied with your custom stickers for any reason, you can request a full refund within"," ",ai.guarantee_days," days of your purchase."]})]}),ai.return_conditions&&ai.return_conditions.length>0&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-semibold text-gray-900 mb-2",children:"Return Conditions"}),(0,b.jsx)("ul",{className:"text-gray-600 space-y-1",children:ai.return_conditions.map((a,c)=>(0,b.jsxs)("li",{children:["â€¢ ",a]},c))})]}),ai.how_to_return&&ai.how_to_return.length>0&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-semibold text-gray-900 mb-2",children:"How to Return"}),(0,b.jsx)("ol",{className:"text-gray-600 space-y-1",children:ai.how_to_return.map((a,c)=>(0,b.jsxs)("li",{children:[c+1,". ",a]},c))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-semibold text-gray-900 mb-2",children:"Defective or Damaged Items"}),(0,b.jsxs)("p",{className:"text-gray-600",children:["If your stickers arrive damaged or defective, we'll replace them at no cost to you within"," ",ai.defective_items_days," days of delivery."]})]}),ai.non_returnable_items&&ai.non_returnable_items.length>0&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-semibold text-gray-900 mb-2",children:"Non-Returnable Items"}),(0,b.jsx)("ul",{className:"text-gray-600 space-y-1",children:ai.non_returnable_items.map((a,c)=>(0,b.jsxs)("li",{children:["â€¢ ",a]},c))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-semibold text-gray-900 mb-2",children:"Refund Timeline"}),(0,b.jsx)("p",{className:"text-gray-600",children:ai.refund_timeline})]}),(0,b.jsx)("div",{className:"flex items-center gap-2 pt-2 border-t border-gray-200",children:(0,b.jsx)("a",{href:"/return-refund-policy",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 font-medium text-sm",children:"Read Full Policy â†’"})})]}):(0,b.jsx)("p",{className:"text-gray-500 text-sm",children:"Loading policy..."})})}),(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("input",{type:"checkbox",id:"agreeToPolicy",checked:ae,onChange:a=>af(a.target.checked),className:"w-5 h-5 rounded border-gray-300 text-green-600 focus:ring-2 focus:ring-green-500 mt-1 flex-shrink-0 cursor-pointer"}),(0,b.jsxs)("label",{htmlFor:"agreeToPolicy",className:"text-gray-600 text-sm flex-1 cursor-pointer",children:["I have read and agree to the"," ",(0,b.jsx)("a",{href:"/return-refund-policy",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 font-medium",children:"Return & Refund Policy"})]})]}),!ae&&(0,b.jsxs)("div",{className:"mt-3 p-3 bg-amber-50 border border-amber-200 rounded-lg flex gap-2",role:"alert",children:[(0,b.jsx)(m.AlertCircle,{className:"w-4 h-4 text-amber-600 flex-shrink-0 mt-0.5","aria-hidden":"true"}),(0,b.jsx)("p",{className:"text-xs text-amber-800",children:"You must agree to the Return & Refund Policy to complete your purchase."})]}),(0,b.jsxs)("div",{className:"border-t border-gray-200 pt-6 mt-6",children:[(0,b.jsx)("h4",{className:"text-gray-900 font-bold text-lg mb-4",children:"Privacy & Data Protection"}),(0,b.jsxs)("div",{className:"flex items-start gap-3 mb-4",children:[(0,b.jsx)("input",{type:"checkbox",id:"agreeToPrivacy",checked:ak,onChange:a=>al(a.target.checked),className:"w-5 h-5 rounded border-gray-300 text-blue-600 focus:ring-2 focus:ring-blue-500 mt-1 flex-shrink-0 cursor-pointer"}),(0,b.jsxs)("label",{htmlFor:"agreeToPrivacy",className:"text-gray-600 text-sm flex-1 cursor-pointer",children:["I have read and agree to the"," ",(0,b.jsx)("a",{href:"/privacy",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 font-medium",children:"Privacy Policy"})]})]}),(0,b.jsxs)("div",{className:"flex items-start gap-3 mb-4",children:[(0,b.jsx)("input",{type:"checkbox",id:"agreeToTerms",checked:aq,onChange:a=>ar(a.target.checked),className:"w-5 h-5 rounded border-gray-300 text-red-600 focus:ring-2 focus:ring-red-500 mt-1 flex-shrink-0 cursor-pointer"}),(0,b.jsxs)("label",{htmlFor:"agreeToTerms",className:"text-gray-600 text-sm flex-1 cursor-pointer",children:["I have read and agree to the"," ",(0,b.jsx)("a",{href:"/terms",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 font-medium",children:"Terms of Service"})]})]}),(0,b.jsxs)("div",{className:"flex items-start gap-3 mb-4",children:[(0,b.jsx)("input",{type:"checkbox",id:"agreeToShippingPolicy",checked:as,onChange:a=>at(a.target.checked),className:"w-5 h-5 rounded border-gray-300 text-green-600 focus:ring-2 focus:ring-green-500 mt-1 flex-shrink-0 cursor-pointer"}),(0,b.jsxs)("label",{htmlFor:"agreeToShippingPolicy",className:"text-gray-600 text-sm flex-1 cursor-pointer",children:["I have read and agree to the"," ",(0,b.jsx)("a",{href:"/shipping",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 font-medium",children:"Shipping Policy"})]})]}),(0,b.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 text-sm text-gray-700",children:[(0,b.jsx)("p",{className:"font-semibold text-gray-900 mb-2",children:"How We Handle Your Data"}),(0,b.jsxs)("ul",{className:"space-y-2 text-xs",children:[(0,b.jsx)("li",{children:"âœ“ Your personal information is encrypted and transmitted securely using SSL/TLS"}),(0,b.jsx)("li",{children:"âœ“ Payment information is processed by Square and never stored on our servers"}),(0,b.jsx)("li",{children:"âœ“ We do not sell or share your personal data with third parties for marketing"}),(0,b.jsx)("li",{children:"âœ“ You can request access, correction, or deletion of your data at any time"}),(0,b.jsx)("li",{children:"âœ“ We retain your data only as long as necessary for order fulfillment and legal compliance"})]})]})]}),(!ak||!aq||!as)&&(0,b.jsxs)("div",{className:"mt-4 p-3 bg-amber-50 border border-amber-200 rounded-lg flex gap-2",children:[(0,b.jsx)(m.AlertCircle,{className:"w-4 h-4 text-amber-600 flex-shrink-0 mt-0.5"}),(0,b.jsx)("p",{className:"text-xs text-amber-800",children:"You must agree to all policies and terms to complete your purchase."})]}),(0,b.jsxs)("div",{className:"backdrop-blur-xl bg-white border border-gray-200 rounded-2xl p-6 mt-6",children:[(0,b.jsx)("h4",{className:"text-gray-900 font-bold mb-4 flex items-center gap-2",children:"ðŸ’¬ Need Help?"}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-gray-600 mb-1",children:"Email Support"}),(0,b.jsx)("a",{href:"mailto:sticky@stickerland.com",className:"text-blue-600 hover:text-blue-700 font-medium text-sm break-all",children:"sticky@stickerland.com"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-gray-600 mb-1",children:"Create a Support Ticket"}),(0,b.jsx)("a",{href:"/support",className:"text-blue-600 hover:text-blue-700 font-medium text-sm",children:"Contact Support â†’"})]}),(0,b.jsx)("div",{className:"pt-2 border-t border-gray-200",children:(0,b.jsx)("p",{className:"text-xs text-gray-500",children:"We typically respond within 24 hours"})})]})]})]})]}),(0,b.jsx)("div",{className:"lg:col-span-1",children:(0,b.jsxs)("div",{className:"sticky top-32 space-y-6",children:[(0,b.jsxs)("div",{className:"backdrop-blur-xl bg-white border border-gray-200 rounded-2xl p-6",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,b.jsx)("h3",{className:"text-xl font-bold",children:"Order Summary"}),(0,b.jsx)("button",{type:"button",className:"text-gray-600 hover:text-gray-900 transition",children:(0,b.jsx)(u.Share2,{className:"w-5 h-5"})})]}),(0,b.jsxs)("div",{className:"space-y-3 text-sm mb-6 pb-6 border-b border-gray-200",children:[(0,b.jsxs)("div",{className:"flex justify-between text-gray-600",children:[(0,b.jsxs)("span",{children:["Subtotal (",i.length," items)"]}),(0,b.jsxs)("span",{children:["$",W.subtotal.toFixed(2)]})]}),(0,b.jsxs)("div",{className:"flex justify-between text-gray-600",children:[(0,b.jsx)("span",{children:"You're paying"}),(0,b.jsxs)("span",{children:["$",(W.subtotal/(i.reduce((a,b)=>a+b.quantity,0)||1)).toFixed(2)," ","per sticker"]})]}),Q>0&&(0,b.jsxs)("div",{className:"flex justify-between text-blue-600",children:[(0,b.jsx)("span",{children:"Shipping"}),(0,b.jsxs)("span",{className:"font-bold",children:["$",Q.toFixed(2)]})]}),0===Q&&(0,b.jsxs)("div",{className:"flex justify-between text-green-600",children:[(0,b.jsx)("span",{children:"Shipping"}),(0,b.jsx)("span",{className:"font-bold",children:"FREE"})]}),I>0&&(0,b.jsxs)("div",{className:"flex justify-between text-green-600",children:[(0,b.jsx)("span",{children:"Deal Savings"}),(0,b.jsxs)("span",{className:"font-bold",children:["-$",I.toFixed(2)]})]}),C&&(0,b.jsxs)("div",{className:"flex justify-between text-orange-600",children:[(0,b.jsx)("span",{children:"Blind Shipment Fee"}),(0,b.jsxs)("span",{children:["+$",W.blindShipmentFee.toFixed(2)]})]}),W.additionalPayment>0&&(0,b.jsxs)("div",{className:"flex justify-between text-orange-600",children:[(0,b.jsx)("span",{children:"Additional Payment"}),(0,b.jsxs)("span",{children:["+$",W.additionalPayment.toFixed(2)]})]})]}),(0,b.jsxs)("div",{className:"flex justify-between items-center mb-6 text-xl font-bold",children:[(0,b.jsx)("span",{children:"Total"}),(0,b.jsxs)("span",{children:["$",W.total.toFixed(2)]})]})]}),(0,b.jsx)(o,{selectedOptionId:O,onSelectionChange:(a,b,c,d)=>{P(a),R(b),T(c),V(d),au(W.subtotal,I,K,b)}}),S&&(0,b.jsxs)("div",{className:"backdrop-blur-xl bg-white border border-gray-200 rounded-2xl p-6",children:[(0,b.jsx)("h4",{className:"text-gray-900 font-bold mb-4 flex items-center gap-2",children:"ðŸ“¦ Estimated Delivery"}),(0,b.jsxs)("div",{className:"border-t border-gray-200 pt-3 flex justify-between font-bold text-lg",children:[(0,b.jsx)("span",{children:"Delivery by"}),(0,b.jsx)("span",{className:"text-green-600",children:new Date(S).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})})]}),(0,b.jsx)("p",{className:"text-xs text-gray-500 mt-3",children:"* Delivery may not occur on weekends. Dates are automatically moved to the next business day."})]}),aa&&ac?(0,b.jsxs)("div",{className:"mb-3",children:[(0,b.jsx)(q,{amount:W.total,orderId:ac,customerEmail:Y.email,customerName:`${Y.firstName} ${Y.lastName}`,onPaymentSuccess:b=>{localStorage.removeItem("cart"),localStorage.removeItem("cart_id"),ac&&setTimeout(()=>{let b=(0,x.formatOrderNumber)(ac);a(`/order-confirmation/${b}`)},1e3)},isLoading:y}),(0,b.jsxs)("div",{className:"mt-4 p-3 bg-green-50 border border-green-200 rounded-lg flex items-center gap-3",children:[(0,b.jsx)("div",{className:"flex-shrink-0",children:(0,b.jsx)("svg",{className:"w-5 h-5 text-green-600",fill:"currentColor",viewBox:"0 0 20 20",children:(0,b.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-semibold text-green-900",children:"PCI DSS Level 1 Compliant"}),(0,b.jsx)("p",{className:"text-xs text-green-700",children:"Your payment information is processed securely by Square Payment Systems, certified to PCI DSS Level 1 standards."})]})]})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(r.Button,{type:"submit",disabled:y||!ae||!ak||!aq||!as,className:"w-full bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white py-6 text-lg font-bold rounded-lg mb-3 disabled:opacity-50 disabled:cursor-not-allowed",children:y?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(s.Loader2,{className:"w-5 h-5 mr-2 animate-spin"}),"Processing..."]}):(0,b.jsx)(b.Fragment,{children:"ðŸ’³ Go to Checkout"})}),(0,b.jsx)("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:(0,b.jsxs)("p",{className:"text-xs text-blue-800",children:["ðŸ”’"," ",(0,b.jsx)("span",{className:"font-semibold",children:"Payment Security:"})," ","Your payment information will be processed securely by Square Payment Systems, which is PCI DSS Level 1 certified. We never store your credit card information on our servers."]})})]})]})})]})})]})})]})}a.s(["default",()=>y],38105)}];

//# sourceMappingURL=client_pages_CheckoutNew_tsx_54caef10._.js.map