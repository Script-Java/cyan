{"version":3,"sources":["../../../../client/pages/AdminOrders.tsx","../../../../components/ShippingLabelModal.tsx"],"sourcesContent":["import { useState, useEffect } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport AdminLayout from \"@/components/AdminLayout\";\r\nimport OrderStatusEditor from \"@/components/OrderStatusEditor\";\r\nimport ShippingLabelModal from \"@/components/ShippingLabelModal\";\r\nimport ShippingAddressEditor from \"@/components/ShippingAddressEditor\";\r\nimport OptionCostEditor from \"@/components/OptionCostEditor\";\r\nimport {\r\n  Package,\r\n  Calendar,\r\n  Mail,\r\n  ChevronDown,\r\n  Search,\r\n  Filter,\r\n  Image as ImageIcon,\r\n  ArrowRight,\r\n  Edit,\r\n  Truck,\r\n  Loader2,\r\n  Download,\r\n  FileText,\r\n} from \"lucide-react\";\r\n\r\ninterface OrderItem {\r\n  id?: number;\r\n  quantity?: number;\r\n  product_name?: string;\r\n  options?: Record<string, any> | Array<any>;\r\n  design_file_url?: string;\r\n}\r\n\r\ninterface ProofStatus {\r\n  id: string;\r\n  status: \"pending\" | \"approved\" | \"revisions_requested\";\r\n  description?: string;\r\n  createdAt: string;\r\n  updatedAt: string;\r\n}\r\n\r\ninterface PendingOrder {\r\n  id: number;\r\n  customerId: number;\r\n  customerName: string;\r\n  customerEmail: string;\r\n  status: string;\r\n  total: number;\r\n  subtotal?: number;\r\n  tax?: number;\r\n  shipping?: number;\r\n  dateCreated: string;\r\n  itemCount?: number;\r\n  orderItems?: OrderItem[];\r\n  tracking_number?: string;\r\n  shipped_date?: string;\r\n  shipping_addresses?: Array<{\r\n    first_name: string;\r\n    last_name: string;\r\n    street_1: string;\r\n    street_2?: string;\r\n    city: string;\r\n    state_or_province: string;\r\n    postal_code: string;\r\n    country_iso2: string;\r\n    phone?: string;\r\n  }>;\r\n  proofs?: ProofStatus[];\r\n}\r\n\r\n// Generate order number in format SY-5XXXX where XXXX starts from 4002\r\nconst generateOrderNumber = (orderId: number): string => {\r\n  const orderNumber = 4001 + orderId;\r\n  return `SY-5${orderNumber}`;\r\n};\r\n\r\nexport default function AdminOrders() {\r\n  const navigate = useNavigate();\r\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\r\n  const [pendingOrders, setPendingOrders] = useState<PendingOrder[]>([]);\r\n  const [filteredOrders, setFilteredOrders] = useState<PendingOrder[]>([]);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [searchTerm, setSearchTerm] = useState(\"\");\r\n  const [filterStatus, setFilterStatus] = useState(\"all\");\r\n  const [hideRecentOrders, setHideRecentOrders] = useState(true);\r\n  const [expandedOrderId, setExpandedOrderId] = useState<number | null>(null);\r\n  const [editingOrderId, setEditingOrderId] = useState<number | null>(null);\r\n  const [shippingLabelOrderId, setShippingLabelOrderId] = useState<\r\n    number | null\r\n  >(null);\r\n  const [editingShippingAddressOrderId, setEditingShippingAddressOrderId] =\r\n    useState<number | null>(null);\r\n  const [editingOptionItemId, setEditingOptionItemId] = useState<{\r\n    orderId: number;\r\n    itemId: number;\r\n    productName: string;\r\n    options: any[];\r\n  } | null>(null);\r\n  const [currentPage, setCurrentPage] = useState(1);\r\n  const [hasMore, setHasMore] = useState(false);\r\n  const [isLoadingMore, setIsLoadingMore] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const token = localStorage.getItem(\"authToken\");\r\n    const isAdmin = localStorage.getItem(\"isAdmin\") === \"true\";\r\n\r\n    if (!token || !isAdmin) {\r\n      navigate(\"/login\");\r\n      return;\r\n    }\r\n    setIsAuthenticated(true);\r\n    // Reset pagination on initial load\r\n    setCurrentPage(1);\r\n    setPendingOrders([]);\r\n    fetchOrders(1, true);\r\n  }, [navigate]);\r\n\r\n  const fetchOrders = async (\r\n    page: number = 1,\r\n    reset: boolean = false,\r\n    retryCount = 0,\r\n  ) => {\r\n    try {\r\n      const token = localStorage.getItem(\"authToken\");\r\n      if (!token) {\r\n        console.error(\"No authentication token found\");\r\n        setIsLoading(false);\r\n        setIsLoadingMore(false);\r\n        return;\r\n      }\r\n\r\n      const controller = new AbortController();\r\n      const timeoutId = setTimeout(() => controller.abort(), 120000); // 120 second timeout\r\n\r\n      const response = await fetch(\r\n        `/api/admin/all-orders?page=${page}&limit=20`,\r\n        {\r\n          method: \"GET\",\r\n          headers: {\r\n            \"Content-Type\": \"application/json\",\r\n            Authorization: `Bearer ${token}`,\r\n          },\r\n          signal: controller.signal,\r\n        },\r\n      );\r\n\r\n      clearTimeout(timeoutId);\r\n\r\n      if (!response.ok) {\r\n        const errorData = await response.text().catch(() => \"\");\r\n        console.error(\r\n          `Failed to fetch orders: ${response.status} ${response.statusText}`,\r\n          errorData,\r\n        );\r\n\r\n        // Retry on server errors, but not on auth errors\r\n        if (response.status >= 500 && retryCount < 2) {\r\n          console.log(`Retrying orders fetch (attempt ${retryCount + 2})...`);\r\n          setTimeout(\r\n            () => fetchOrders(page, reset, retryCount + 1),\r\n            1000 * (retryCount + 1),\r\n          );\r\n          return;\r\n        }\r\n\r\n        setIsLoading(false);\r\n        setIsLoadingMore(false);\r\n        return;\r\n      }\r\n\r\n      const data = await response.json();\r\n      const newOrders = data.orders || [];\r\n\r\n      // If resetting (first page), replace all orders; otherwise append\r\n      if (reset) {\r\n        setPendingOrders(newOrders);\r\n        setFilteredOrders(newOrders);\r\n      } else {\r\n        setPendingOrders((prev) => [...prev, ...newOrders]);\r\n        setFilteredOrders((prev) => [...prev, ...newOrders]);\r\n      }\r\n\r\n      // Update pagination state\r\n      setCurrentPage(page);\r\n      setHasMore(data.pagination?.hasMore || false);\r\n\r\n      console.log(`Loaded page ${page}, has more: ${data.pagination?.hasMore}`);\r\n    } catch (error) {\r\n      if (error instanceof Error && error.name === \"AbortError\") {\r\n        console.error(\"Orders fetch timeout after 120 seconds\");\r\n      } else {\r\n        const errorMessage =\r\n          error instanceof Error ? error.message : String(error);\r\n        console.error(\"Error fetching orders:\", errorMessage);\r\n      }\r\n\r\n      // Retry on network errors\r\n      if (retryCount < 2) {\r\n        console.log(\r\n          `Retrying orders fetch (attempt ${retryCount + 2}) after network error...`,\r\n        );\r\n        setTimeout(\r\n          () => fetchOrders(page, reset, retryCount + 1),\r\n          1000 * (retryCount + 1),\r\n        );\r\n        return;\r\n      }\r\n    } finally {\r\n      setIsLoading(false);\r\n      setIsLoadingMore(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    let filtered = pendingOrders;\r\n\r\n    // Hide orders from the past 7 days if toggle is enabled\r\n    if (hideRecentOrders) {\r\n      const sevenDaysAgo = new Date();\r\n      sevenDaysAgo.setDate(sevenDaysAgo.getDate() - 7);\r\n      filtered = filtered.filter(\r\n        (order) => new Date(order.dateCreated) < sevenDaysAgo,\r\n      );\r\n    }\r\n\r\n    if (searchTerm) {\r\n      filtered = filtered.filter(\r\n        (order) =>\r\n          order.id.toString().includes(searchTerm) ||\r\n          order.customerName.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n          order.customerEmail.toLowerCase().includes(searchTerm.toLowerCase()),\r\n      );\r\n    }\r\n\r\n    if (filterStatus !== \"all\") {\r\n      filtered = filtered.filter((order) => order.status === filterStatus);\r\n    }\r\n\r\n    setFilteredOrders(filtered);\r\n  }, [searchTerm, filterStatus, pendingOrders, hideRecentOrders]);\r\n\r\n  const getStatusColor = (status: string) => {\r\n    switch (status) {\r\n      case \"pending_payment\":\r\n        return \"text-amber-300 bg-amber-500/20 border border-amber-500/30\";\r\n      case \"paid\":\r\n        return \"text-emerald-300 bg-emerald-500/20 border border-emerald-500/30\";\r\n      case \"pending\":\r\n        return \"text-orange-300 bg-orange-500/20 border border-orange-500/30\";\r\n      case \"processing\":\r\n        return \"text-yellow-300 bg-yellow-500/20 border border-yellow-500/30\";\r\n      case \"printing\":\r\n        return \"text-purple-300 bg-purple-500/20 border border-purple-500/30\";\r\n      case \"preparing for shipping\":\r\n        return \"text-indigo-300 bg-indigo-500/20 border border-indigo-500/30\";\r\n      case \"in transit\":\r\n        return \"text-blue-300 bg-blue-500/20 border border-blue-500/30\";\r\n      case \"shipped\":\r\n        return \"text-green-300 bg-green-500/20 border border-green-500/30\";\r\n      case \"delivered\":\r\n        return \"text-cyan-300 bg-cyan-500/20 border border-cyan-500/30\";\r\n      case \"cancelled\":\r\n        return \"text-red-300 bg-red-500/20 border border-red-500/30\";\r\n      default:\r\n        return \"text-gray-600 bg-gray-100 border border-gray-200\";\r\n    }\r\n  };\r\n\r\n  const getPaymentStatusColor = (status: string) => {\r\n    if (status === \"pending_payment\") {\r\n      return \"text-orange-600 bg-orange-50 border border-orange-200\";\r\n    } else if (status === \"paid\") {\r\n      return \"text-green-600 bg-green-50 border border-green-200\";\r\n    }\r\n    return \"\";\r\n  };\r\n\r\n  const getPaymentStatusLabel = (status: string) => {\r\n    if (status === \"pending_payment\") {\r\n      return \"Awaiting Payment\";\r\n    } else if (status === \"paid\") {\r\n      return \"Payment Confirmed\";\r\n    }\r\n    return null;\r\n  };\r\n\r\n  const getStatusDisplayLabel = (status: string) => {\r\n    const statusMap: Record<string, string> = {\r\n      pending_payment: \"Pending Payment\",\r\n      paid: \"Awaiting Fulfillment\",\r\n      pending: \"Pending\",\r\n      processing: \"Processing\",\r\n      printing: \"Printing\",\r\n      \"preparing for shipping\": \"Preparing for Shipping\",\r\n      \"in transit\": \"In Transit\",\r\n      shipped: \"Shipped\",\r\n      delivered: \"Delivered\",\r\n      completed: \"Completed\",\r\n      cancelled: \"Cancelled\",\r\n    };\r\n    return (\r\n      statusMap[status] || status.charAt(0).toUpperCase() + status.slice(1)\r\n    );\r\n  };\r\n\r\n  const formatDate = (dateString: string) => {\r\n    return new Date(dateString).toLocaleDateString(\"en-US\", {\r\n      year: \"numeric\",\r\n      month: \"short\",\r\n      day: \"numeric\",\r\n      hour: \"2-digit\",\r\n      minute: \"2-digit\",\r\n    });\r\n  };\r\n\r\n  const formatOptionValue = (value: any): string => {\r\n    if (value === null || value === undefined) {\r\n      return \"N/A\";\r\n    }\r\n    if (typeof value === \"string\") {\r\n      return value;\r\n    }\r\n    if (typeof value === \"number\") {\r\n      return String(value);\r\n    }\r\n    if (typeof value === \"boolean\") {\r\n      return value ? \"Yes\" : \"No\";\r\n    }\r\n    if (Array.isArray(value)) {\r\n      return value.join(\", \");\r\n    }\r\n    if (typeof value === \"object\") {\r\n      try {\r\n        return JSON.stringify(value);\r\n      } catch {\r\n        return \"Complex Object\";\r\n      }\r\n    }\r\n    return String(value);\r\n  };\r\n\r\n  if (!isAuthenticated) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <AdminLayout>\r\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6\">\r\n        {/* Header */}\r\n        <div className=\"mb-6\">\r\n          <h1 className=\"text-3xl font-bold text-gray-900\">Orders</h1>\r\n          <p className=\"text-gray-600 mt-1\">\r\n            View and manage all orders across all statuses\r\n          </p>\r\n        </div>\r\n\r\n        {isLoading ? (\r\n          <div className=\"flex justify-center items-center h-96\">\r\n            <div className=\"text-gray-600\">Loading orders...</div>\r\n          </div>\r\n        ) : (\r\n          <div className=\"space-y-4\">\r\n            {/* Search and Filter */}\r\n            <div className=\"flex flex-col gap-3\">\r\n              <div className=\"flex gap-3\">\r\n                <div className=\"flex-1 relative\">\r\n                  <Search className=\"absolute left-3 top-3.5 w-4 h-4 text-gray-400\" />\r\n                  <input\r\n                    type=\"text\"\r\n                    placeholder=\"Search by order, customer, or email...\"\r\n                    value={searchTerm}\r\n                    onChange={(e) => setSearchTerm(e.target.value)}\r\n                    className=\"w-full pl-10 pr-4 py-2 bg-white border border-gray-200 rounded-lg text-gray-900 placeholder-gray-400 text-sm focus:outline-none focus:ring-2 focus:ring-green-500/50\"\r\n                  />\r\n                </div>\r\n                <div className=\"flex items-center gap-2\">\r\n                  <Filter className=\"w-4 h-4 text-gray-400 flex-shrink-0\" />\r\n                  <select\r\n                    value={filterStatus}\r\n                    onChange={(e) => setFilterStatus(e.target.value)}\r\n                    className=\"px-3 py-2 bg-white border border-gray-200 rounded-lg text-gray-900 text-sm focus:outline-none focus:ring-2 focus:ring-green-500/50\"\r\n                  >\r\n                    <option value=\"all\">All Statuses</option>\r\n                    <option value=\"pending_payment\">Pending Payment</option>\r\n                    <option value=\"paid\">Awaiting Fulfillment</option>\r\n                    <option value=\"pending\">Pending</option>\r\n                    <option value=\"processing\">Processing</option>\r\n                    <option value=\"printing\">Printing</option>\r\n                    <option value=\"preparing for shipping\">\r\n                      Preparing for Shipping\r\n                    </option>\r\n                    <option value=\"in transit\">In Transit</option>\r\n                    <option value=\"shipped\">Shipped</option>\r\n                    <option value=\"delivered\">Delivered</option>\r\n                    <option value=\"completed\">Completed</option>\r\n                    <option value=\"cancelled\">Cancelled</option>\r\n                  </select>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Hide Recent Orders Toggle */}\r\n              <div className=\"flex items-center gap-3 px-3 py-2 bg-white border border-gray-200 rounded-lg w-fit\">\r\n                <input\r\n                  type=\"checkbox\"\r\n                  id=\"hideRecentOrders\"\r\n                  checked={hideRecentOrders}\r\n                  onChange={(e) => setHideRecentOrders(e.target.checked)}\r\n                  className=\"w-4 h-4 rounded border border-gray-300 bg-white cursor-pointer accent-green-500\"\r\n                />\r\n                <label\r\n                  htmlFor=\"hideRecentOrders\"\r\n                  className=\"text-sm text-gray-700 cursor-pointer font-medium\"\r\n                >\r\n                  Hide orders from past 7 days\r\n                </label>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Orders List */}\r\n            {filteredOrders.length > 0 ? (\r\n              <div className=\"bg-white border border-gray-200 rounded-lg overflow-hidden\">\r\n                {/* Header */}\r\n                <div className=\"px-6 py-3 border-b border-gray-200 bg-gray-50\">\r\n                  <h2 className=\"text-lg font-semibold text-gray-900\">\r\n                    Orders\r\n                    <span className=\"ml-3 text-sm font-normal text-gray-600\">\r\n                      {filteredOrders.length}{\" \"}\r\n                      {filteredOrders.length === 1 ? \"order\" : \"orders\"}\r\n                    </span>\r\n                  </h2>\r\n                </div>\r\n\r\n                {/* Orders */}\r\n                <div className=\"divide-y divide-gray-200\">\r\n                  {filteredOrders.map((order) => (\r\n                    <div key={order.id}>\r\n                      {/* Order Row */}\r\n                      <button\r\n                        onClick={() => navigate(`/admin/orders/${order.id}`)}\r\n                        className=\"w-full px-6 py-4 flex items-center justify-between hover:bg-gray-50 transition-colors text-left\"\r\n                      >\r\n                        <div className=\"flex-1 min-w-0\">\r\n                          <div className=\"flex items-center gap-3 flex-wrap\">\r\n                            <span className=\"font-semibold text-gray-900\">\r\n                              {generateOrderNumber(order.id)}\r\n                            </span>\r\n                            <span\r\n                              className={`px-2.5 py-1 rounded-full text-xs font-medium ${getStatusColor(\r\n                                order.status,\r\n                              )}`}\r\n                            >\r\n                              {getStatusDisplayLabel(order.status)}\r\n                            </span>\r\n                            {getPaymentStatusLabel(order.status) && (\r\n                              <span\r\n                                className={`px-2.5 py-1 rounded-full text-xs font-medium ${getPaymentStatusColor(\r\n                                  order.status,\r\n                                )}`}\r\n                              >\r\n                                {getPaymentStatusLabel(order.status)}\r\n                              </span>\r\n                            )}\r\n                          </div>\r\n                          <div className=\"text-sm text-gray-600 mt-1\">\r\n                            {order.customerName} •{\" \"}\r\n                            <span className=\"text-gray-500\">\r\n                              {order.customerEmail}\r\n                            </span>\r\n                          </div>\r\n                          <div className=\"text-xs text-gray-500 mt-1\">\r\n                            {formatDate(order.dateCreated)}\r\n                          </div>\r\n                        </div>\r\n                        <div className=\"flex items-center gap-4 flex-shrink-0 ml-4\">\r\n                          <span className=\"font-semibold text-green-600 text-right\">\r\n                            ${order.total.toFixed(2)}\r\n                          </span>\r\n                          <ArrowRight className=\"w-5 h-5 text-gray-600\" />\r\n                        </div>\r\n                      </button>\r\n\r\n                      {/* Order Details */}\r\n                      {expandedOrderId === order.id && (\r\n                        <div className=\"px-6 py-4 bg-white border-t border-gray-200 space-y-4\">\r\n                          {/* Action Buttons */}\r\n                          <div className=\"flex gap-2 flex-wrap\">\r\n                            <button\r\n                              onClick={() => setEditingOrderId(order.id)}\r\n                              className=\"inline-flex items-center gap-2 px-4 py-2 bg-green-100 hover:bg-green-200 border border-green-300 rounded-lg text-green-700 hover:text-green-800 transition-colors text-sm font-medium\"\r\n                            >\r\n                              <Edit className=\"w-4 h-4\" />\r\n                              Edit Status & Tracking\r\n                            </button>\r\n                            <button\r\n                              onClick={() => setShippingLabelOrderId(order.id)}\r\n                              className=\"inline-flex items-center gap-2 px-4 py-2 bg-blue-100 hover:bg-blue-200 border border-blue-300 rounded-lg text-blue-700 hover:text-blue-800 transition-colors text-sm font-medium\"\r\n                            >\r\n                              <Truck className=\"w-4 h-4\" />\r\n                              Purchase Shipping Label\r\n                            </button>\r\n                          </div>\r\n                          {/* Price Breakdown */}\r\n                          <div>\r\n                            <h4 className=\"text-sm font-semibold text-gray-900 mb-3\">\r\n                              Price Breakdown\r\n                            </h4>\r\n                            <div className=\"grid grid-cols-2 sm:grid-cols-4 gap-3\">\r\n                              <div className=\"bg-gray-50 rounded border border-gray-200 p-3\">\r\n                                <p className=\"text-xs text-gray-600\">\r\n                                  Subtotal\r\n                                </p>\r\n                                <p className=\"text-sm font-semibold text-gray-900\">\r\n                                  $\r\n                                  {(\r\n                                    order.subtotal || order.total * 0.8\r\n                                  ).toFixed(2)}\r\n                                </p>\r\n                              </div>\r\n                              <div className=\"bg-gray-50 rounded border border-gray-200 p-3\">\r\n                                <p className=\"text-xs text-gray-600\">Tax</p>\r\n                                <p className=\"text-sm font-semibold text-gray-900\">\r\n                                  ${(order.tax || order.total * 0.1).toFixed(2)}\r\n                                </p>\r\n                              </div>\r\n                              <div className=\"bg-gray-50 rounded border border-gray-200 p-3\">\r\n                                <p className=\"text-xs text-gray-600\">\r\n                                  Shipping\r\n                                </p>\r\n                                <p className=\"text-sm font-semibold text-gray-900\">\r\n                                  ${(order.shipping || 0).toFixed(2)}\r\n                                </p>\r\n                              </div>\r\n                              <div className=\"bg-green-50 border border-green-200 rounded p-3\">\r\n                                <p className=\"text-xs text-gray-600\">Total</p>\r\n                                <p className=\"text-sm font-semibold text-green-700\">\r\n                                  ${order.total.toFixed(2)}\r\n                                </p>\r\n                              </div>\r\n                            </div>\r\n                          </div>\r\n\r\n                          {/* Items */}\r\n                          {order.orderItems && order.orderItems.length > 0 && (\r\n                            <div>\r\n                              <h4 className=\"text-sm font-semibold text-gray-900 mb-3\">\r\n                                Order Items ({order.orderItems.length})\r\n                              </h4>\r\n                              <div className=\"space-y-4\">\r\n                                {order.orderItems.map((item, idx) => (\r\n                                  <div\r\n                                    key={idx}\r\n                                    className=\"bg-white rounded border border-gray-200 p-4\"\r\n                                  >\r\n                                    <div className=\"flex gap-4 items-start\">\r\n                                      {/* Product Image Thumbnail */}\r\n                                      {item.design_file_url && (\r\n                                        <div className=\"flex-shrink-0 flex flex-col gap-2\">\r\n                                          <div className=\"w-24 h-24 bg-gray-100 border border-gray-300 rounded-lg overflow-hidden flex items-center justify-center relative group\">\r\n                                            {item.design_file_url.startsWith(\r\n                                              \"data:\",\r\n                                            ) ? (\r\n                                              <>\r\n                                                {item.design_file_url.match(\r\n                                                  /^data:image\\/(jpg|jpeg|png|gif|webp)/i,\r\n                                                ) ? (\r\n                                                  <img\r\n                                                    src={item.design_file_url}\r\n                                                    alt=\"Design Upload\"\r\n                                                    className=\"w-full h-full object-cover\"\r\n                                                    onError={(e) => {\r\n                                                      e.currentTarget.style.display =\r\n                                                        \"none\";\r\n                                                    }}\r\n                                                  />\r\n                                                ) : (\r\n                                                  <div className=\"flex flex-col items-center justify-center w-full h-full\">\r\n                                                    <FileText className=\"w-6 h-6 text-gray-400 mb-1\" />\r\n                                                    <span className=\"text-xs text-gray-500 text-center px-1\">\r\n                                                      File\r\n                                                    </span>\r\n                                                  </div>\r\n                                                )}\r\n                                              </>\r\n                                            ) : (\r\n                                              <>\r\n                                                {item.design_file_url.match(\r\n                                                  /\\.(jpg|jpeg|png|gif|webp)$/i,\r\n                                                ) ? (\r\n                                                  <img\r\n                                                    src={item.design_file_url}\r\n                                                    alt=\"Design Upload\"\r\n                                                    className=\"w-full h-full object-cover\"\r\n                                                    onError={(e) => {\r\n                                                      e.currentTarget.style.display =\r\n                                                        \"none\";\r\n                                                    }}\r\n                                                  />\r\n                                                ) : (\r\n                                                  <FileText className=\"w-6 h-6 text-gray-400\" />\r\n                                                )}\r\n                                              </>\r\n                                            )}\r\n                                            {/* Hover overlay for preview */}\r\n                                            <div className=\"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-40 flex items-center justify-center gap-1 transition-all opacity-0 group-hover:opacity-100\">\r\n                                              <a\r\n                                                href={item.design_file_url}\r\n                                                target=\"_blank\"\r\n                                                rel=\"noopener noreferrer\"\r\n                                                className=\"p-1.5 bg-white rounded hover:bg-gray-100 transition-colors\"\r\n                                                title=\"View full design\"\r\n                                              >\r\n                                                <ImageIcon className=\"w-4 h-4 text-gray-700\" />\r\n                                              </a>\r\n                                            </div>\r\n                                          </div>\r\n                                          {/* Download button */}\r\n                                          <button\r\n                                            onClick={() => {\r\n                                              if (\r\n                                                item.design_file_url.startsWith(\r\n                                                  \"data:\",\r\n                                                )\r\n                                              ) {\r\n                                                const link =\r\n                                                  document.createElement(\"a\");\r\n                                                link.href =\r\n                                                  item.design_file_url;\r\n                                                link.download = `design-${item.id || \"file\"}`;\r\n                                                link.click();\r\n                                              } else {\r\n                                                window.open(\r\n                                                  item.design_file_url,\r\n                                                  \"_blank\",\r\n                                                );\r\n                                              }\r\n                                            }}\r\n                                            className=\"inline-flex items-center justify-center gap-1 px-2 py-1 text-xs font-medium bg-blue-50 hover:bg-blue-100 text-blue-700 border border-blue-200 rounded transition-colors\"\r\n                                            title=\"Download design file\"\r\n                                          >\r\n                                            <Download className=\"w-3 h-3\" />\r\n                                            Download\r\n                                          </button>\r\n                                        </div>\r\n                                      )}\r\n\r\n                                      {/* Product Details */}\r\n                                      <div className=\"flex-1 min-w-0\">\r\n                                        <h5 className=\"text-gray-900 font-semibold text-sm mb-2\">\r\n                                          {item.product_name || \"Product\"}\r\n                                        </h5>\r\n\r\n                                        {/* Quantity */}\r\n                                        <div className=\"mb-3\">\r\n                                          <p className=\"text-xs text-gray-600 font-medium\">\r\n                                            QUANTITY\r\n                                          </p>\r\n                                          <p className=\"text-sm text-gray-900 font-medium\">\r\n                                            {item.quantity || 1}{\" \"}\r\n                                            {item.quantity === 1\r\n                                              ? \"unit\"\r\n                                              : \"units\"}\r\n                                          </p>\r\n                                        </div>\r\n\r\n                                        {/* Product Options */}\r\n                                        {item.options && (\r\n                                          <div>\r\n                                            <div className=\"flex items-center justify-between mb-2\">\r\n                                              <p className=\"text-xs text-gray-600 font-medium\">\r\n                                                SPECIFICATIONS\r\n                                              </p>\r\n                                              <button\r\n                                                onClick={() => {\r\n                                                  console.log(\r\n                                                    \"Edit costs clicked - Full context:\",\r\n                                                    {\r\n                                                      orderId: order.id,\r\n                                                      orderIdType:\r\n                                                        typeof order.id,\r\n                                                      item,\r\n                                                      itemId: item.id ?? idx,\r\n                                                      itemIdType: typeof (\r\n                                                        item.id ?? idx\r\n                                                      ),\r\n                                                    },\r\n                                                  );\r\n                                                  setEditingOptionItemId({\r\n                                                    orderId: order.id,\r\n                                                    itemId: item.id ?? idx,\r\n                                                    productName:\r\n                                                      item.product_name ||\r\n                                                      \"Product\",\r\n                                                    options: Array.isArray(\r\n                                                      item.options,\r\n                                                    )\r\n                                                      ? item.options\r\n                                                      : Object.entries(\r\n                                                          item.options,\r\n                                                        ).map(([key, val]) => ({\r\n                                                          option_id: key,\r\n                                                          option_value:\r\n                                                            formatOptionValue(\r\n                                                              val,\r\n                                                            ),\r\n                                                          price:\r\n                                                            typeof val ===\r\n                                                            \"object\"\r\n                                                              ? val.price || 0\r\n                                                              : 0,\r\n                                                        })),\r\n                                                  });\r\n                                                }}\r\n                                                className=\"inline-flex items-center gap-1 px-2 py-1 text-xs font-medium bg-green-100 hover:bg-green-200 text-green-700 border border-green-300 rounded transition-colors\"\r\n                                              >\r\n                                                <Edit className=\"w-3 h-3\" />\r\n                                                Edit Costs\r\n                                              </button>\r\n                                            </div>\r\n                                            <div className=\"flex flex-wrap gap-2\">\r\n                                              {Array.isArray(item.options)\r\n                                                ? item.options.length > 0\r\n                                                  ? item.options.map(\r\n                                                      (\r\n                                                        option: any,\r\n                                                        idx: number,\r\n                                                      ) => {\r\n                                                        const optionName =\r\n                                                          option.option_id ||\r\n                                                          \"\";\r\n                                                        const optionValue =\r\n                                                          option.option_value ||\r\n                                                          \"\";\r\n                                                        const optionPrice =\r\n                                                          option.price ||\r\n                                                          option.modifier_price ||\r\n                                                          0;\r\n\r\n                                                        if (\r\n                                                          !optionName ||\r\n                                                          !optionValue\r\n                                                        ) {\r\n                                                          return null;\r\n                                                        }\r\n\r\n                                                        return (\r\n                                                          <span\r\n                                                            key={idx}\r\n                                                            className=\"inline-block bg-blue-50 text-blue-900 px-3 py-1 rounded-full text-xs font-medium border border-blue-200\"\r\n                                                          >\r\n                                                            {optionName}:{\" \"}\r\n                                                            {optionValue}\r\n                                                            {optionPrice >\r\n                                                              0 && (\r\n                                                              <span className=\"ml-1 font-semibold\">\r\n                                                                (+$\r\n                                                                {optionPrice.toFixed(\r\n                                                                  2,\r\n                                                                )}\r\n                                                                )\r\n                                                              </span>\r\n                                                            )}\r\n                                                          </span>\r\n                                                        );\r\n                                                      },\r\n                                                    )\r\n                                                  : null\r\n                                                : Object.entries(\r\n                                                    item.options,\r\n                                                  ).map(([key, val]) => {\r\n                                                    const displayValue =\r\n                                                      formatOptionValue(val);\r\n                                                    const isNumericKey =\r\n                                                      /^\\d+$/.test(key);\r\n                                                    const label = isNumericKey\r\n                                                      ? displayValue\r\n                                                      : `${key}: ${displayValue}`;\r\n                                                    const optionPrice =\r\n                                                      typeof val === \"object\"\r\n                                                        ? val.price || 0\r\n                                                        : 0;\r\n\r\n                                                    return (\r\n                                                      <span\r\n                                                        key={key}\r\n                                                        className=\"inline-block bg-blue-50 text-blue-900 px-3 py-1 rounded-full text-xs font-medium border border-blue-200\"\r\n                                                      >\r\n                                                        {label}\r\n                                                        {optionPrice > 0 && (\r\n                                                          <span className=\"ml-1 font-semibold\">\r\n                                                            (+$\r\n                                                            {optionPrice.toFixed(\r\n                                                              2,\r\n                                                            )}\r\n                                                            )\r\n                                                          </span>\r\n                                                        )}\r\n                                                      </span>\r\n                                                    );\r\n                                                  })}\r\n                                            </div>\r\n                                          </div>\r\n                                        )}\r\n                                      </div>\r\n                                    </div>\r\n                                  </div>\r\n                                ))}\r\n                              </div>\r\n                            </div>\r\n                          )}\r\n\r\n                          {/* Tracking Information */}\r\n                          <div className=\"bg-gray-50 rounded border border-gray-200 p-3\">\r\n                            <h4 className=\"text-sm font-semibold text-gray-900 mb-2\">\r\n                              Tracking Information\r\n                            </h4>\r\n                            {order.tracking_number ? (\r\n                              <div className=\"space-y-2\">\r\n                                <div>\r\n                                  <p className=\"text-xs text-gray-600\">\r\n                                    Tracking Number\r\n                                  </p>\r\n                                  <p className=\"text-sm font-mono text-gray-900\">\r\n                                    {order.tracking_number}\r\n                                  </p>\r\n                                </div>\r\n                                {order.shipped_date && (\r\n                                  <div>\r\n                                    <p className=\"text-xs text-gray-600\">\r\n                                      Shipped\r\n                                    </p>\r\n                                    <p className=\"text-sm text-gray-900\">\r\n                                      {formatDate(order.shipped_date)}\r\n                                    </p>\r\n                                  </div>\r\n                                )}\r\n                              </div>\r\n                            ) : (\r\n                              <p className=\"text-sm text-gray-600\">\r\n                                No tracking information yet\r\n                              </p>\r\n                            )}\r\n                          </div>\r\n\r\n                          {/* Customer Info */}\r\n                          <div className=\"bg-gray-50 rounded border border-gray-200 p-3\">\r\n                            <h4 className=\"text-sm font-semibold text-gray-900 mb-2\">\r\n                              Customer\r\n                            </h4>\r\n                            <p className=\"text-sm text-gray-900\">\r\n                              {order.customerName}\r\n                            </p>\r\n                            <p className=\"text-sm text-gray-600\">\r\n                              {order.customerEmail}\r\n                            </p>\r\n                          </div>\r\n\r\n                          {/* Shipping Address */}\r\n                          <div className=\"bg-gray-50 rounded border border-gray-200 p-3\">\r\n                            <div className=\"flex items-center justify-between mb-3\">\r\n                              <h4 className=\"text-sm font-semibold text-gray-900\">\r\n                                Shipping Address\r\n                              </h4>\r\n                              <button\r\n                                onClick={() =>\r\n                                  setEditingShippingAddressOrderId(order.id)\r\n                                }\r\n                                className=\"inline-flex items-center gap-1 px-2 py-1 bg-blue-100 hover:bg-blue-200 border border-blue-300 rounded text-blue-700 hover:text-blue-800 transition-colors text-xs font-medium\"\r\n                              >\r\n                                <Edit className=\"w-3 h-3\" />\r\n                                {order.shipping_addresses &&\r\n                                order.shipping_addresses.length > 0\r\n                                  ? \"Edit\"\r\n                                  : \"Add\"}\r\n                              </button>\r\n                            </div>\r\n                            {order.shipping_addresses &&\r\n                            order.shipping_addresses.length > 0 ? (\r\n                              order.shipping_addresses.map((address, idx) => (\r\n                                <div key={idx} className=\"text-sm\">\r\n                                  <p className=\"text-gray-900\">\r\n                                    {address.first_name} {address.last_name}\r\n                                  </p>\r\n                                  <p className=\"text-gray-600\">\r\n                                    {address.street_1}\r\n                                  </p>\r\n                                  {address.street_2 && (\r\n                                    <p className=\"text-gray-600\">\r\n                                      {address.street_2}\r\n                                    </p>\r\n                                  )}\r\n                                  <p className=\"text-gray-600\">\r\n                                    {address.city}, {address.state_or_province}{\" \"}\r\n                                    {address.postal_code}\r\n                                  </p>\r\n                                  <p className=\"text-gray-600\">\r\n                                    {address.country_iso2}\r\n                                  </p>\r\n                                  {address.phone && (\r\n                                    <p className=\"text-gray-600 mt-1\">\r\n                                      {address.phone}\r\n                                    </p>\r\n                                  )}\r\n                                </div>\r\n                              ))\r\n                            ) : (\r\n                              <p className=\"text-sm text-gray-600\">\r\n                                No shipping address yet. Click \"Add\" to add one.\r\n                              </p>\r\n                            )}\r\n                          </div>\r\n\r\n                          {/* Artwork Proofs Status */}\r\n                          {order.proofs && order.proofs.length > 0 && (\r\n                            <div className=\"bg-blue-50 rounded border border-blue-200 p-3\">\r\n                              <h4 className=\"text-sm font-semibold text-blue-900 mb-3\">\r\n                                Artwork Proofs\r\n                              </h4>\r\n                              <div className=\"space-y-3\">\r\n                                {order.proofs.map((proof, idx) => (\r\n                                  <div\r\n                                    key={idx}\r\n                                    className=\"bg-white rounded border border-blue-100 p-3\"\r\n                                  >\r\n                                    <div className=\"flex items-center justify-between mb-2\">\r\n                                      <div className=\"flex items-center gap-2\">\r\n                                        {proof.status === \"approved\" && (\r\n                                          <span className=\"inline-flex items-center gap-1 px-2 py-0.5 bg-green-100 text-green-700 text-xs font-semibold rounded-full\">\r\n                                            ✓ Approved\r\n                                          </span>\r\n                                        )}\r\n                                        {proof.status ===\r\n                                          \"revisions_requested\" && (\r\n                                          <span className=\"inline-flex items-center gap-1 px-2 py-0.5 bg-amber-100 text-amber-700 text-xs font-semibold rounded-full\">\r\n                                            ⟳ Revisions Requested\r\n                                          </span>\r\n                                        )}\r\n                                        {proof.status === \"pending\" && (\r\n                                          <span className=\"inline-flex items-center gap-1 px-2 py-0.5 bg-gray-100 text-gray-700 text-xs font-semibold rounded-full\">\r\n                                            ⏳ Pending Review\r\n                                          </span>\r\n                                        )}\r\n                                      </div>\r\n                                      <p className=\"text-xs text-gray-500\">\r\n                                        {new Date(\r\n                                          proof.updatedAt || proof.createdAt,\r\n                                        ).toLocaleDateString(\"en-US\", {\r\n                                          month: \"short\",\r\n                                          day: \"numeric\",\r\n                                          hour: \"2-digit\",\r\n                                          minute: \"2-digit\",\r\n                                        })}\r\n                                      </p>\r\n                                    </div>\r\n                                    {proof.description && (\r\n                                      <p className=\"text-sm text-gray-700 mb-2\">\r\n                                        {proof.description}\r\n                                      </p>\r\n                                    )}\r\n                                  </div>\r\n                                ))}\r\n                              </div>\r\n                            </div>\r\n                          )}\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n\r\n                {/* Load More Button */}\r\n                {filteredOrders.length > 0 && hasMore && (\r\n                  <div className=\"mt-6 flex justify-center\">\r\n                    <button\r\n                      onClick={() => {\r\n                        setIsLoadingMore(true);\r\n                        fetchOrders(currentPage + 1);\r\n                      }}\r\n                      disabled={isLoadingMore}\r\n                      className=\"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white rounded-lg font-medium transition-colors\"\r\n                    >\r\n                      {isLoadingMore ? (\r\n                        <>\r\n                          <Loader2 className=\"w-4 h-4 animate-spin\" />\r\n                          Loading...\r\n                        </>\r\n                      ) : (\r\n                        \"Load More Orders\"\r\n                      )}\r\n                    </button>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            ) : (\r\n              <div className=\"bg-white border border-gray-200 rounded-lg p-8 sm:p-12 text-center\">\r\n                <Package className=\"w-12 h-12 text-gray-300 mx-auto mb-3\" />\r\n                <h3 className=\"text-lg font-semibold text-gray-900 mb-1\">\r\n                  No Orders Found\r\n                </h3>\r\n                <p className=\"text-sm text-gray-600\">\r\n                  {searchTerm || filterStatus !== \"all\" || hideRecentOrders\r\n                    ? \"No orders match your search or filter criteria.\"\r\n                    : \"There are no orders at this time.\"}\r\n                </p>\r\n              </div>\r\n            )}\r\n\r\n            {/* Summary Stats */}\r\n            {filteredOrders.length > 0 && (\r\n              <div className=\"grid grid-cols-2 md:grid-cols-3 gap-3\">\r\n                <div className=\"bg-white border border-gray-200 rounded-lg p-4\">\r\n                  <p className=\"text-xs text-gray-600 mb-1\">Total Orders</p>\r\n                  <p className=\"text-2xl font-bold text-gray-900\">\r\n                    {filteredOrders.length}\r\n                  </p>\r\n                </div>\r\n                <div className=\"bg-white border border-gray-200 rounded-lg p-4\">\r\n                  <p className=\"text-xs text-gray-600 mb-1\">Total Revenue</p>\r\n                  <p className=\"text-2xl font-bold text-green-600\">\r\n                    $\r\n                    {filteredOrders\r\n                      .reduce((sum, order) => sum + order.total, 0)\r\n                      .toFixed(2)}\r\n                  </p>\r\n                </div>\r\n                <div className=\"bg-white border border-gray-200 rounded-lg p-4\">\r\n                  <p className=\"text-xs text-gray-600 mb-1\">Avg Order Value</p>\r\n                  <p className=\"text-2xl font-bold text-blue-600\">\r\n                    $\r\n                    {(\r\n                      filteredOrders.reduce(\r\n                        (sum, order) => sum + order.total,\r\n                        0,\r\n                      ) / filteredOrders.length\r\n                    ).toFixed(2)}\r\n                  </p>\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Order Status Editor Modal */}\r\n      {editingOrderId !== null && (\r\n        <OrderStatusEditor\r\n          orderId={editingOrderId}\r\n          currentStatus={\r\n            pendingOrders.find((o) => o.id === editingOrderId)?.status || \"\"\r\n          }\r\n          currentTrackingNumber={\r\n            pendingOrders.find((o) => o.id === editingOrderId)?.tracking_number\r\n          }\r\n          currentTrackingCarrier={\r\n            pendingOrders.find((o) => o.id === editingOrderId)?.tracking_carrier\r\n          }\r\n          currentTrackingUrl={\r\n            pendingOrders.find((o) => o.id === editingOrderId)?.tracking_url\r\n          }\r\n          onClose={() => setEditingOrderId(null)}\r\n          currentTrackingCarrier={undefined}\r\n          currentTrackingUrl={undefined}\r\n          onSuccess={() => {\r\n            setEditingOrderId(null);\r\n            // Reload current page without resetting\r\n            fetchOrders(currentPage, false);\r\n          }}\r\n        />\r\n      )}\r\n\r\n      {/* Shipping Label Modal */}\r\n      {shippingLabelOrderId !== null && (\r\n        <ShippingLabelModal\r\n          orderId={shippingLabelOrderId}\r\n          orderNumber={shippingLabelOrderId.toString()}\r\n          shippingAddress={\r\n            pendingOrders.find((o) => o.id === shippingLabelOrderId)\r\n              ?.shipping_addresses?.[0]\r\n          }\r\n          onClose={() => setShippingLabelOrderId(null)}\r\n          onSuccess={() => {\r\n            setShippingLabelOrderId(null);\r\n            // Reload current page without resetting\r\n            fetchOrders(currentPage, false);\r\n          }}\r\n        />\r\n      )}\r\n\r\n      {/* Shipping Address Editor Modal */}\r\n      {editingShippingAddressOrderId !== null && (\r\n        <ShippingAddressEditor\r\n          orderId={editingShippingAddressOrderId}\r\n          currentAddress={\r\n            pendingOrders.find((o) => o.id === editingShippingAddressOrderId)\r\n              ?.shipping_addresses?.[0]\r\n          }\r\n          onClose={() => setEditingShippingAddressOrderId(null)}\r\n          onSuccess={() => {\r\n            setEditingShippingAddressOrderId(null);\r\n            // Reload current page without resetting\r\n            fetchOrders(currentPage, false);\r\n          }}\r\n        />\r\n      )}\r\n\r\n      {/* Option Cost Editor Modal */}\r\n      {editingOptionItemId !== null && (\r\n        <OptionCostEditor\r\n          orderId={editingOptionItemId.orderId}\r\n          itemId={editingOptionItemId.itemId}\r\n          productName={editingOptionItemId.productName}\r\n          options={editingOptionItemId.options}\r\n          onClose={() => setEditingOptionItemId(null)}\r\n          onSuccess={() => {\r\n            setEditingOptionItemId(null);\r\n            // Reload current page without resetting\r\n            fetchOrders(currentPage, false);\r\n          }}\r\n        />\r\n      )}\r\n    </AdminLayout>\r\n  );\r\n}\r\n","import { useState, useEffect, useCallback } from \"react\";\r\nimport { AlertCircle, Loader2, Package, X } from \"lucide-react\";\r\nimport { Button } from \"./ui/button\";\r\nimport { useToast } from \"./ui/use-toast\";\r\n\r\ninterface ShippingLabelModalProps {\r\n  orderId: number;\r\n  orderNumber: string;\r\n  shippingAddress?: {\r\n    first_name: string;\r\n    last_name: string;\r\n    street_1: string;\r\n    city: string;\r\n    state_or_province: string;\r\n    postal_code: string;\r\n    country_iso2: string;\r\n  };\r\n  onClose: () => void;\r\n  onSuccess: () => void;\r\n}\r\n\r\ninterface Carrier {\r\n  name: string;\r\n  code: string;\r\n}\r\n\r\ninterface Service {\r\n  name: string;\r\n  code: string;\r\n}\r\n\r\nexport default function ShippingLabelModal({\r\n  orderId,\r\n  orderNumber,\r\n  shippingAddress,\r\n  onClose,\r\n  onSuccess,\r\n}: ShippingLabelModalProps) {\r\n  const { toast } = useToast();\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [carriers, setCarriers] = useState<Carrier[]>([]);\r\n  const [services, setServices] = useState<Service[]>([]);\r\n  const [selectedCarrier, setSelectedCarrier] = useState(\"usps\");\r\n  const [selectedService, setSelectedService] = useState(\"\");\r\n  const [weight, setWeight] = useState(\"16\");\r\n  const [length, setLength] = useState(\"\");\r\n  const [width, setWidth] = useState(\"\");\r\n  const [height, setHeight] = useState(\"\");\r\n  const [isTestLabel, setIsTestLabel] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  // Define fetchCarriers with useCallback\r\n  const fetchCarriers = useCallback(async () => {\r\n    try {\r\n      const token = localStorage.getItem(\"authToken\");\r\n      if (!token) {\r\n        console.warn(\"No auth token found, using default carriers\");\r\n        const defaultCarriers = [\r\n          { name: \"USPS\", code: \"usps\" },\r\n          { name: \"UPS\", code: \"ups\" },\r\n          { name: \"FedEx\", code: \"fedex\" },\r\n        ];\r\n        setCarriers(defaultCarriers);\r\n        setSelectedCarrier(\"usps\");\r\n        return;\r\n      }\r\n\r\n      const response = await fetch(\"/api/shipping/carriers\", {\r\n        headers: {\r\n          Authorization: `Bearer ${token}`,\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n      });\r\n\r\n      if (!response.ok) {\r\n        const errorData = await response.json().catch(() => ({}));\r\n        console.error(\"API error:\", errorData);\r\n        throw new Error(errorData.error || \"Failed to fetch carriers\");\r\n      }\r\n\r\n      const data = await response.json();\r\n      const carrierList = Array.isArray(data) ? data : data.carriers || [];\r\n\r\n      if (carrierList.length === 0) {\r\n        throw new Error(\"No carriers returned\");\r\n      }\r\n\r\n      setCarriers(carrierList);\r\n      setSelectedCarrier(carrierList[0].code);\r\n    } catch (err) {\r\n      console.error(\"Failed to fetch carriers:\", err);\r\n      // Use default carriers as fallback\r\n      const defaultCarriers = [\r\n        { name: \"USPS\", code: \"usps\" },\r\n        { name: \"UPS\", code: \"ups\" },\r\n        { name: \"FedEx\", code: \"fedex\" },\r\n        { name: \"DHL Express\", code: \"dhl_express\" },\r\n        { name: \"OnTrac\", code: \"ontrac\" },\r\n      ];\r\n      setCarriers(defaultCarriers);\r\n      setSelectedCarrier(\"usps\");\r\n    }\r\n  }, []);\r\n\r\n  // Define fetchServices with useCallback\r\n  const fetchServices = useCallback(async (carrierCode: string) => {\r\n    try {\r\n      const token = localStorage.getItem(\"authToken\");\r\n      if (!token) {\r\n        console.warn(\"No auth token found, using default services\");\r\n        setServices([]);\r\n        return;\r\n      }\r\n\r\n      const response = await fetch(\r\n        `/api/shipping/services?carrierCode=${carrierCode}`,\r\n        {\r\n          headers: {\r\n            Authorization: `Bearer ${token}`,\r\n            \"Content-Type\": \"application/json\",\r\n          },\r\n        },\r\n      );\r\n\r\n      if (!response.ok) {\r\n        const errorData = await response.json().catch(() => ({}));\r\n        console.error(\"API error:\", errorData);\r\n        throw new Error(errorData.error || \"Failed to fetch services\");\r\n      }\r\n\r\n      const data = await response.json();\r\n      const serviceList = Array.isArray(data) ? data : data.services || [];\r\n\r\n      setServices(serviceList);\r\n      if (serviceList.length > 0) {\r\n        setSelectedService(serviceList[0].code);\r\n      }\r\n    } catch (err) {\r\n      console.error(\"Failed to fetch services:\", err);\r\n      // Use default services based on carrier\r\n      const defaultServices: Record<string, any[]> = {\r\n        usps: [\r\n          { name: \"USPS Priority Mail\", code: \"usps_priority_mail\" },\r\n          {\r\n            name: \"USPS Priority Mail Express\",\r\n            code: \"usps_priority_mail_express\",\r\n          },\r\n          { name: \"USPS First Class Mail\", code: \"usps_first_class_mail\" },\r\n        ],\r\n        ups: [\r\n          { name: \"UPS Ground\", code: \"ups_ground\" },\r\n          { name: \"UPS 2nd Day Air\", code: \"ups_2nd_day_air\" },\r\n          { name: \"UPS Next Day Air\", code: \"ups_next_day_air\" },\r\n        ],\r\n        fedex: [\r\n          { name: \"FedEx Ground\", code: \"fedex_ground\" },\r\n          { name: \"FedEx 2Day\", code: \"fedex_2day\" },\r\n          { name: \"FedEx Overnight\", code: \"fedex_overnight\" },\r\n        ],\r\n      };\r\n      setServices(defaultServices[carrierCode] || []);\r\n    }\r\n  }, []);\r\n\r\n  // Fetch carriers on mount\r\n  useEffect(() => {\r\n    fetchCarriers();\r\n  }, [fetchCarriers]);\r\n\r\n  // Fetch services when carrier changes\r\n  useEffect(() => {\r\n    if (selectedCarrier) {\r\n      fetchServices(selectedCarrier);\r\n    }\r\n  }, [selectedCarrier, fetchServices]);\r\n\r\n  const handleCreateLabel = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setError(null);\r\n\r\n    if (!selectedService) {\r\n      setError(\"Please select a shipping service\");\r\n      return;\r\n    }\r\n\r\n    if (!weight || parseFloat(weight) <= 0) {\r\n      setError(\"Please enter a valid weight\");\r\n      return;\r\n    }\r\n\r\n    setIsLoading(true);\r\n\r\n    try {\r\n      const token = localStorage.getItem(\"authToken\");\r\n\r\n      const payload = {\r\n        orderId,\r\n        carrier: selectedCarrier,\r\n        service: selectedService,\r\n        weight: parseFloat(weight),\r\n        ...(length &&\r\n          width &&\r\n          height && {\r\n            dimensions: {\r\n              length: parseFloat(length),\r\n              width: parseFloat(width),\r\n              height: parseFloat(height),\r\n            },\r\n          }),\r\n        testLabel: isTestLabel,\r\n      };\r\n\r\n      const response = await fetch(\"/api/shipping/label\", {\r\n        method: \"POST\",\r\n        headers: {\r\n          Authorization: `Bearer ${token}`,\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify(payload),\r\n      });\r\n\r\n      const result = await response.json();\r\n\r\n      if (!response.ok) {\r\n        throw new Error(result.error || \"Failed to create shipping label\");\r\n      }\r\n\r\n      toast.success(\"Shipping label created successfully!\");\r\n\r\n      if (result.labelUrl) {\r\n        // Open label in new window\r\n        window.open(result.labelUrl, \"_blank\");\r\n      }\r\n\r\n      onSuccess();\r\n      onClose();\r\n    } catch (err) {\r\n      const errorMsg =\r\n        err instanceof Error ? err.message : \"Failed to create shipping label\";\r\n      setError(errorMsg);\r\n      toast.error(errorMsg);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\">\r\n      <div className=\"bg-gray-900 rounded-lg shadow-xl max-w-md w-full mx-4 border border-white/10\">\r\n        {/* Header */}\r\n        <div className=\"flex items-center justify-between px-6 py-4 border-b border-white/10\">\r\n          <div className=\"flex items-center gap-3\">\r\n            <Package className=\"w-5 h-5 text-green-400\" />\r\n            <h2 className=\"text-lg font-semibold text-white\">\r\n              Purchase Shipping Label\r\n            </h2>\r\n          </div>\r\n          <button\r\n            onClick={onClose}\r\n            disabled={isLoading}\r\n            className=\"text-white/60 hover:text-white transition-colors disabled:opacity-50\"\r\n          >\r\n            <X className=\"w-5 h-5\" />\r\n          </button>\r\n        </div>\r\n\r\n        {/* Content */}\r\n        <form onSubmit={handleCreateLabel} className=\"p-6 space-y-4\">\r\n          {/* Order Info */}\r\n          <div className=\"bg-white/5 rounded-lg p-3 border border-white/10\">\r\n            <p className=\"text-sm text-white/60\">Order</p>\r\n            <p className=\"font-semibold text-white\">#{orderNumber}</p>\r\n          </div>\r\n\r\n          {/* Shipping Address Summary */}\r\n          {shippingAddress && (\r\n            <div className=\"bg-white/5 rounded-lg p-3 border border-white/10\">\r\n              <p className=\"text-sm text-white/60 mb-1\">Shipping To</p>\r\n              <p className=\"text-sm text-white\">\r\n                {shippingAddress.first_name} {shippingAddress.last_name}\r\n              </p>\r\n              <p className=\"text-xs text-white/60\">\r\n                {shippingAddress.street_1}, {shippingAddress.city},{\" \"}\r\n                {shippingAddress.state_or_province}{\" \"}\r\n                {shippingAddress.postal_code}\r\n              </p>\r\n            </div>\r\n          )}\r\n\r\n          {/* Carrier Selection */}\r\n          <div>\r\n            <label className=\"block text-sm font-medium text-white mb-2\">\r\n              Carrier\r\n            </label>\r\n            <select\r\n              value={selectedCarrier}\r\n              onChange={(e) => setSelectedCarrier(e.target.value)}\r\n              disabled={isLoading || carriers.length === 0}\r\n              className=\"w-full px-3 py-2 bg-white/5 border border-white/10 rounded-lg text-white text-sm focus:outline-none focus:ring-2 focus:ring-green-500/50 disabled:opacity-50\"\r\n            >\r\n              {carriers.map((carrier) => (\r\n                <option\r\n                  key={carrier.code}\r\n                  value={carrier.code}\r\n                  className=\"bg-gray-900\"\r\n                >\r\n                  {carrier.name}\r\n                </option>\r\n              ))}\r\n            </select>\r\n          </div>\r\n\r\n          {/* Service Selection */}\r\n          <div>\r\n            <label className=\"block text-sm font-medium text-white mb-2\">\r\n              Service\r\n            </label>\r\n            <select\r\n              value={selectedService}\r\n              onChange={(e) => setSelectedService(e.target.value)}\r\n              disabled={isLoading || services.length === 0}\r\n              className=\"w-full px-3 py-2 bg-white/5 border border-white/10 rounded-lg text-white text-sm focus:outline-none focus:ring-2 focus:ring-green-500/50 disabled:opacity-50\"\r\n            >\r\n              <option value=\"\" className=\"bg-gray-900\">\r\n                {services.length === 0\r\n                  ? \"Loading services...\"\r\n                  : \"Select a service...\"}\r\n              </option>\r\n              {services.map((service) => (\r\n                <option\r\n                  key={service.code}\r\n                  value={service.code}\r\n                  className=\"bg-gray-900\"\r\n                >\r\n                  {service.name}\r\n                </option>\r\n              ))}\r\n            </select>\r\n          </div>\r\n\r\n          {/* Weight */}\r\n          <div>\r\n            <label className=\"block text-sm font-medium text-white mb-2\">\r\n              Weight (ounces) *\r\n            </label>\r\n            <input\r\n              type=\"number\"\r\n              value={weight}\r\n              onChange={(e) => setWeight(e.target.value)}\r\n              disabled={isLoading}\r\n              min=\"0.1\"\r\n              step=\"0.1\"\r\n              className=\"w-full px-3 py-2 bg-white/5 border border-white/10 rounded-lg text-white text-sm focus:outline-none focus:ring-2 focus:ring-green-500/50 disabled:opacity-50\"\r\n              placeholder=\"Enter weight in ounces\"\r\n            />\r\n          </div>\r\n\r\n          {/* Dimensions */}\r\n          <div className=\"space-y-2\">\r\n            <label className=\"block text-sm font-medium text-white\">\r\n              Dimensions (inches) - Optional\r\n            </label>\r\n            <div className=\"grid grid-cols-3 gap-2\">\r\n              <input\r\n                type=\"number\"\r\n                value={length}\r\n                onChange={(e) => setLength(e.target.value)}\r\n                disabled={isLoading}\r\n                min=\"0\"\r\n                step=\"0.1\"\r\n                className=\"px-3 py-2 bg-white/5 border border-white/10 rounded-lg text-white text-sm focus:outline-none focus:ring-2 focus:ring-green-500/50 disabled:opacity-50\"\r\n                placeholder=\"Length\"\r\n              />\r\n              <input\r\n                type=\"number\"\r\n                value={width}\r\n                onChange={(e) => setWidth(e.target.value)}\r\n                disabled={isLoading}\r\n                min=\"0\"\r\n                step=\"0.1\"\r\n                className=\"px-3 py-2 bg-white/5 border border-white/10 rounded-lg text-white text-sm focus:outline-none focus:ring-2 focus:ring-green-500/50 disabled:opacity-50\"\r\n                placeholder=\"Width\"\r\n              />\r\n              <input\r\n                type=\"number\"\r\n                value={height}\r\n                onChange={(e) => setHeight(e.target.value)}\r\n                disabled={isLoading}\r\n                min=\"0\"\r\n                step=\"0.1\"\r\n                className=\"px-3 py-2 bg-white/5 border border-white/10 rounded-lg text-white text-sm focus:outline-none focus:ring-2 focus:ring-green-500/50 disabled:opacity-50\"\r\n                placeholder=\"Height\"\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          {/* Test Label Checkbox */}\r\n          <div className=\"flex items-center gap-2\">\r\n            <input\r\n              type=\"checkbox\"\r\n              id=\"testLabel\"\r\n              checked={isTestLabel}\r\n              onChange={(e) => setIsTestLabel(e.target.checked)}\r\n              disabled={isLoading}\r\n              className=\"w-4 h-4 rounded border-white/20 cursor-pointer disabled:opacity-50\"\r\n            />\r\n            <label htmlFor=\"testLabel\" className=\"text-sm text-white/70\">\r\n              Test Label (won't be charged)\r\n            </label>\r\n          </div>\r\n\r\n          {/* Error Message */}\r\n          {error && (\r\n            <div className=\"flex gap-2 p-3 bg-red-500/20 border border-red-500/30 rounded-lg\">\r\n              <AlertCircle className=\"w-5 h-5 text-red-400 flex-shrink-0\" />\r\n              <p className=\"text-sm text-red-300\">{error}</p>\r\n            </div>\r\n          )}\r\n\r\n          {/* Buttons */}\r\n          <div className=\"flex gap-2 pt-2\">\r\n            <Button\r\n              type=\"button\"\r\n              onClick={onClose}\r\n              disabled={isLoading}\r\n              variant=\"outline\"\r\n              className=\"flex-1 border-white/10 text-white hover:bg-white/5\"\r\n            >\r\n              Cancel\r\n            </Button>\r\n            <Button\r\n              type=\"submit\"\r\n              disabled={isLoading}\r\n              className=\"flex-1 bg-green-600 hover:bg-green-700 text-white\"\r\n            >\r\n              {isLoading ? (\r\n                <>\r\n                  <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\r\n                  Creating Label...\r\n                </>\r\n              ) : (\r\n                \"Create Label\"\r\n              )}\r\n            </Button>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}